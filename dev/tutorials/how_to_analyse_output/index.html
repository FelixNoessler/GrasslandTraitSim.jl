<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li></ul></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li><li><a class="tocitem" href="../../Modelling_API/functional_response/">Functional response</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    startyear = 2009, endyear = 2021,
    npatches = 1, nutheterog = 0.0);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (senescence_intercept = 9.594548519615396, senescence_rate = 11.793866321332152, sla_tr = 0.009908918158486471, sla_tr_exponent = 2.4959875375040887, biomass_dens = 905.1894196309725, belowground_density_effect = 1.243431419474298, height_strength = 0.11624675015957471, leafnitrogen_graz_exp = 2.9221819460701206, trampling_factor = 65.13587711112287, grazing_half_factor = 157.3045262441305, mowing_mid_days = 6.106174292354222, max_rsa_above_water_reduction = 0.2530927775106053, max_SLA_water_reduction = 0.8961798337437242, max_AMC_nut_reduction = 0.5200095484139818, max_rsa_above_nut_reduction = 0.7063511868742249, b_biomass = 1295.2142567548983, b_sla = 0.003958791090577544, b_lncm = 3.626705514150837, b_amc = 0.16342654224714848, b_height = 0.06186955140054361, b_rsa_above = 0.014533309346240423, amc_nut_lower = 0.47999045158601816, rsa_above_water_lower = 0.7469072224893947, rsa_above_nut_lower = 0.29364881312577507, sla_water_lower = 0.10382016625627577), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2009-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2009.0, 2009.0027397260274, 2009.0054794520547, 2009.0082191780823, 2009.0109589041097, 2009.013698630137, 2009.0164383561644, 2009.0191780821917, 2009.021917808219, 2009.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(4748), simp = (nspecies = 25, npatches = 1, ntimesteps = 4748, plotID = &quot;HEG01&quot;, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, constant_seed = false, constant_init_biomass = true, startyear = 2009, endyear = 2021, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[-5.7 °C, -3.4 °C, -7.9 °C, -2.2 °C, -3.8 °C, -13.8 °C, -12.7 °C, -8.6 °C, -12.3 °C, -11.2 °C  …  -5.8 °C, -1.5 °C, 6.0 °C, -4.6 °C, -7.8 °C, -1.0 °C, 4.9 °C, 6.8 °C, 11.1 °C, 11.9 °C], temperature_sum = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[-5.7 °C, -9.1 °C, -17.0 °C, -19.2 °C, -23.0 °C, -36.800000000000004 °C, -49.5 °C, -58.1 °C, -70.4 °C, -81.60000000000001 °C  …  3227.099999999999 °C, 3225.599999999999 °C, 3231.599999999999 °C, 3226.999999999999 °C, 3219.199999999999 °C, 3218.199999999999 °C, 3223.099999999999 °C, 3229.899999999999 °C, 3240.999999999999 °C, 3252.899999999999 °C], soiltemperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[0.2 °C, 0.1 °C, 0.1 °C, -0.0 °C, 0.1 °C, -0.3 °C, -0.3 °C, -0.2 °C, -0.4 °C, -0.7 °C  …  1.0 °C, 0.8 °C, 1.9 °C, 2.0 °C, 1.3 °C, 1.3 °C, 1.9 °C, 3.6 °C, 5.5 °C, 7.0 °C], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.5 mm d^-1, 0.0 mm d^-1, 1.4 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.8 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.3 mm d^-1, 0.4 mm d^-1, 0.6 mm d^-1, 0.7 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[3920.0 MJ ha^-1 d^-1, 3040.0 MJ ha^-1 d^-1, 15430.0 MJ ha^-1 d^-1, 3140.0 MJ ha^-1 d^-1, 4170.0 MJ ha^-1 d^-1, 9300.0 MJ ha^-1 d^-1, 4240.0 MJ ha^-1 d^-1, 8480.0 MJ ha^-1 d^-1, 9550.0 MJ ha^-1 d^-1, 12030.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), patch = (xs = [1], ys = [1], WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm], nutrients = [0.6013229371581524], nneighbours = [0], neighbours = Union{Missing, Int64}[missing missing missing missing], surroundings = Union{Missing, Int64}[1 missing … missing missing]), traits = (TS = [1.0 0.6152369490466129 … 0.597692335141574 0.9146781118952798; 0.6152369490466129 1.0 … 0.6833665568813148 0.6809689555651058; … ; 0.597692335141574 0.6833665568813148 … 1.0 0.6830142232462941; 0.9146781118952798 0.6809689555651058 … 0.6830142232462941 1.0], la = Unitful.Quantity{Float64, 𝐋^2, Unitful.FreeUnits{(mm^2,), 𝐋^2, nothing}}[1062.8637555045013 mm^2, 164.55736154342773 mm^2, 434.2133274034521 mm^2, 964.2541482361631 mm^2, 394.035888847153 mm^2, 453.13836714287254 mm^2, 232.76644413745768 mm^2, 1012.6137448289314 mm^2, 619.5129740052726 mm^2, 837.2592299308833 mm^2  …  1503.9637762646175 mm^2, 2340.863533906196 mm^2, 1957.276105745486 mm^2, 4780.655905162256 mm^2, 1537.5183740525474 mm^2, 1520.3776108408922 mm^2, 1473.075295126737 mm^2, 1746.6336183318904 mm^2, 370.89975765924146 mm^2, 2490.6195874415325 mm^2], lfm = Unitful.Quantity{Float64, 𝐌, Unitful.FreeUnits{(mg,), 𝐌, nothing}}[229.44386288164816 mg, 41.37806905361611 mg, 65.06406966973842 mg, 168.1697682684056 mg, 125.845112704672 mg, 154.31448204220973 mg, 34.78941370946781 mg, 275.71233351301214 mg, 131.03203246840133 mg, 224.95049800550686 mg  …  401.92576640757227 mg, 430.32950350725093 mg, 369.50544301948787 mg, 1647.0519611150573 mg, 231.30937798390116 mg, 274.800025720756 mg, 264.9736415224156 mg, 271.97900888553744 mg, 52.03189936074775 mg, 474.2164764798336 mg], ldm = Unitful.Quantity{Float64, 𝐌, Unitful.FreeUnits{(mg,), 𝐌, nothing}}[40.81067130884266 mg, 7.753223889661412 mg, 17.82285234853288 mg, 34.50956115273994 mg, 22.980996844503032 mg, 23.021846905738638 mg, 12.114478944329829 mg, 52.99557902339635 mg, 36.110212673654395 mg, 40.216210906404335 mg  …  94.00849263021892 mg, 108.67166119718028 mg, 69.3698102009473 mg, 235.03701331744946 mg, 66.56434708351274 mg, 61.58910674044126 mg, 59.34847862637772 mg, 54.43248109692887 mg, 10.127397113342663 mg, 128.32553675210158 mg], ba = [0.8137374335617467, 0.44308419419395423, 0.32212570597602436, 0.828322788834803, 0.563682184733982, 0.7437547316344425, 0.5794745803170056, 0.61822817082924, 0.6216601774949541, 0.7259250449314898  …  0.7729726034115556, 1.0890754845353965, 0.5679493973188495, 0.6434390986583376, 0.3940538684505053, 0.5087186360071685, 0.8256397780374078, 0.9345160619462143, 1.3110201860813486, 0.9318365829291333], srsa = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.16778504482232073 m^2 g^-1, 0.21782651380133258 m^2 g^-1, 0.1544539808100429 m^2 g^-1, 0.19162130516972248 m^2 g^-1, 0.17497947882063405 m^2 g^-1, 0.28235207633326015 m^2 g^-1, 0.19895894708557293 m^2 g^-1, 0.1863114188679524 m^2 g^-1, 0.18209281792086968 m^2 g^-1, 0.20582337080786814 m^2 g^-1  …  0.19017366987453446 m^2 g^-1, 0.17987640548574368 m^2 g^-1, 0.2176704088919552 m^2 g^-1, 0.1828894570577866 m^2 g^-1, 0.24465502891865892 m^2 g^-1, 0.19809031529592575 m^2 g^-1, 0.15269216299217286 m^2 g^-1, 0.15437549002624104 m^2 g^-1, 0.13724560001884417 m^2 g^-1, 0.14933311402493948 m^2 g^-1], amc = [0.1086259183310438, 0.41624163542735226, 0.6323688558525324, 0.22032711888527465, 0.6707475847204994, 0.39647589888692447, 0.3294444676265667, 0.3198399648261008, 0.25779749392776685, 0.31742711623826264  …  0.1476172466394947, 0.038819440559515805, 0.389941937096886, 0.5465357994332478, 0.09176435646250677, 0.38102966271419586, 0.29511520018761117, 0.1162901951749983, 0.4226612935641605, 0.20739902754643674], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.40599534025749867 m, 0.16828846336346626 m, 0.7699490119097734 m, 0.5793054291982948 m, 0.24473197936532864 m, 0.07806770545135801 m, 0.24505227499745355 m, 0.20911830800178463 m, 0.32250803921348553 m, 0.12311327793635188 m  …  0.6027469759243987 m, 0.23439644609517768 m, 0.1189952408966166 m, 0.06253526559834895 m, 0.2101093247597918 m, 0.5011273341485645 m, 0.3507527181647732 m, 0.3949489138710251 m, 0.591618434139443 m, 1.0905243581065938 m], ldmpm = [0.750144406106063, 0.713528068922648, 0.6173246116687902, 0.42144670566875664, 0.7312828206848574, 0.6798557385196474, 0.4821994778116243, 0.5192601068878722, 0.5790330792817465, 0.6099067361692668  …  0.536768858977396, 0.3085753487125442, 0.3010980900247413, 0.7897104250447683, 0.45094580083697106, 0.3832545460456953, 0.5151962995382756, 0.5420946055410951, 0.48487645660405204, 0.6192307241045706], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[26.012369193544227 mg g^-1, 24.443388552691072 mg g^-1, 41.90144344434203 mg g^-1, 30.14338022460994 mg g^-1, 18.354656426502824 mg g^-1, 16.722261870873975 mg g^-1, 17.206680024730154 mg g^-1, 21.000704001281708 mg g^-1, 21.898402548952454 mg g^-1, 22.604018468475985 mg g^-1  …  20.265553487061105 mg g^-1, 19.235446351500077 mg g^-1, 26.522413746580707 mg g^-1, 18.354844003344628 mg g^-1, 18.730776313484434 mg g^-1, 33.10635109798277 mg g^-1, 22.700212648266167 mg g^-1, 26.795437672712282 mg g^-1, 33.14713069558936 mg g^-1, 17.37796087770538 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.026043770450651843 m^2 g^-1, 0.021224378901640882 m^2 g^-1, 0.024362729315837887 m^2 g^-1, 0.02794165199517771 m^2 g^-1, 0.017146161740212103 m^2 g^-1, 0.01968297196129469 m^2 g^-1, 0.019213904717412862 m^2 g^-1, 0.019107513560364827 m^2 g^-1, 0.01715617073773875 m^2 g^-1, 0.0208189486542988 m^2 g^-1  …  0.015998169252435922 m^2 g^-1, 0.021540698910075505 m^2 g^-1, 0.028215099624400556 m^2 g^-1, 0.020340012994912126 m^2 g^-1, 0.023098226624585546 m^2 g^-1, 0.024685820128035184 m^2 g^-1, 0.02482077602023014 m^2 g^-1, 0.032088076514859384 m^2 g^-1, 0.03662340416873628 m^2 g^-1, 0.01940860447950352 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.1365329717637579 m^2 g^-1, 0.0965154853417417 m^2 g^-1, 0.04975359760924239 m^2 g^-1, 0.15872429389834938 m^2 g^-1, 0.09863281490522854 m^2 g^-1, 0.21000069275967154 m^2 g^-1, 0.1152916523627257 m^2 g^-1, 0.11518296769133457 m^2 g^-1, 0.11319985350924419 m^2 g^-1, 0.14941233970165235 m^2 g^-1  …  0.14699903670324863 m^2 g^-1, 0.19589898346087176 m^2 g^-1, 0.12362577754433351 m^2 g^-1, 0.11767822740337494 m^2 g^-1, 0.09640726058126779 m^2 g^-1, 0.1007722350035733 m^2 g^-1, 0.1260687235609093 m^2 g^-1, 0.14426637500033987 m^2 g^-1, 0.17993175207555143 m^2 g^-1, 0.13915405869116623 m^2 g^-1], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[29.403486099705493 d, 50.38070814969982 d, 35.04745646524282 d, 24.43479893672742 d, 88.33394374960308 d, 61.43749801476678 d, 65.46352980821162 d, 66.4271096904033 d, 88.1983912514092 d, 53.00378563117231 d  …  106.0057140307046 d, 48.457041902348855 d, 23.816529856356308 d, 56.351535195472756 d, 40.32463614653803 d, 33.85319085015808 d, 33.37094991518253 d, 16.9774697980758 d, 11.988940225610975 d, 63.749470859904584 d], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[0.009995652874430326 d^-1, 0.009828643409395193 d^-1, 0.009931059853412996 d^-1, 0.010077215324113018 d^-1, 0.009728063064768772 d^-1, 0.009786513796562342 d^-1, 0.00977470785956979 d^-1, 0.009772094500108899 d^-1, 0.009728268263864628 d^-1, 0.00981705840604879 d^-1  …  0.0097058054120308 d^-1, 0.009837936598175768 d^-1, 0.010089745191526209 d^-1, 0.009803839469372513 d^-1, 0.009887021495155057 d^-1, 0.009942931228162264 d^-1, 0.009947965678890397 d^-1, 0.010289226022305982 d^-1, 0.010578277364650246 d^-1, 0.00977955187983544 d^-1], ρ = [1.1981013756814485, 0.9989427515429928, 4.825347946405009, 1.8430978879123094, 0.43249081579037174, 0.32943596360827154, 0.358106406917188, 0.6410446517391676, 0.7244516453027944, 0.7947988930013292  …  0.5776521485475287, 0.49597621616186804, 1.2680510142596118, 0.4325037315920603, 0.45890195054152166, 2.4240289042782273, 0.8047232555858891, 1.3065740673820467, 2.4327644631737373, 0.36862309080005384]), funresponse = (amc_nut_upper = [0.9871873483885203, 0.8970688451215366, 0.8527422556946574, 0.9665036784205147, 0.8500633631222851, 0.9041920058468601, 0.929987263499404, 0.9336728376488326, 0.9556100940939269, 0.9345910839839195  …  0.9817907535633719, 0.993350704895868, 0.9066247740820519, 0.8631680714272347, 0.9890357133172757, 0.9099929518938749, 0.9428824023398006, 0.9862566520341033, 0.8948444649939982, 0.9697789414910125], amc_nut_midpoint = [0.5548280192943449, 0.23710836108156946, 0.08083158847780425, 0.48190616290985, 0.07138694834700565, 0.2622216076291692, 0.35316475634743416, 0.3661585291756972, 0.44350000031855985, 0.36939587668106644  …  0.5358019125437775, 0.5765574028500902, 0.2707985176329466, 0.11758859720585985, 0.5613445708584208, 0.28267328545950365, 0.3986275520714072, 0.5515467782960427, 0.2292661392488003, 0.4934533527276016], rsa_above_water_upper = [0.9499212970488826, 0.9786623443485201, 0.9956877630634889, 0.937377367560329, 0.9773393007357424, 0.9260915643694367, 0.9656005002183514, 0.9656822778639922, 0.9671676867996479, 0.9419670848008972  …  0.9433208829643678, 0.9275517521370586, 0.9592879244268534, 0.9637976890262998, 0.978728693391093, 0.9759558166637349, 0.9574507277738625, 0.9449333363566286, 0.9304031132567743, 0.9481648162486436], rsa_above_nut_upper = [0.860236425493567, 0.9404491959716046, 0.9879650707217048, 0.825227842595799, 0.9367567420210655, 0.7937305373106587, 0.9039951762446916, 0.9042234077162743, 0.9083690035527656, 0.8380371856840528  …  0.8418154718483648, 0.7978057439319763, 0.8863775442979592, 0.8989637492804733, 0.9406343680868673, 0.9328956060933793, 0.8812501516906884, 0.8463156333251379, 0.8057635463273202, 0.8553343010229522], rsa_above_midpoint = [0.23724387430797084, 0.4454359869696114, 0.5687633610303021, 0.14637915549399938, 0.4358522288686612, 0.06462795189659376, 0.35081963926431486, 0.3514120136700547, 0.3621719007839993, 0.17962578422229541  …  0.18943231969165347, 0.07520514391936683, 0.30509310478325363, 0.33776057892840283, 0.44591660088748003, 0.42583065697595546, 0.2917849657800552, 0.20111248133654352, 0.09585960683040817, 0.22452041837962727], sla_water_midpoint = [0.03129713224296338, -0.11251777198837387, -0.01911448191779752, 0.0878933321108809, -0.229030972543943, -0.15743009682777986, -0.1709091223233855, -0.17395257442727374, -0.22875528349902885, -0.1244137229004123  …  -0.2602440509186936, -0.10320078450293213, 0.09598833639408244, -0.13839374177292807, -0.05695667261803594, -0.009424960071585664, -0.005376638438214676, 0.20777207531925956, 0.3281772971792716, -0.16532610612621845]), u = (u_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.00018013507313020423 kg ha^-1 5.144180401284298e-6 kg ha^-1 … 8.155241424119802e-16 kg ha^-1 52.63077817618694 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[97.55357995369069 mm]), du = (du_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[-1.7887538633959453e-7 kg ha^-1 d^-1 -4.09110812858527e-8 kg ha^-1 d^-1 … 5.194625888364785e-18 kg ha^-1 d^-1 -0.20883242486058062 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[-0.42614539650719024 mm d^-1]), o = (biomass = [59.40026082753418 kg ha^-1; 58.80651643965153 kg ha^-1; … ; 0.00018031394851654383 kg ha^-1; 0.00018013507313020423 kg ha^-1;;; 59.410281395436286 kg ha^-1; 58.82635892474872 kg ha^-1; … ; 5.185091482570151e-6 kg ha^-1; 5.144180401284298e-6 kg ha^-1;;; 59.40413640879522 kg ha^-1; 58.81419037457916 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; … ;;; 59.38264643866164 kg ha^-1; 58.77164496765157 kg ha^-1; … ; 0.026362601284221132 kg ha^-1; 0.026481809081135996 kg ha^-1;;; 59.36530335812098 kg ha^-1; 58.73732071336217 kg ha^-1; … ; 8.103295165236154e-16 kg ha^-1; 8.155241424119802e-16 kg ha^-1;;; 59.41322688720987 kg ha^-1; 58.83219215251797 kg ha^-1; … ; 52.839610601047525 kg ha^-1; 52.63077817618694 kg ha^-1], water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm; 120.05699583999998 mm; … ; 97.97972535019788 mm; 97.55357995369069 mm;;]), calc = (negbiomass = [0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; … ;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0], pot_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[8.042366085634463e-6 kg ha^-1 d^-1, 1.8846992989814244e-7 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 4.305099727409884e-11 kg ha^-1 d^-1, 2.0471945321369412e-6 kg ha^-1 d^-1, 1.5760490816526593 kg ha^-1 d^-1, 3.2712312367128358e-6 kg ha^-1 d^-1, 2.473739749750562e-9 kg ha^-1 d^-1, 3.878134603476284e-14 kg ha^-1 d^-1, 1.9178054485792164e-7 kg ha^-1 d^-1  …  5.808207095942974e-12 kg ha^-1 d^-1, 1.197819495767324 kg ha^-1 d^-1, 9.379539788220777e-6 kg ha^-1 d^-1, 1.5679891331047544 kg ha^-1 d^-1, 0.14488854832770773 kg ha^-1 d^-1, 1.203835878737371e-21 kg ha^-1 d^-1, 0.00017503617552971522 kg ha^-1 d^-1, 0.0014487138147184617 kg ha^-1 d^-1, 5.082425530940636e-17 kg ha^-1 d^-1, 1.7563237489909715 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[5.2281915270282245e-6 kg ha^-1 d^-1, 1.119761643959701e-7 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.839507202416955e-11 kg ha^-1 d^-1, 1.2386466983965674e-6 kg ha^-1 d^-1, 0.8280254619715531 kg ha^-1 d^-1, 1.9415300403387574e-6 kg ha^-1 d^-1, 1.4580638460247514e-9 kg ha^-1 d^-1, 2.4247110414727945e-14 kg ha^-1 d^-1, 1.0745689953828614e-7 kg ha^-1 d^-1  …  3.941483729428529e-12 kg ha^-1 d^-1, 0.7270813449877777 kg ha^-1 d^-1, 5.185207874197958e-6 kg ha^-1 d^-1, 0.8481395981055265 kg ha^-1 d^-1, 0.09171365802568028 kg ha^-1 d^-1, 7.807467453904793e-22 kg ha^-1 d^-1, 0.0001077904783699566 kg ha^-1 d^-1, 0.0009329600863627193 kg ha^-1 d^-1, 3.0910297036014e-17 kg ha^-1 d^-1, 1.3414107146891603 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[5.407066913367819e-6 kg ha^-1 d^-1, 1.528872456818228e-7 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.719833223220386e-11 kg ha^-1 d^-1, 2.034647472385097e-6 kg ha^-1 d^-1, 1.3727064558966822 kg ha^-1 d^-1, 2.915211022175013e-6 kg ha^-1 d^-1, 2.2161956004534105e-9 kg ha^-1 d^-1, 3.852198484899967e-14 kg ha^-1 d^-1, 1.5841552024911555e-7 kg ha^-1 d^-1  …  6.1726831547514726e-12 kg ha^-1 d^-1, 0.9583104092526298 kg ha^-1 d^-1, 5.8755799431685095e-6 kg ha^-1 d^-1, 1.3239104582668397 kg ha^-1 d^-1, 0.10864043616340895 kg ha^-1 d^-1, 8.493853325369313e-22 kg ha^-1 d^-1, 0.00012289022442790547 kg ha^-1 d^-1, 0.0008137522894478555 kg ha^-1 d^-1, 2.5715671147649216e-17 kg ha^-1 d^-1, 1.550243139549741 kg ha^-1 d^-1], species_specific_red = [0.9391222142048666, 0.8582977636779929, 1.0889450608044249, 0.9528273640688405, 0.8740631262982697, 0.7589766520737387, 0.8574076078658621, 0.8514849897761944, 0.9032159001543538, 0.8094391766714204  …  0.9803295818259616, 0.8768919582629302, 0.7986180186145114, 0.7814096215003254, 0.9144383206041605, 0.9369088958253573, 0.8896251385955909, 0.9303255011220775, 0.878590731194183, 1.1033458348688363], LAIs = [2.9115541522136233e-7, 6.823121468475865e-9, 0.0, 1.558562598813249e-12, 7.411398184272173e-8, 0.057057241599270725, 1.1842742283411965e-7, 8.955607296647871e-11, 1.403989670125036e-15, 6.942974688658707e-9  …  2.102728140828632e-13, 0.043364307087851876, 3.395647216933756e-7, 0.056765449651336425, 0.005245357522896968, 4.3582116431908436e-23, 6.336783208133834e-6, 5.244736036260671e-5, 1.839975574397064e-18, 0.06358367238641618], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1], relbiomass = [1.0], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [0.8021330223498022, 0.9156923565288789, 0.9829618332892557, 0.7525704484512723, 0.9104648521101788, 0.7079788828526874, 0.8640834395987171, 0.8644065529109389, 0.8702755822458178, 0.7707049732121611  …  0.7760539925590837, 0.7137482603196545, 0.8391416935181384, 0.8569603157791288, 0.9159545095749891, 0.904998540168703, 0.8318827086073028, 0.7824249898199328, 0.7250143309984044, 0.7951929554797966], denominator = [1.5161701238008485, 3.5583962218415315, 17.60752815094946, 1.2124663287882143, 3.350639464729199, 1.0273229653068634, 2.2072365509712277, 2.2124963000826483, 2.3125946926081173, 1.308358075631456  …  1.3396086111477072, 1.0480285651189654, 1.8649953898018188, 2.0973200663444027, 3.5694955015780803, 3.1578462113396797, 1.7844684357853724, 1.3788348200085896, 1.0909659441134705, 1.4647933653981628], traitmat = [1062.8637555045013 164.55736154342773 … 370.89975765924146 2490.6195874415325; 229.44386288164816 41.37806905361611 … 52.03189936074775 474.2164764798336; … ; 0.750144406106063 0.713528068922648 … 0.48487645660405204 0.6192307241045706; 26.012369193544227 24.443388552691072 … 33.14713069558936 17.37796087770538], similarity_matprep = [1.3508369e-315 1.3508369e-315 … 9.7445492e-316 0.0; 0.0 0.0 … 1.102163856e-315 0.0; … ; 3.180442954115805e-294 1.0e-323 … 1.112202005e-315 1.02095875e-315; NaN NaN … NaN 0.0], amc_resid = [-1.1617339736585068, 0.6552099028127958, 1.9317735108008451, -0.5019666046265746, 2.1584589255177185, 0.5384628317916113, 0.1425391458718723, 0.08580978654464867, -0.2806464161616129, 0.0715582050327964  …  -0.9314302171591542, -1.5740485768336707, 0.499869739164322, 1.424797314226959, -1.2613274270553914, 0.4472290531879575, -0.060227971639967154, -1.1164646323821503, 0.693127856585818, -0.5783268654555396], rsa_above_resid = [0.2395780217031271, -0.9155762322311495, -2.265415973951542, 0.8801579895168001, -0.854456894888237, 2.360314680180399, -0.37357894189315793, -0.3767162593940854, -0.4339613037059834, 0.6113569111752645  …  0.541693934464546, 1.9532513950838335, -0.13300410781116284, -0.3046875007500029, -0.9187002738344641, -0.7926998869269429, -0.062485448707507184, 0.46281227364784705, 1.4923375069951978, 0.3152389385882391], nutgradient = [0.5;;], biomass_density_factor = [11.684230030848935, 13.296050959986639, 28.721161703712742, 10.879517572905623, 18.104375268583293, 11.675200884216324, 11.566414835750907, 11.5767512106876, 11.740300604397214, 10.780219049892434  …  11.302106006291105, 12.95721423052657, 11.177044560454481, 12.64221013451413, 14.68721092530599, 12.719879917850538, 11.117317304571962, 11.56623558027649, 11.216038332773882, 10.718257744164621], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[125.35671603857935 kg ha^-1, 112.98280921438696 kg ha^-1, 60.81565116039298 kg ha^-1, 132.76113100706212 kg ha^-1, 88.14488522798636 kg ha^-1, 125.43467665161215 kg ha^-1, 126.38259665011563 kg ha^-1, 126.29183864113932 kg ha^-1, 124.87500685834242 kg ha^-1, 133.7437247206173 kg ha^-1  …  128.75414286004195 kg ha^-1, 115.35291483745519 kg ha^-1, 129.91148567063257 kg ha^-1, 117.65886428838525 kg ha^-1, 104.29329827733409 kg ha^-1, 117.08072559395276 kg ha^-1, 130.47249529058047 kg ha^-1, 126.38417188446073 kg ha^-1, 129.54813208042214 kg ha^-1, 134.3651696949379 kg ha^-1], heightinfluence = [1.0014629990662507, 0.9325449251526329, 1.1069836569950737, 1.0517105883479108, 0.9547081034118036, 0.9063873274273422, 0.954800966345924, 0.9443826737589535, 0.9772576245336294, 0.9194473370264165  …  1.0585069682887374, 0.9517115344645515, 0.9182533994138753, 0.9018840254958389, 0.9446699980764928, 1.029044505635188, 0.9854465709245199, 0.9982603217178637, 1.0552804833199063, 1.1999276882858687], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[4.049674045439924e-7 m, 4.8270351804085444e-9 m, 0.0 m, 2.8830871864043698e-12 m, 9.438477824921022e-8 m, 0.020191543529499093 m, 1.3476384419915613e-7 m, 8.745022431246086e-11 m, 2.3548437945261257e-15 m, 3.663276407883061e-9 m  …  7.068477605155006e-13 m, 0.04210189560091367 m, 1.2777579000959074e-7 m, 0.015571694022848038 m, 0.004257158211308067 m, 7.893813380843549e-23 m, 7.989738137086441e-6 m, 5.7596869728195166e-5 m, 2.6519971443228304e-18 m, 0.31876062879237865 m], nutrients_splitted = [7.025995520581572, 7.995220415863638, 17.27069331427079, 6.542103461803343, 10.88657611191792, 7.020566087608418, 6.9551505414233645, 6.961366040759865, 7.059712042555765, 6.482392982289586  …  6.7962155797757635, 7.791470118487648, 6.72101326384004, 7.602050930256598, 8.831756812266304, 7.648755552500884, 6.6850978949043665, 6.955042750994987, 6.744461113542018, 6.4451342279391834], Nutred = [0.9871873483885203, 0.9404491959716046, 0.9879650707217048, 0.9665036784205147, 0.9367567420210655, 0.9041920058468601, 0.929987263499404, 0.9336728376488326, 0.9556100940939269, 0.9345910839839195  …  0.9817907535633719, 0.993350704895868, 0.9066247740820519, 0.8989637492804733, 0.9890357133172757, 0.9328956060933793, 0.9428824023398006, 0.9862566520341033, 0.8948444649939982, 0.9697789414910125], amc_nut = [0.9871873483885203, 0.8970688451215366, 0.8527422556946574, 0.9665036784205147, 0.8500633631222851, 0.9041920058468601, 0.929987263499404, 0.9336728376488326, 0.9556100940939269, 0.9345910839839195  …  0.9817907535633719, 0.993350704895868, 0.9066247740820519, 0.8631680714272347, 0.9890357133172757, 0.9099929518938749, 0.9428824023398006, 0.9862566520341033, 0.8948444649939982, 0.9697789414910125], rsa_above_nut = [0.860236425493567, 0.9404491959716046, 0.9879650707217048, 0.825227842595799, 0.9367567420210655, 0.7937305373106587, 0.9039951762446916, 0.9042234077162743, 0.9083690035527656, 0.8380371856840528  …  0.8418154718483648, 0.7978057439319763, 0.8863775442979592, 0.8989637492804733, 0.9406343680868673, 0.9328956060933793, 0.8812501516906884, 0.8463156333251379, 0.8057635463273202, 0.8553343010229522], water_splitted = [11.442259206295434, 13.020700645451656, 28.12636999204384, 10.65421168360784, 17.729448499750514, 11.433417045886983, 11.326883867296397, 11.33700618438249, 11.49716860423532, 10.55696955159577  …  11.068048656999546, 12.688880946861401, 10.94557713117383, 12.3804003274194, 14.383050828440004, 12.456461633220943, 10.887086777792891, 11.326708324055893, 10.983763374437771, 10.496291413710235], Waterred = [0.9499212970488826, 0.9786623443485201, 0.9956877630634889, 0.937377367560329, 0.9773393007357424, 0.9260915643694367, 0.9656005002183514, 0.9656822778639922, 0.9671676867996479, 0.9419670848008972  …  0.9433208829643678, 0.9275517521370586, 0.9592879244268534, 0.9637976890262998, 0.978728693391093, 0.9759558166637349, 0.9574507277738625, 0.9449333363566286, 0.9304031132567743, 0.9481648162486436], sla_water = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], rsa_above_water = [0.9499212970488826, 0.9786623443485201, 0.9956877630634889, 0.937377367560329, 0.9773393007357424, 0.9260915643694367, 0.9656005002183514, 0.9656822778639922, 0.9671676867996479, 0.9419670848008972  …  0.9433208829643678, 0.9275517521370586, 0.9592879244268534, 0.9637976890262998, 0.978728693391093, 0.9759558166637349, 0.9574507277738625, 0.9449333363566286, 0.9304031132567743, 0.9481648162486436], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.32599534025749866 m, 0.08828846336346625 m, 0.6899490119097734 m, 0.49930542919829474 m, 0.16473197936532863 m, 0.0 m, 0.16505227499745356 m, 0.12911830800178464 m, 0.24250803921348552 m, 0.043113277936351876 m  …  0.5227469759243988 m, 0.15439644609517766 m, 0.0389952408966166 m, 0.0 m, 0.1301093247597918 m, 0.42112733414856446 m, 0.2707527181647732 m, 0.3149489138710251 m, 0.5116184341394431 m, 1.0105243581065937 m], mowing_λ = [0.802953403481772, 0.5246257622115338, 0.8960970158250235, 0.8619035901135733, 0.6731117845429657, 0.0, 0.6735390438597997, 0.6174414341602398, 0.7519441679807439, 0.3501919424047903  …  0.8672743237287777, 0.6586978969488485, 0.327704205670677, 0.0, 0.6192458374160201, 0.8403599353926219, 0.77191908755952, 0.7974421572251117, 0.8647777091050814, 0.9266407949484972], biomass_ρ = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0002451061012580931 kg ha^-1, 1.2358664571554977e-5 kg ha^-1, 0.0 kg ha^-1, 1.0216139646095907e-9 kg ha^-1, 0.00016542222176039523 kg ha^-1, 52.80844632999011 kg ha^-1, 0.0002495348336942637 kg ha^-1, 3.6234340884436546e-7 kg ha^-1, 1.4080224453693837e-11 kg ha^-1, 1.880508659159058e-5 kg ha^-1  …  1.619998176292764e-9 kg ha^-1, 35.264175313972096 kg ha^-1, 0.0002202734505378236 kg ha^-1, 45.95292189453396 kg ha^-1, 3.8229250426837633 kg ha^-1, 6.581036517564375e-20 kg ha^-1, 0.006274744694951005 kg ha^-1, 0.015354240605309275 kg ha^-1, 5.150910632261639e-16 kg ha^-1, 47.108751737285786 kg ha^-1], grazed_share = [5.173231480894411e-7, 2.6084308915697226e-8, 0.0, 2.156227648317334e-12, 3.4914163329996535e-7, 0.11145798313839704, 5.26670470714891e-7, 7.647652669218786e-10, 2.9717848730827205e-14, 3.969018537573006e-8  …  3.419182762718985e-12, 0.07442888648860037, 4.6491113149713213e-7, 0.09698865143041221, 0.008068700076578875, 1.3889995032694283e-22, 1.3243532749237888e-5, 3.240679871162142e-5, 1.0871558439922678e-18, 0.09942815632171836], trampling_proportion = [0.0037588640981954823, 0.0015580805993394293, 0.0071284899390055955, 0.005363436876694488, 0.0022658246528967658, 0.0007227814365147494, 0.002268790075484226, 0.0019360993151417703, 0.0029859059200288474, 0.001139831014199843  …  0.005580467910447337, 0.0021701342321145097, 0.0011017046121236944, 0.0005789760162756236, 0.0019452745369805742, 0.004639633409981381, 0.0032474062357903946, 0.0036565919501182656, 0.0054774355058039535, 0.01009650222905197], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[7.689837796435963e-7 kg ha^-1, 1.9276175209180255e-8 kg ha^-1, 0.0 kg ha^-1, 2.9729088441090077e-12 kg ha^-1, 8.666490351169294e-7 kg ha^-1, 0.11586156010546733 kg ha^-1, 1.5809327709237903e-6 kg ha^-1, 1.0943587530235798e-9 kg ha^-1, 5.803317008693831e-14 kg ha^-1, 2.6968609431332853e-8 kg ha^-1  …  1.56501587685883e-11 kg ha^-1, 0.154297709290081 kg ha^-1, 1.9137737650690204e-7 kg ha^-1, 0.06151539908519616 kg ha^-1, 0.016205289024251442 kg ha^-1, 1.2596218157840327e-22 kg ha^-1, 2.5321307553788928e-5 kg ha^-1, 4.297053951946847e-5 kg ha^-1, 1.1597415701956549e-18 kg ha^-1, 1.2902979460430815 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1 NaN kg ha^-1 … NaN kg ha^-1 NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[2.597783047768662e-8 m^2 g^-1, 6.087810274865368e-10 m^2 g^-1, 0.0 m^2 g^-1, 1.3906001009821725e-13 m^2 g^-1, 6.612689840828717e-9 m^2 g^-1, 0.005090832154584332 m^2 g^-1, 1.0566478772016155e-8 m^2 g^-1, 7.990483295671232e-12 m^2 g^-1, 1.2526851205979326e-16 m^2 g^-1, 6.194747205224281e-10 m^2 g^-1  …  1.8761222469991524e-14 m^2 g^-1, 0.0038691041258981443 m^2 g^-1, 3.029706581155881e-8 m^2 g^-1, 0.005064797530593471 m^2 g^-1, 0.00046800781095236146 m^2 g^-1, 3.888537782016323e-24 m^2 g^-1, 5.653883505123758e-7 m^2 g^-1, 4.679523598989452e-6 m^2 g^-1, 1.6416858851287463e-19 m^2 g^-1, 0.005673141477197887 m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">size(sol.o.biomass)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(4748, 1, 25)</code></pre><p>The three dimension of the array are: daily time step, patch within site, species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
total_biomass = vec(sum(species_biomass; dims=2))

lines(sol.numeric_date, ustrip.(total_biomass), color = :black, linewidth = 2;
      axis = (; ylabel = &quot;Dry biomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="bfc39a50.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean soil water content per site
soil_water_per_site = ustrip.(dropdims(mean(sol.o.water; dims=2); dims = 2))

lines(sol.numeric_date, soil_water_per_site, color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="48909e33.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We calculate the community weighted mean specific leaf area (SLA) over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
trait_vals = sol.traits[:sla]
weighted_trait = trait_vals .* relative_biomass&#39;
cwm_trait = vec(sum(weighted_trait; dims = 1))

lines(sol.numeric_date, ustrip.(cwm_trait), color = :red, linewidth = 2;
      axis = (; ylabel = &quot;Community weighted mean\nspecific leaf area [m² kg⁻¹]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="5e1795ad.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../../Modelling_API/main_equations/">Difference equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 7 November 2023 17:00">Tuesday 7 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
