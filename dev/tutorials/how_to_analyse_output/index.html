<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output Â· GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li><li><a class="tocitem" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    trait_seed = 99);
p = sim.Parameter();
sol = sim.solve_prob(; input_obj, p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = GrasslandTraitSim.Parameter{Float64, Unitful.Quantity{Float64, ğ“^2 ğ‹^-2, Unitful.FreeUnits{(kg, MJ^-1), ğ“^2 ğ‹^-2, nothing}}, Unitful.Quantity{Float64, ğ“^-1, Unitful.FreeUnits{(d^-1,), ğ“^-1, nothing}}, Unitful.Quantity{Float64, ğ“^3 ğŒ^-1, Unitful.FreeUnits{(d, MJ^-1, m^2), ğ“^3 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğŒ ğ“^-3, Unitful.FreeUnits{(d^-1, MJ, m^-2), ğŒ ğ“^-3, nothing}}, Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}, Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(ha, kg^-1), ğ‹^2 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğ‹^2, Unitful.FreeUnits{(ha,), ğ‹^2, nothing}}, Unitful.Quantity{Float64, ğŒ ğ“^-1, Unitful.FreeUnits{(d^-1, kg), ğŒ ğ“^-1, nothing}}, Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}, Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(ha, kg^-1), ğ‹^2 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}, Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}, Unitful.Quantity{Float64, ğ“ ğ‹^-1, Unitful.FreeUnits{(d, mm^-1), ğ“ ğ‹^-1, nothing}}, Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(g, m^-2), ğŒ ğ‹^-2, nothing}}, Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}, Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(g, m^-2), ğŒ ğ‹^-2, nothing}}}
  RUE_max: Unitful.Quantity{Float64, ğ“^2 ğ‹^-2, Unitful.FreeUnits{(kg, MJ^-1), ğ“^2 ğ‹^-2, nothing}}
  k: Float64 0.6
  Î±_sen: Unitful.Quantity{Float64, ğ“^-1, Unitful.FreeUnits{(d^-1,), ğ“^-1, nothing}}
  Î²_sen: Float64 0.03
  Î±_ll: Float64 2.41
  Î²_ll: Float64 0.38
  Î¨â‚: Float64 775.0
  Î¨â‚‚: Float64 3000.0
  SENâ‚˜â‚â‚“: Float64 3.0
  clonalgrowth_factor: Float64 0.05
  Î³1: Unitful.Quantity{Float64, ğ“^3 ğŒ^-1, Unitful.FreeUnits{(d, MJ^-1, m^2), ğ“^3 ğŒ^-1, nothing}}
  Î³2: Unitful.Quantity{Float64, ğŒ ğ“^-3, Unitful.FreeUnits{(d^-1, MJ, m^-2), ğŒ ğ“^-3, nothing}}
  Tâ‚€: Float64 3.0
  Tâ‚: Float64 12.0
  Tâ‚‚: Float64 20.0
  Tâ‚ƒ: Float64 35.0
  SEAâ‚˜áµ¢â‚™: Float64 0.7
  SEAâ‚˜â‚â‚“: Float64 1.3
  STâ‚: Float64 625.0
  STâ‚‚: Float64 1300.0
  Î±_community_height: Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}
  Î²_community_height: Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(ha, kg^-1), ğ‹^2 ğŒ^-1, nothing}}
  exp_community_height: Float64 0.9
  height_strength_exp: Float64 0.5
  mowing_mid_days: Float64 10.0
  mowfactor_Î²: Float64 0.05
  leafnitrogen_graz_exp: Float64 1.5
  trampling_factor: Unitful.Quantity{Float64, ğ‹^2, Unitful.FreeUnits{(ha,), ğ‹^2, nothing}}
  trampling_height_exp: Float64 0.5
  trampling_half_factor: Float64 10000.0
  grazing_half_factor: Float64 1000.0
  Îº: Unitful.Quantity{Float64, ğŒ ğ“^-1, Unitful.FreeUnits{(d^-1, kg), ğŒ ğ“^-1, nothing}}
  lowbiomass: Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}
  lowbiomass_k: Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(ha, kg^-1), ğ‹^2 ğŒ^-1, nothing}}
  biomass_dens: Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}
  belowground_density_effect: Float64 2.0
  Î±_pet: Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}
  Î²_pet: Unitful.Quantity{Float64, ğ“ ğ‹^-1, Unitful.FreeUnits{(d, mm^-1), ğ“ ğ‹^-1, nothing}}
  sla_tr: Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}
  sla_tr_exponent: Float64 0.4
  Ï•_sla: Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}
  Î·_min_sla: Float64 -0.8
  Î·_max_sla: Float64 0.8
  Î²_Î·_sla: Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(g, m^-2), ğŒ ğ‹^-2, nothing}}
  Î²_sla: Float64 5.0
  Î´_wrsa: Float64 0.8
  Î´_sla: Float64 0.5
  maxtotalN: Float64 35.0
  Ï•_amc: Float64 0.35
  Î·_min_amc: Float64 0.05
  Î·_max_amc: Float64 0.6
  Îº_min_amc: Float64 0.2
  Î²_ÎºÎ·_amc: Float64 10.0
  Î²_amc: Float64 7.0
  Î´_amc: Float64 0.5
  Î´_nrsa: Float64 0.5
  Ï•_rsa: Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}
  Î·_min_rsa: Float64 0.05
  Î·_max_rsa: Float64 0.6
  Îº_min_rsa: Float64 0.4
  Î²_ÎºÎ·_rsa: Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(g, m^-2), ğŒ ğ‹^-2, nothing}}
  Î²_rsa: Float64 7.0
  b_biomass: Float64 1000.0
  b_sla: Float64 0.0005
  b_lncm: Float64 0.5
  b_amc: Float64 0.001
  b_height: Float64 0.01
  b_rsa_above: Float64 0.004
, doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  â€¦  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  â€¦  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, ntimesteps = 5844, plotID = &quot;HEG01&quot;, npatches = 1, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = 99, included = (senescence = true, senescence_season = true, potential_growth = true, clonalgrowth = true, mowing = true, trampling = true, grazing = true, belowground_competition = true, community_height_red = true, height_competition = true, pet_growth_reduction = true, sla_transpiration = true, water_growth_reduction = true, nutrient_growth_reduction = true, temperature_growth_reduction = true, season_red = true, radiation_red = true), likelihood_included = (biomass = true, trait = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), output_validation = (biomass_cutting_index = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  â€¦  89, 90, 90, 90, 91, 91, 91, 92, 92, 92], biomass_cutting_t = [1235, 1475, 1959, 2326, 2695, 3060, 3410, 3412, 3780, 4133  â€¦  5649, 5663, 5677, 5691, 5705, 5719, 5733, 5747, 5761, 5775], biomass_cutting_date = [Dates.Date(&quot;2009-05-20&quot;), Dates.Date(&quot;2010-01-15&quot;), Dates.Date(&quot;2011-05-14&quot;), Dates.Date(&quot;2012-05-15&quot;), Dates.Date(&quot;2013-05-19&quot;), Dates.Date(&quot;2014-05-19&quot;), Dates.Date(&quot;2015-05-04&quot;), Dates.Date(&quot;2015-05-06&quot;), Dates.Date(&quot;2016-05-08&quot;), Dates.Date(&quot;2017-04-26&quot;)  â€¦  Dates.Date(&quot;2021-06-20&quot;), Dates.Date(&quot;2021-07-04&quot;), Dates.Date(&quot;2021-07-18&quot;), Dates.Date(&quot;2021-08-01&quot;), Dates.Date(&quot;2021-08-15&quot;), Dates.Date(&quot;2021-08-29&quot;), Dates.Date(&quot;2021-09-12&quot;), Dates.Date(&quot;2021-09-26&quot;), Dates.Date(&quot;2021-10-10&quot;), Dates.Date(&quot;2021-10-24&quot;)], biomass_cutting_numeric_date = [2009.3808219178081, 2010.0383561643835, 2011.3643835616438, 2012.3688524590164, 2013.3780821917808, 2014.3780821917808, 2015.33698630137, 2015.3424657534247, 2016.3497267759562, 2017.3150684931506  â€¦  2021.4657534246576, 2021.504109589041, 2021.5424657534247, 2021.5808219178082, 2021.6191780821919, 2021.6575342465753, 2021.695890410959, 2021.7342465753425, 2021.772602739726, 2021.8109589041096], cutting_height = [0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.02, 0.04, 0.04, 0.04  â€¦  0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04]), daily_input = (temperature = [3.2, 0.2, 1.1, -0.7, 0.1, -0.7, -0.5, -2.1, -6.2, -4.2  â€¦  -5.8, -1.5, 6.0, -4.6, -7.8, -1.0, 4.9, 6.8, 11.1, 11.9], temperature_sum = [3.2, 3.4000000000000004, 4.5, 3.8000000000000003, 3.9000000000000004, 3.2, 2.7, 0.6000000000000001, -5.6000000000000005, -9.8  â€¦  3227.099999999999, 3225.599999999999, 3231.599999999999, 3226.999999999999, 3219.199999999999, 3218.199999999999, 3223.099999999999, 3229.899999999999, 3240.999999999999, 3252.899999999999], precipitation = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  â€¦  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  â€¦  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, ğŒ ğ“^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), ğŒ ğ“^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  â€¦  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  â€¦  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, ğ‹^-2, Unitful.FreeUnits{(ha^-1,), ğ‹^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  â€¦  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), u = (du_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[0.17402355471276384 kg ha^-1 d^-1;;; 0.17718661757516807 kg ha^-1 d^-1;;; 0.34364298917868863 kg ha^-1 d^-1;;; â€¦ ;;; 0.16774129628490697 kg ha^-1 d^-1;;; 0.17087253945358843 kg ha^-1 d^-1;;; 0.35318748411288686 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[-0.6279884640509255 mm d^-1;;], u_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[59.100455687556135 kg ha^-1;;; 54.80733431374622 kg ha^-1;;; 69.7144767571523 kg ha^-1;;; â€¦ ;;; 66.17663922909063 kg ha^-1;;; 66.91103932693309 kg ha^-1;;; 81.18643203690374 kg ha^-1], u_water = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[118.8668976407259 mm;;]), patch_variables = (WHC = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[120.05699583999998 mm;;], PWP = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[59.33808384000001 mm;;], nutrients = [0.15114285714285713;;]), calc = (biomass_cutting_t = [1235, 1475, 1959, 2326, 2695, 3060, 3410, 3412, 3780, 4133  â€¦  5649, 5663, 5677, 5691, 5705, 5719, 5733, 5747, 5761, 5775], biomass_cutting_numeric_date = [2009.3808219178081, 2010.0383561643835, 2011.3643835616438, 2012.3688524590164, 2013.3780821917808, 2014.3780821917808, 2015.33698630137, 2015.3424657534247, 2016.3497267759562, 2017.3150684931506  â€¦  2021.4657534246576, 2021.504109589041, 2021.5424657534247, 2021.5808219178082, 2021.6191780821919, 2021.6575342465753, 2021.695890410959, 2021.7342465753425, 2021.772602739726, 2021.8109589041096], cut_index = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  â€¦  89, 90, 90, 90, 91, 91, 91, 92, 92, 92], cutting_height = [0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.02, 0.04, 0.04, 0.04  â€¦  0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04], negbiomass = Bool[0; 0; â€¦ ; 0; 0;;;; 0; 0; â€¦ ; 0; 0;;;; 0; 0; â€¦ ; 0; 0;;;; â€¦ ;;;; 0; 0; â€¦ ; 0; 0;;;; 0; 0; â€¦ ; 0; 0;;;; 0; 0; â€¦ ; 0; 0], potgrowth = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[1.4016884013838782 kg ha^-1 d^-1, 1.5084074724747096 kg ha^-1 d^-1, 1.0100441760745178 kg ha^-1 d^-1, 1.3415076845497247 kg ha^-1 d^-1, 1.1191833874756847 kg ha^-1 d^-1, 1.7950698248966779 kg ha^-1 d^-1, 1.3142727575586837 kg ha^-1 d^-1, 1.7769832742043097 kg ha^-1 d^-1, 1.772849685447976 kg ha^-1 d^-1, 1.8788814517117236 kg ha^-1 d^-1  â€¦  2.556108221205647 kg ha^-1 d^-1, 0.8767630935892793 kg ha^-1 d^-1, 1.898614735949989 kg ha^-1 d^-1, 2.5351774416984143 kg ha^-1 d^-1, 2.890969410323731 kg ha^-1 d^-1, 1.489617932786959 kg ha^-1 d^-1, 1.3215729877917035 kg ha^-1 d^-1, 1.62414471373582 kg ha^-1 d^-1, 0.9061948269899084 kg ha^-1 d^-1, 1.5805263476490974 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[0.3135991443049901 kg ha^-1 d^-1, 0.31952506526989727 kg ha^-1 d^-1, 0.44947622205827364 kg ha^-1 d^-1, 0.3750502569714753 kg ha^-1 d^-1, 0.46575976473665387 kg ha^-1 d^-1, 0.6782626168144827 kg ha^-1 d^-1, 0.2627498034712034 kg ha^-1 d^-1, 0.5062125388850364 kg ha^-1 d^-1, 0.5089820351965647 kg ha^-1 d^-1, 0.27664619601965806 kg ha^-1 d^-1  â€¦  0.7717194902370716 kg ha^-1 d^-1, 0.4288955151159216 kg ha^-1 d^-1, 0.5651670893810802 kg ha^-1 d^-1, 0.33579624838620453 kg ha^-1 d^-1, 0.5253813471006867 kg ha^-1 d^-1, 0.3622750491183607 kg ha^-1 d^-1, 0.29837399343282145 kg ha^-1 d^-1, 0.32797907728672804 kg ha^-1 d^-1, 0.2315903705363846 kg ha^-1 d^-1, 0.48643851721041165 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  â€¦  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[0.13957558959222624 kg ha^-1 d^-1, 0.1423384476947292 kg ha^-1 d^-1, 0.10583323287958503 kg ha^-1 d^-1, 0.18616723589828296 kg ha^-1 d^-1, 0.1222405252162161 kg ha^-1 d^-1, 0.13427480125714966 kg ha^-1 d^-1, 0.12540708430963038 kg ha^-1 d^-1, 0.37800803973526526 kg ha^-1 d^-1, 0.12366440548557205 kg ha^-1 d^-1, 0.22752605854424154 kg ha^-1 d^-1  â€¦  0.23915379837133213 kg ha^-1 d^-1, 0.0676787260865838 kg ha^-1 d^-1, 0.3760008683684708 kg ha^-1 d^-1, 0.36276889225397807 kg ha^-1 d^-1, 0.4296078373594 kg ha^-1 d^-1, 0.252593276051808 kg ha^-1 d^-1, 0.11382980569689116 kg ha^-1 d^-1, 0.16023778100182107 kg ha^-1 d^-1, 0.06071783108279615 kg ha^-1 d^-1, 0.13325103309752478 kg ha^-1 d^-1], species_specific_red = [0.34152875312829345, 0.3233628622315254, 0.679313485761196, 0.4267761938099683, 0.6352791426294307, 0.5767935800881335, 0.30518330875186717, 0.434863985344232, 0.43826261181434945, 0.22476527039742095  â€¦  0.46087602328147864, 0.7467463832415636, 0.4544058357495068, 0.20219544199133568, 0.27741825563953537, 0.3712508146820966, 0.34464636066182247, 0.308265767849844, 0.39012412012668607, 0.4698184840837498], LAIs = [0.10695868384616763, 0.11510209958242644, 0.0770734748127736, 0.10236647186870894, 0.08540156427684592, 0.13697645332112368, 0.10028825538155517, 0.1355963222909584, 0.13528090039512028, 0.14337186993889192  â€¦  0.19504903574760313, 0.06690319078235772, 0.1448776583209627, 0.19345187005388853, 0.22060129973428638, 0.11366832554741768, 0.10084531429473936, 0.12393366513226829, 0.06914903904987181, 0.1206052770086667], biomass_per_patch = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[1.5e-323 kg ha^-1;;], relbiomass = [6.8222555297422e-310;;], lowbiomass_correction = [0.9714551839002088, 0.9896017795295554, 0.007739087095437482, 0.9316977995366302, 0.005792417276184257, 0.017025425497458925, 0.9922118816014043, 0.45507392570636446, 0.13710355889960701, 0.13824402836510374  â€¦  0.12416257817624547, 0.0019291583681089715, 0.5371113403328872, 0.44360229625356973, 0.9989878879509203, 0.860269415934647, 0.9352719662183682, 0.9824098864962373, 0.7890601954973406, 0.468470283132215], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], mean_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[65.57482696573388 kg ha^-1, 61.45377874104 kg ha^-1, 71.98021937103903 kg ha^-1, 61.00720912006102 kg ha^-1, 68.56468188627383 kg ha^-1, 88.10362789358798 kg ha^-1, 64.04924742479328 kg ha^-1, 81.90330295291196 kg ha^-1, 100.66731471518473 kg ha^-1, 88.42382389298518 kg ha^-1  â€¦  108.02672334099273 kg ha^-1, 57.14791154292244 kg ha^-1, 80.67354058756008 kg ha^-1, 101.32652478307224 kg ha^-1, 100.40408787429267 kg ha^-1, 62.96465470997162 kg ha^-1, 70.40022083258773 kg ha^-1, 73.98624952548056 kg ha^-1, 68.51270095045206 kg ha^-1, 84.98630107698293 kg ha^-1], species_cut_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[45.70620771796475 kg ha^-1, 44.210215651801505 kg ha^-1, 57.44082460217165 kg ha^-1, 43.48617735891292 kg ha^-1, 54.28719626067907 kg ha^-1, 68.01593286678907 kg ha^-1, 45.23678595380508 kg ha^-1, 59.849864720574445 kg ha^-1, 74.8798765371469 kg ha^-1, 44.27967743165923 kg ha^-1  â€¦  82.12738222825966 kg ha^-1, 46.15015750245008 kg ha^-1, 61.38777437684611 kg ha^-1, 49.67439335637392 kg ha^-1, 65.08748085037111 kg ha^-1, 44.56145630557342 kg ha^-1, 47.26304901844652 kg ha^-1, 49.603135360450835 kg ha^-1, 47.347895591595446 kg ha^-1, 64.30843663594426 kg ha^-1], K_prep = [6.82216391596054e-310, 6.8221645984154e-310, 6.82224724496644e-310, 6.8221627793906e-310, 6.82218466346553e-310, 6.82216391596687e-310, 6.8221650341481e-310, 6.82216503415047e-310, 6.82216503415284e-310, 6.82216391597635e-310  â€¦  3.0e-323, 6.82216391598584e-310, 6.82224724496644e-310, 6.8221629288917e-310, 6.82216292889327e-310, 6.82218639148345e-310, 5.0e-324, 1.5684e-319, 6.8221650341552e-310, 6.8221672380358e-310], denominator = [6.8221639160807e-310, 6.822163916087e-310, 6.82224724496644e-310, 6.8221639160744e-310, 6.82218466348925e-310, 6.82216391609335e-310, 6.8221650341908e-310, 6.82216503419315e-310, 6.82216503419552e-310, 6.8221639161155e-310  â€¦  1.5e-323, 6.82216391612813e-310, 6.82224724496644e-310, 6.82216292893754e-310, 6.8221629289391e-310, 6.8221863914937e-310, 5.0e-324, 1.5684e-319, 6.8221650341979e-310, 6.8221672380358e-310], traitmat = [-3.856400870867581 -3.8086432206392216 â€¦ -4.518419702573105 -4.055095828586328; -1.4417950256808751 -1.2699864496842714 â€¦ -1.482716106357589 -0.8959412381504506; â€¦ ; 0.5204226504297005 0.3271822943801811 â€¦ 1.0396467680769246 0.8081723418178165; 0.15416636471420084 1.1985995327965824 â€¦ 1.2077809040677203 0.38635435093006665], similarity_matprep = [1.85695245e-316 0.0 â€¦ 1.061592845e-315 NaN; 1.0e-323 1.090675367e-315 â€¦ NaN NaN; â€¦ ; 1.8569556e-316 1.0e-323 â€¦ NaN NaN; 4.262416950549681e180 0.0 â€¦ NaN NaN], amc_resid = [1.5229388508291588, 0.09359947658537272, -1.0821734938192344, 1.0288867698648432, -0.1332149999920049, 0.4383901031450742, -1.2172006758611948, 0.02814492278310479, 2.0815749326107587, -0.3883739564845643  â€¦  -0.6743079494934937, -0.5962868240218121, -0.15285872447075527, 0.6597972101183847, -0.8933858321473459, -1.0085029826371394, 0.9245615986058627, 0.29861739745680077, -1.7459636219505195, -1.0535377142401423], rsa_above_resid = [0.4850233722318578, 1.9297179788030974, -0.43054802004903614, -0.6959869391456405, -0.42186407445180885, -0.7569132263353215, 2.930207509334158, -0.6161362832131321, 0.11793776643784315, 0.020507973278086643  â€¦  0.15796153978307328, -0.0836897442686846, 0.3247573691888546, 1.1066631917627532, 0.9382686562678197, -0.21406222531286603, -0.22296961572071278, 0.36632167943299243, -1.2922860447851836, -0.2261044651007771], biomass_density_factor = [1.0030312441759923, 1.1358419540146585, 0.804182869749528, 0.8641662996185077, 0.7125064443067073, 0.7756903062001176, 2.1812063205688403, 0.7312039662067303, 1.1244095076646954, 0.714722512582047  â€¦  0.74344540215492, 0.7260444367029083, 0.7300554766427504, 0.9389022550958608, 0.9028161796599815, 0.7800535068700531, 0.7988471345931532, 0.7456566311682952, 1.2324318131238132, 0.7881372275334656], TS_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[1198.185377875943 kg ha^-1, 1125.9582647501416 kg ha^-1, 1338.147038158889 kg ha^-1, 1290.8702236797014 kg ha^-1, 1421.630877565903 kg ha^-1, 1362.501735064599 kg ha^-1, 812.5177782349796 kg ha^-1, 1403.3370031594284 kg ha^-1, 1131.6678849749946 kg ha^-1, 1419.4252125133407 kg ha^-1  â€¦  1391.735502740538 kg ha^-1, 1408.314481338074 kg ha^-1, 1404.440401861632 kg ha^-1, 1238.4288338498952 kg ha^-1, 1262.9366870223528 kg ha^-1, 1358.6858398325176 kg ha^-1, 1342.6085396160772 kg ha^-1, 1389.6703894509174 kg ha^-1, 1080.9355391392157 kg ha^-1, 1351.7000353081385 kg ha^-1], heightinfluence = [0.796053237244951, 0.8674608252319151, 1.4829876746977224, 0.8444448818075229, 1.381279659253262, 1.159365018612044, 0.8234153857556518, 0.9117746916518277, 0.9725611567615261, 0.5156657248640838  â€¦  1.0692610083152314, 1.693923383968118, 1.0739831196743315, 0.5078222091320003, 0.6867592418362581, 0.827924277631241, 0.7325605386995214, 0.730577434590646, 0.7799310545938966, 1.0458580817683134], relative_height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.007943211725286815 m, 0.008744477882419551 m, 0.03245291888818944 m, 0.007795624933116659 m, 0.026364207862765658 m, 0.024566557186632153 m, 0.008348952396968918 m, 0.010112833241580152 m, 0.01960485191027617 m, 0.004222946302221807 m  â€¦  0.024159099313365975 m, 0.034769458233501624 m, 0.01398006695859426 m, 0.004213052749019176 m, 0.0072285439680782465 m, 0.006908910700464213 m, 0.007483811341163988 m, 0.007494398062714558 m, 0.008635778222348834 m, 0.018807769409745587 m], relative_lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[1.1167101269595576 mg g^-1, 1.0966538103938468 mg g^-1, 1.0976635676365418 mg g^-1, 1.0478919428198321 mg g^-1, 1.0353510886673734 mg g^-1, 1.145407323510834 mg g^-1, 0.9608102938737123 mg g^-1, 1.1637248299016172 mg g^-1, 1.0189658988349741 mg g^-1, 0.8861235167431113 mg g^-1  â€¦  1.1178646851548357 mg g^-1, 1.2984183739412527 mg g^-1, 0.9027182334413976 mg g^-1, 1.0216928211944534 mg g^-1, 1.3270454488469616 mg g^-1, 1.3364100807353991 mg g^-1, 1.012167568164375 mg g^-1, 0.9585412709107252 mg g^-1, 0.7495280524261206 mg g^-1, 1.1927357430960717 mg g^-1], Ï = [1.0404132257503285, 0.9621559016600606, 1.0393911590132974, 0.9538487053324055, 0.9237830338425284, 1.1236778595479435, 0.7586253826021935, 1.2355933024257413, 0.8527550033553426, 0.7209806207741984  â€¦  1.0345218446842745, 1.432042429743686, 0.6771747598411407, 0.9113983847092914, 1.4820001235137483, 1.6045839751568642, 0.9072471616675253, 0.7942896022090302, 0.49416926689304363, 1.2377754684748665], low_Ï_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.3075557524262769 kg ha^-1, 0.34818320139449715 kg ha^-1, 0.2790066890608713 kg ha^-1, 0.27272318519197697 kg ha^-1, 0.2789450596712734 kg ha^-1, 0.2857072277781661 kg ha^-1, 0.3220574180426701 kg ha^-1, 0.240456146091074 kg ha^-1, 0.32192373804900926 kg ha^-1, 0.23041359985727028 kg ha^-1  â€¦  0.31460095766747964 kg ha^-1, 0.29650121010122854 kg ha^-1, 0.3122531158289562 kg ha^-1, 0.26837057369375955 kg ha^-1, 0.3050487530480941 kg ha^-1, 0.256832390981047 kg ha^-1, 0.25744875682578106 kg ha^-1, 0.27594127623539394 kg ha^-1, 0.2650736731984302 kg ha^-1, 0.274569484221479 kg ha^-1], nutrients_splitted = [0.15160100804831425, 0.17167439819250124, 0.1215464965992858, 0.13061256357091158, 0.10769025972521375, 0.11724004913710348, 0.3296737553088333, 0.11051625660667438, 0.16994646558703538, 0.10802520261597225  â€¦  0.11236646221141505, 0.10973643057595385, 0.1103426706125757, 0.1419083694130601, 0.13645421686860862, 0.11789951575264516, 0.12074003834279372, 0.11270067368229375, 0.1862732654692849, 0.11912131239005808], Nutred = [0.5933018041547677, 0.640293287457429, 0.5447731464829085, 0.5806723523383022, 0.5476397522993341, 0.5675277037960276, 0.6831183499647757, 0.5534011337084829, 0.5841286400098729, 0.5557608906368328  â€¦  0.5625790567987496, 0.5525289052490903, 0.5686309560575921, 0.6130717223361584, 0.6049343500979483, 0.5505492347666988, 0.5768362282569082, 0.5712754182656913, 0.5420296627172282, 0.5505167823505376], amc_nut = [0.584794906328006, 0.5773187057318849, 0.5290923988117525, 0.5806723523383022, 0.5476397522993341, 0.5675277037960276, 0.5968342307582615, 0.5534011337084829, 0.5826137435769886, 0.5404869297188587  â€¦  0.5346145664097207, 0.5357588481310217, 0.5478073764848718, 0.5811094408706753, 0.5354469014068414, 0.5295253058053501, 0.5768362282569082, 0.5622263070555077, 0.5340935046906565, 0.5290620798176525], rsa_above_nut = [0.5933018041547677, 0.640293287457429, 0.5447731464829085, 0.5400982469040468, 0.5412956734668609, 0.5355050780312383, 0.6831183499647757, 0.5370714325275197, 0.5841286400098729, 0.5557608906368328  â€¦  0.5625790567987496, 0.5525289052490903, 0.5686309560575921, 0.6130717223361584, 0.6049343500979483, 0.5505492347666988, 0.5511231659880069, 0.5712754182656913, 0.5420296627172282, 0.5505167823505376], Wp = [3.0, 3.0, 2.645263610484387, 2.84257194697491, 2.3437049460493804, 2.551540721870577, 3.0, 2.405208213712581, 3.0, 2.350994438262676  â€¦  2.4454749568526175, 2.3882365569450945, 2.4014303943074453, 3.0, 2.9697061164146805, 2.5658929499415586, 2.627712346244281, 2.4527485308910077, 3.0, 2.592483384670547], Waterred = [0.7231185304766926, 0.5821854138591487, 0.8408470464076017, 0.8703576075176016, 0.8398234848714449, 0.8766236016906435, 0.5425575959233299, 0.8618384463655445, 0.7714521646355391, 0.7842832853733527  â€¦  0.7661553245733124, 0.7978557176819173, 0.7440736858312482, 0.6494539849038244, 0.6677628872643561, 0.8144803934162085, 0.8156008089232243, 0.7386071528148416, 0.9228338899514524, 0.8159936510131097], W_sla = [0.9999999138826552, 0.9999998996736279, 0.9999997363432067, 0.999999614306254, 0.9999983882669121, 0.9999995641987951, 0.999999925083171, 0.9999895051414252, 0.999999965306329, 0.999996660518663  â€¦  0.9999985860899379, 0.9999993243293226, 0.9999893391080489, 0.9999997156992307, 0.9999994870860838, 0.9999968751877178, 0.9999996537748039, 0.9999986185149135, 0.9999999779539022, 0.9999996168451013], W_rsa = [0.7231185927497458, 0.582185472267705, 0.840847268102696, 0.8703579432092171, 0.8398248384449251, 0.8766239837244318, 0.5425576365700275, 0.8618474913330791, 0.7714521914000477, 0.7842859044814936  â€¦  0.7661564078495666, 0.7978562567699948, 0.7440816184049849, 0.6494541695441445, 0.6677632297694094, 0.8144829385224984, 0.815601091304872, 0.7386081731910177, 0.9228339102963391, 0.8159939636651942], mown_height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[6.8221645849523e-310 m, 6.8221647542263e-310 m, 6.82224724496644e-310 m, 6.82216458494914e-310 m, 6.82218515642763e-310 m, 6.8221645849618e-310 m, 6.8221639144064e-310 m, 6.82216391441352e-310 m, 6.8221639144254e-310 m, 6.82216458498076e-310 m  â€¦  1.0e-323 m, 6.82216458499025e-310 m, 6.82224724496644e-310 m, 6.822163484759e-310 m, 6.8221634847606e-310 m, 6.82218431436507e-310 m, 5.0e-324 m, 1.5684e-319 m, 6.82216391442775e-310 m, 6.8221678891242e-310 m], proportion_mown = [0.8308688448704827, 0.8575678275197622, 0.9512659216160859, 0.8496978389052753, 0.9438248025296319, 0.9202616112078625, 0.8419225631940203, 0.8710762960578347, 0.8866884970179422, 0.5969385072064642  â€¦  0.9062566692079675, 0.9626474449956034, 0.907079202219059, 0.5843914630253791, 0.7727526562183469, 0.8436396604054445, 0.8002803485170047, 0.7991946253927144, 0.8238042557125892, 0.9020143840120917], grazed_share = [0.043512851656628736, 0.049260805145371164, 0.039473742814233194, 0.03858475546942133, 0.039465023515484574, 0.04042173206471888, 0.04556454088618202, 0.03401962906641969, 0.04554562789987715, 0.032598814072458286  â€¦  0.044509604174286295, 0.04194885990382594, 0.04417743255067999, 0.03796894992214492, 0.04315816249479204, 0.03633653294146859, 0.03642373610823282, 0.039040049565158635, 0.037502505900050685, 0.0388459690385083], trampling_proportion = [0.0004347700541422093, 0.0004737698087348835, 0.0008099441110898481, 0.0004611994899413956, 0.0007543955657004422, 0.0006331953295699494, 0.00044971408330113344, 0.000497972137425003, 0.0005311710913270334, 0.0002816344493420516  â€¦  0.0005839843929110471, 0.0009251481269134732, 0.0005865634071216629, 0.0002773506582588003, 0.0003750783726339357, 0.00045217664619661996, 0.0004000930718843791, 0.00039900998567802263, 0.00042596481110551443, 0.0005712027205732725], trampled_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.021287552107724216 kg ha^-1, 0.02399953665637321 kg ha^-1, 0.0390062780293046 kg ha^-1, 0.022453387874110973 kg ha^-1, 0.037071173953528117 kg ha^-1, 0.030208743726445178 kg ha^-1, 0.02338579355556196 kg ha^-1, 0.02265693731912004 kg ha^-1, 0.027096141541303735 kg ha^-1, 0.013973135379050408 kg ha^-1  â€¦  0.028731629383298606 kg ha^-1, 0.042564894199572025 kg ha^-1, 0.030912174849727442 kg ha^-1, 0.01357084620584875 kg ha^-1, 0.017238727939770018 kg ha^-1, 0.019848870267444266 kg ha^-1, 0.019453268996049773 kg ha^-1, 0.020075739507109027 kg ha^-1, 0.022995384867358446 kg ha^-1, 0.026605380612525965 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[6.82216363332495e-310 kg ha^-1;;; 6.8221636333281e-310 kg ha^-1;;; 6.8221636333297e-310 kg ha^-1;;; â€¦ ;;; 6.82216365039196e-310 kg ha^-1;;; 6.82216365039354e-310 kg ha^-1;;; 6.82216535051216e-310 kg ha^-1], relative_sla = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[0.0007101435457216271 m^2 g^-1, 0.0006905724629167517 m^2 g^-1, 0.0006536623317309958 m^2 g^-1, 0.0007592298915932543 m^2 g^-1, 0.0006927074349896327 m^2 g^-1, 0.0008218109580514723 m^2 g^-1, 0.0006661676025155208 m^2 g^-1, 0.0010969900191087842 m^2 g^-1, 0.0008116382317123026 m^2 g^-1, 0.0010179573268033347 m^2 g^-1  â€¦  0.0012070739488329637 m^2 g^-1, 0.00045177864395462986 m^2 g^-1, 0.0010922313572653826 m^2 g^-1, 0.0012767423148373174 m^2 g^-1, 0.001323530877653963 m^2 g^-1, 0.0008299191811470247 m^2 g^-1, 0.0006678095382440814 m^2 g^-1, 0.0008054577766352635 m^2 g^-1, 0.0004148701229450671 m^2 g^-1, 0.0007986084211678399 m^2 g^-1], leaflifespan = Unitful.Quantity{Float64, ğ“, Unitful.FreeUnits{(d,), ğ“, nothing}}[50.88651521216607 d, 44.87675409313593 d, 97.23257755339125 d, 29.777636147741546 d, 70.21565702090864 d, 93.48121159188008 d, 57.45820569606534 d, 14.974906409699797 d, 134.49675856833295 d, 36.77114450725609 d  â€¦  49.79261126799043 d, 153.04192607924082 d, 15.002570878870522 d, 21.826442695862596 d, 16.783054858227626 d, 19.024127327491414 d, 79.20521396838122 d, 49.247123771463826 d, 290.54334739472546 d, 85.83951335262849 d], Î¼ = Unitful.Quantity{Float64, ğ“^-1, Unitful.FreeUnits{(d^-1,), ğ“^-1, nothing}}[0.0007895471496705581 d^-1, 0.0008684975463630649 d^-1, 0.0005085385655186066 d^-1, 0.0012074674783167877 d^-1, 0.0006272551347211161 d^-1, 0.000520920102436989 d^-1, 0.0007221186362604141 d^-1, 0.0022033514186484597 d^-1, 0.00042305370270137837 d^-1, 0.0010158571184554798 d^-1  â€¦  0.000802499030198196 d^-1, 0.0003960247153741834 d^-1, 0.0021996572748909132 d^-1, 0.0015744795896441145 d^-1, 0.001987517246021095 d^-1, 0.0017769448702462981 d^-1, 0.0005787629437119635 d^-1, 0.0008091726318722283 d^-1, 0.0003032548164293113 d^-1, 0.0005494893997914466 d^-1], TS = [1.0 0.6353891012079924 â€¦ 0.35981833725155465 0.5829219821220063; 0.6353891012079924 1.0 â€¦ 0.35787031398619107 0.5809739588566428; â€¦ ; 0.35981833725155465 0.35787031398619107 â€¦ 1.0 0.7768963551295482; 0.5829219821220063 0.5809739588566428 â€¦ 0.7768963551295482 1.0]), traits = (amc = [0.5303613772698965, 0.35303222645399085, 0.20716146535188834, 0.4690674413755016, 0.3248927801832268, 0.3958082320121276, 0.19040949170585791, 0.34491169143484535, 0.5996678441472023, 0.2932368124730832  â€¦  0.25776277944541226, 0.26744237001354754, 0.322455706774736, 0.4232768199288046, 0.23058316374770027, 0.21630130255465643, 0.45612447320332306, 0.3784675110793846, 0.1248091969805102, 0.2107141265093538], height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.23650284874699043 m, 0.28083542716130344 m, 0.8207808852953102 m, 0.266130571301572 m, 0.7120580220674734 m, 0.5016404344997768 m, 0.2530405401821829 m, 0.3102610208743601 m, 0.3530091733610995 m, 0.09924044026822874 m  â€¦  0.4266970211325124 m, 1.0708772129588422 m, 0.43047413448062727 m, 0.09624441377257514 m, 0.1760196591711688 m, 0.2558193471804969 m, 0.20028074204508475 m, 0.1991978555266654 m, 0.22702023911969138 m, 0.4082231825223823 m], lmpm = [0.5384654364784269, 0.5520199467281444, 0.41854498210552427, 0.5188233329840632, 0.45081751585004803, 0.6078626509926351, 0.46990524213432855, 0.43501873089414567, 0.5703450555499228, 0.47744805733826484  â€¦  0.5033257031022862, 0.521002603885922, 0.46183242752163567, 0.4924503417195683, 0.6076158381321095, 0.5248699240044312, 0.5488744107156635, 0.5385829707597807, 0.701842751796499, 0.5954047763120285], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[27.744884801319426 mg g^-1, 26.33556550584918 mg g^-1, 27.72671140120561 mg g^-1, 26.183760071502505 mg g^-1, 25.630613650209234 mg g^-1, 29.20609984626247 mg g^-1, 22.47659892627117 mg g^-1, 31.114491904460984 mg g^-1, 24.29938043863362 mg g^-1, 21.726748843669483 mg g^-1  â€¦  27.64004803271597 mg g^-1, 34.33072225336291 mg g^-1, 20.83752775559677 mg g^-1, 25.401021733472497 mg g^-1, 35.12458294278499 mg g^-1, 37.0357078977281 mg g^-1, 25.323832279171466 mg g^-1, 23.17563280619986 mg g^-1, 16.88999436668177 mg g^-1, 31.15111507600075 mg g^-1], sla = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[0.021143962592334028 m^2 g^-1, 0.022178249544088036 m^2 g^-1, 0.016532058307939024 m^2 g^-1, 0.025918933572675475 m^2 g^-1, 0.01870899700827985 m^2 g^-1, 0.016781089956631995 m^2 g^-1, 0.020190246869007826 m^2 g^-1, 0.033655577530762704 m^2 g^-1, 0.01461453228804259 m^2 g^-1, 0.023922286966585733 m^2 g^-1  â€¦  0.021319290573416833 m^2 g^-1, 0.01391449506815441 m^2 g^-1, 0.033631981131705124 m^2 g^-1, 0.029166336846545588 m^2 g^-1, 0.03222882160169033 m^2 g^-1, 0.030729791183918366 m^2 g^-1, 0.017871828105638407 m^2 g^-1, 0.021408718949858546 m^2 g^-1, 0.010906245168601371 m^2 g^-1, 0.01733381902850119 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[0.12774498120353692 m^2 g^-1, 0.16762290500870772 m^2 g^-1, 0.10247245228739105 m^2 g^-1, 0.09514553838980025 m^2 g^-1, 0.10271215534939414 m^2 g^-1, 0.0934637893009403 m^2 g^-1, 0.19523943038709146 m^2 g^-1, 0.09734965707245172 m^2 g^-1, 0.11761231250577582 m^2 g^-1, 0.11492295667215817 m^2 g^-1  â€¦  0.11871708923616352 m^2 g^-1, 0.11204678573464456 m^2 g^-1, 0.12332115666038562 m^2 g^-1, 0.14490411313685791 m^2 g^-1, 0.14025591660789624 m^2 g^-1, 0.10844811246368252 m^2 g^-1, 0.10820224165169821 m^2 g^-1, 0.12446845685060647 m^2 g^-1, 0.07868588650792509 m^2 g^-1, 0.1081157103639435 m^2 g^-1], ampm = [0.6272465908072172, 0.5810736281348888, 0.622789157261081, 0.6751269524052799, 0.6415569127676027, 0.6398554220975107, 0.5476386678874354, 0.617466082265553, 0.6003632163683398, 0.5947605267721366  â€¦  0.5464992397388057, 0.6172614352781012, 0.6108689211800162, 0.5702209207913433, 0.6395956190864311, 0.6723546475008004, 0.6377056452908928, 0.614124589555011, 0.7387818439963147, 0.6917199047377253]), transfer_function = (K_amc = [0.6565646927308484, 0.7969680058537717, 0.9226598437485147, 0.6932553356427732, 0.8249761551123541, 0.7549763397230642, 0.9325781142479661, 0.8050872110092615, 0.6304365447655242, 0.855286625344034  â€¦  0.8862100849044817, 0.8781675000154546, 0.8273714583247531, 0.7298350237328649, 0.9069942973932588, 0.916797605526312, 0.7028286626617738, 0.7717231939958382, 0.9619259963358651, 0.9204192926984966], H_amc = [0.1277764525049167, 0.32083100804893616, 0.4936572851542078, 0.17822608650881322, 0.3593422132794869, 0.2630924671192133, 0.5072949070909534, 0.33199491513773466, 0.09185024905259587, 0.4010191098480468  â€¦  0.44353886674366233, 0.4324803125212502, 0.3626357551965356, 0.22852315763268932, 0.4721171589157307, 0.48559670759867896, 0.19138941115993902, 0.28611939174427753, 0.5476482449618144, 0.49057652746043295], K_wrsa = [0.7231185956202828, 0.5821854729448945, 0.8408473764042794, 0.8703579792799462, 0.8398257238446513, 0.8766242773381734, 0.5425576370117303, 0.8618482018520643, 0.7714521960207539, 0.7842863966086128  â€¦  0.7661566206675936, 0.7978566893845708, 0.7440818516105345, 0.649454170910128, 0.6677632318048539, 0.814483085024753, 0.8156011873762242, 0.7386083274572909, 0.9228339299793099, 0.8159940870716307], K_nrsa = [0.8269491222626768, 0.7388659205905591, 0.9005296102526746, 0.9189737370499663, 0.8998910774029071, 0.9228901733363584, 0.7140985231323315, 0.9136551261575402, 0.8571576225129711, 0.865178997880383  â€¦  0.853847887917246, 0.8736604308653567, 0.8400511572565841, 0.78090885681883, 0.7923520198780336, 0.8840519281404706, 0.8847507421101402, 0.8366302046608068, 0.9517712062370687, 0.8849963044197692], H_rsa = [0.2827400574815741, 0.12125418774935842, 0.41763761879657013, 0.45145185125827164, 0.41646697523866294, 0.45863198444999037, 0.07584729240927435, 0.44170106462215697, 0.3381223079404471, 0.3528281627807021  â€¦  0.33205446118161763, 0.36837745658648735, 0.3067604549704042, 0.1983329041678551, 0.2193120364430617, 0.38742853492419604, 0.3887096938685902, 0.30048870854481247, 0.5115805447679593, 0.3891598914362435], H_sla = [-0.11488152855260558, -0.08433797237275809, -0.24583036884768117, 0.027557100096396336, -0.18530507430626897, -0.23904559765356703, -0.14274799098792246, 0.25091683175989177, -0.2967122613654648, -0.03231380009268181  â€¦  -0.10972536102686492, -0.31464574532289474, 0.25027840081855257, 0.12398292736457506, 0.2117041955828236, 0.16929636672770187, -0.20889336267277037, -0.10709177794662739, -0.3873965984540475, -0.22385232484308915]), output = (biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[59.95703633145522 kg ha^-1; 59.909697424317024 kg ha^-1; â€¦ ; 58.926432132843374 kg ha^-1; 59.100455687556135 kg ha^-1;;;; 59.95268446067236 kg ha^-1; 59.90061570132038 kg ha^-1; â€¦ ; 54.63014769617105 kg ha^-1; 54.80733431374622 kg ha^-1;;;; 59.97474646583949 kg ha^-1; 59.94424699430441 kg ha^-1; â€¦ ; 69.37083376797361 kg ha^-1; 69.7144767571523 kg ha^-1;;;; â€¦ ;;;; 59.955503899560945 kg ha^-1; 59.90698954667531 kg ha^-1; â€¦ ; 66.00889793280572 kg ha^-1; 66.17663922909063 kg ha^-1;;;; 59.98466926694941 kg ha^-1; 59.96647862708229 kg ha^-1; â€¦ ; 66.74016678747951 kg ha^-1; 66.91103932693309 kg ha^-1;;;; 59.971922000474265 kg ha^-1; 59.938968065049885 kg ha^-1; â€¦ ; 80.83324455279084 kg ha^-1; 81.18643203690374 kg ha^-1], mown = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; â€¦ ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1], grazed = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; â€¦ ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1], water = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[120.05699583999998 mm; 120.05699583999998 mm; â€¦ ; 119.49488610477682 mm; 118.8668976407259 mm;;;]), cut_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[2181.544255776555 kg ha^-1, 1578.2987269267853 kg ha^-1, 2222.233607758413 kg ha^-1, 2369.863479447735 kg ha^-1, 1715.1026821334806 kg ha^-1, 625.8565287682786 kg ha^-1, 1934.059632454816 kg ha^-1, 1813.551081367556 kg ha^-1, 1671.718457422691 kg ha^-1, 842.5336258439897 kg ha^-1  â€¦  712.8308622956032 kg ha^-1, 1024.4014085693607 kg ha^-1, 1323.866690187994 kg ha^-1, 1569.4232487444874 kg ha^-1, 1764.5309537867229 kg ha^-1, 1919.2827972512023 kg ha^-1, 1246.605894231131 kg ha^-1, 835.5351887130086 kg ha^-1, 1194.138886320444 kg ha^-1, 1401.9089787139908 kg ha^-1])</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">sol.output.biomass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5844Ã—1Ã—1Ã—25 DimArray{Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}},4}<span class="sgr33"> biomass</span><span class="sgr90"> with dimensions: </span>
  <span class="sgr31">Dim{</span><span class="sgr33">:time</span><span class="sgr31">}</span> Sampled{Dates.Date} <span class="sgr36">Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;)</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:x</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:y</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:species</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:25</span> ForwardOrdered Regular Points
[:, :, 1, 1]
                                     <span class="sgr90">1</span>
  <span class="sgr90">2006-01-01</span>   59.957 kg ha^-1
  <span class="sgr90">2006-01-02</span>  59.9097 kg ha^-1
  <span class="sgr90">2006-01-03</span>  59.8624 kg ha^-1
 â‹®                    
  <span class="sgr90">2021-12-28</span>  59.0183 kg ha^-1
  <span class="sgr90">2021-12-29</span>  58.9092 kg ha^-1
  <span class="sgr90">2021-12-30</span>  58.9264 kg ha^-1
  <span class="sgr90">2021-12-31</span>  59.1005 kg ha^-1
<span class="sgr90">[and 24 more slices...]</span></code></pre><p>The four dimension of the array are: daily time step, patch x dim, patch y dim, and species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.output.biomass; dims = (:x, :y)); dims = (:x, :y))
total_biomass = vec(sum(species_biomass; dims = :species))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg haâ»Â¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="1f701f3a.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color))
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.output.biomass; dims=(:x, :y)); dims = (:x, :y))
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = :species)
biomass_cumfraction = cumsum(biomass_fraction; dims = 2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, vec(ylower), vec(yupper);
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap,
             label = &quot;Specific leaf area [mÂ² gâ»Â¹]&quot;)

    fig
end</code></pre><img src="330b4c09.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.output.water; dims = (:x, :y)); dims = (:x, :y))

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="4f63eac2.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We can calculate for all traits the community weighted mean over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
traits = [:height, :sla, :lncm, :rsa_above, :amc, :ampm, :lmpm]
trait_names = [
    &quot;Potential\n height [m]&quot;, &quot;Specific leaf\narea [mÂ² gâ»Â¹]&quot;, &quot;Leaf nitrogen \nper leaf mass\n [mg gâ»Â¹]&quot;,
    &quot;Root surface\narea per above\nground biomass\n[mÂ² gâ»Â¹]&quot;, &quot;Arbuscular\n mycorrhizal\n colonisation&quot;,
    &quot;Aboveground\nbiomass per total\nbiomass [-]&quot;, &quot;Leaf biomass\nper total \nbiomass [-]&quot;]

begin
    fig = Figure(; size = (500, 1000))

    for i in eachindex(traits)
        trait_vals = sol.traits[traits[i]]
        weighted_trait = trait_vals .* relative_biomass&#39;
        cwm_trait = vec(sum(weighted_trait; dims = 1))

        Axis(fig[i, 1];
                xlabel = i == length(traits) ? &quot;Date [year]&quot; : &quot;&quot;,
                xticklabelsvisible = i == length(traits) ? true : false,
                ylabel = trait_names[i])
        lines!(sol.numeric_date, ustrip.(cwm_trait);
                color = :black, linewidth = 2)

    end

    [rowgap!(fig.layout, i, 5) for i in 1:length(traits)-1]

    fig
end</code></pre><img src="79a4028b.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.output.mown)
sum(sol.output.grazed)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.output.grazed; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.output.mown; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg haâ»Â¹]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_grazed)), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg haâ»Â¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_mown)), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="f41d9c4f.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.output.biomass; dims = (:x, :y)); dims = (:x, :y))
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="1a45ff12.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">Â« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 14 March 2024 17:06">Thursday 14 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
