<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li><li><a class="tocitem" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    trait_seed = 99);
p = sim.parameter(; input_obj);
sol = sim.solve_prob(; input_obj, p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (RUE_max = 0.003 kg MJ^-1, k = 0.6, α_sen = 0.0002 d^-1, β_sen = 0.03, α_ll = 2.41, β_ll = 0.38, Ψ₁ = 775.0, Ψ₂ = 3000.0, SENₘₐₓ = 3.0, γ1 = 0.0445 d m^2 MJ^-1, γ2 = 5.0 MJ d^-1 m^-2, T₀ = 3, T₁ = 12, T₂ = 20, T₃ = 35, SEAₘᵢₙ = 0.7, SEAₘₐₓ = 1.3, ST₁ = 625, ST₂ = 1300, α_community_height = 10000 kg ha^-1 m^-1, β_community_height = 0.0005 ha m kg^-1, height_strength_exp = 0.5, mowing_mid_days = 10.0, mowfactor_β = 0.05, leafnitrogen_graz_exp = 1.5, trampling_factor = 0.01 ha, trampling_height_exp = 0.5, grazing_half_factor = 500.0, κ = 22.0 kg d^-1, lowbiomass = 100.0 kg ha^-1, lowbiomass_k = 1.0 ha kg^-1, biomass_dens = 1200.0 kg ha^-1, belowground_density_effect = 2.0, α_pet = 2.0 mm d^-1, β_pet = 1.2 d mm^-1, sla_tr = 0.03 m^2 g^-1, sla_tr_exponent = 0.4, ϕ_sla = 0.025 m^2 g^-1, η_min_sla = -0.8, η_max_sla = 0.8, β_η_sla = 75 g m^-2, β_sla = 5.0, δ_wrsa = 0.8, δ_sla = 0.5, maxtotalN = 35.0, ϕ_amc = 0.35, η_min_amc = 0.05, η_max_amc = 0.6, κ_min_amc = 0.2, β_κη_amc = 10, β_amc = 7.0, δ_amc = 0.8, δ_nrsa = 0.5, ϕ_rsa = 0.12 m^2 g^-1, η_min_rsa = 0.05, η_max_rsa = 0.6, κ_min_rsa = 0.4, β_κη_rsa = 40 g m^-2, β_rsa = 7.0, b_biomass = 1000.0, b_sla = 0.0005, b_lncm = 0.5, b_amc = 0.001, b_height = 0.01, b_rsa_above = 0.004), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, ntimesteps = 5844, plotID = &quot;HEG01&quot;, npatches = 1, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = 99, included = (senescence = true, senescence_season = true, potential_growth = true, clonalgrowth = true, mowing = true, trampling = true, grazing = true, belowground_competition = true, community_height_red = true, height_competition = true, pet_growth_reduction = true, sla_transpiration = true, water_growth_reduction = true, nutrient_growth_reduction = true, temperature_growth_reduction = true, season_red = true, radiation_red = true), likelihood_included = (biomass = true, trait = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), output_validation = (cut_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[1750.6969327018023 kg ha^-1, 1721.352655703243 kg ha^-1, 1943.6597903857205 kg ha^-1, 2113.60058690826 kg ha^-1, 1452.7002831179047 kg ha^-1, 475.6429150414955 kg ha^-1, 1443.9390851944806 kg ha^-1, 1347.960821875644 kg ha^-1, 1351.8202071367753 kg ha^-1, 363.393061681265 kg ha^-1  …  706.5494044942191 kg ha^-1, 983.9624416572291 kg ha^-1, 1234.084862130362 kg ha^-1, 1416.7173580456135 kg ha^-1, 1591.1164724335467 kg ha^-1, 1778.1599279127809 kg ha^-1, 1028.4660030367097 kg ha^-1, 774.0951575351129 kg ha^-1, 1177.7845058020655 kg ha^-1, 1407.6089477147852 kg ha^-1], biomass_cutting_t = [1235, 1475, 1959, 2326, 2695, 3060, 3410, 3412, 3780, 4133  …  5649, 5663, 5677, 5691, 5705, 5719, 5733, 5747, 5761, 5775], biomass_cutting_numeric_date = [2009.3808219178081, 2010.0383561643835, 2011.3643835616438, 2012.3688524590164, 2013.3780821917808, 2014.3780821917808, 2015.33698630137, 2015.3424657534247, 2016.3497267759562, 2017.3150684931506  …  2021.4657534246576, 2021.504109589041, 2021.5424657534247, 2021.5808219178082, 2021.6191780821919, 2021.6575342465753, 2021.695890410959, 2021.7342465753425, 2021.772602739726, 2021.8109589041096], cut_index = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  89, 90, 90, 90, 91, 91, 91, 92, 92, 92], cutting_height = [0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.02, 0.04, 0.04, 0.04  …  0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04]), daily_input = (temperature = [3.2, 0.2, 1.1, -0.7, 0.1, -0.7, -0.5, -2.1, -6.2, -4.2  …  -5.8, -1.5, 6.0, -4.6, -7.8, -1.0, 4.9, 6.8, 11.1, 11.9], temperature_sum = [3.2, 3.4000000000000004, 4.5, 3.8000000000000003, 3.9000000000000004, 3.2, 2.7, 0.6000000000000001, -5.6000000000000005, -9.8  …  3227.099999999999, 3225.599999999999, 3231.599999999999, 3226.999999999999, 3219.199999999999, 3218.199999999999, 3223.099999999999, 3229.899999999999, 3240.999999999999, 3252.899999999999], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), u = (du_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.205390942574333 kg ha^-1 d^-1;;; 0.12058133978578467 kg ha^-1 d^-1;;; 0.2790859348660199 kg ha^-1 d^-1;;; … ;;; 0.39150223572549325 kg ha^-1 d^-1;;; 0.5329415754978196 kg ha^-1 d^-1;;; 0.33664730170676704 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[-0.6768016577058544 mm d^-1;;], u_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[51.46797277673574 kg ha^-1;;; 46.11677946959746 kg ha^-1;;; 33.88810101444415 kg ha^-1;;; … ;;; 101.12277017238306 kg ha^-1;;; 109.36297869290955 kg ha^-1;;; 47.627756451444164 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[118.78898513922549 mm;;]), patch_variables = (WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm;;], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm;;], nutrients = [0.15114285714285713;;]), calc = (negbiomass = Bool[0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; … ;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0], potgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[1.186497793101856 kg ha^-1 d^-1, 1.2357578056601797 kg ha^-1 d^-1, 0.47615063283158343 kg ha^-1 d^-1, 1.4906197937166732 kg ha^-1 d^-1, 0.6476451122343223 kg ha^-1 d^-1, 1.570176351330292 kg ha^-1 d^-1, 2.182746057725145 kg ha^-1 d^-1, 3.5337680591657588 kg ha^-1 d^-1, 0.9755940897536239 kg ha^-1 d^-1, 1.058015195019013 kg ha^-1 d^-1  …  2.1797882350281634 kg ha^-1 d^-1, 0.6555548160215258 kg ha^-1 d^-1, 1.1970725847819028 kg ha^-1 d^-1, 1.124284799969621 kg ha^-1 d^-1, 3.2138939510659763 kg ha^-1 d^-1, 3.2042364865167046 kg ha^-1 d^-1, 1.9098116026640466 kg ha^-1 d^-1, 2.411635495417024 kg ha^-1 d^-1, 1.4378321628891604 kg ha^-1 d^-1, 0.8997386037391332 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.32681361869008063 kg ha^-1 d^-1, 0.24042409543909718 kg ha^-1 d^-1, 0.33036037581720556 kg ha^-1 d^-1, 0.6309654755338827 kg ha^-1 d^-1, 0.41750966971407594 kg ha^-1 d^-1, 0.9256921744306409 kg ha^-1 d^-1, 0.3500950762789318 kg ha^-1 d^-1, 1.5836008784216689 kg ha^-1 d^-1, 0.3736596489341564 kg ha^-1 d^-1, 0.2220642953552232 kg ha^-1 d^-1  …  0.905324094803936 kg ha^-1 d^-1, 0.4677607132555264 kg ha^-1 d^-1, 0.47100273399954135 kg ha^-1 d^-1, 0.15935177959934338 kg ha^-1 d^-1, 0.65125757992709 kg ha^-1 d^-1, 1.1645235922803814 kg ha^-1 d^-1, 0.6158308031053482 kg ha^-1 d^-1, 0.6360291912898887 kg ha^-1 d^-1, 0.6319512742819271 kg ha^-1 d^-1, 0.41460519125325 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.12142267611574763 kg ha^-1 d^-1, 0.11984275565331251 kg ha^-1 d^-1, 0.05127444095118564 kg ha^-1 d^-1, 0.21259441147959093 kg ha^-1 d^-1, 0.07269857842243888 kg ha^-1 d^-1, 0.12070811780453508 kg ha^-1 d^-1, 0.21404971382842097 kg ha^-1 d^-1, 0.772557142260311 kg ha^-1 d^-1, 0.06993858383676504 kg ha^-1 d^-1, 0.13167354972737566 kg ha^-1 d^-1  …  0.20959804343014957 kg ha^-1 d^-1, 0.052006041896853136 kg ha^-1 d^-1, 0.24363930927327618 kg ha^-1 d^-1, 0.16533808014306264 kg ha^-1 d^-1, 0.49083453918436193 kg ha^-1 d^-1, 0.5584011824737553 kg ha^-1 d^-1, 0.1690558652632468 kg ha^-1 d^-1, 0.24452695556439538 kg ha^-1 d^-1, 0.0990096987841075 kg ha^-1 d^-1, 0.07795788954648296 kg ha^-1 d^-1], species_specific_red = [0.4334272902270304, 0.306145351880263, 1.0917586142118583, 0.6660728850316632, 1.0144075847775051, 0.9276864257601907, 0.25238633205814875, 0.7051649776063847, 0.6026845834445943, 0.33027056751721146  …  0.6535409671957053, 1.1227880259941063, 0.6191358972512426, 0.22303017257250535, 0.3188631194279475, 0.5718824534104837, 0.5074040416092739, 0.41500031164750045, 0.6916055049271678, 0.7251058730297306], LAIs = [0.09304785789809189, 0.09691094021921648, 0.03734081654376605, 0.1168977974946181, 0.050789804011375644, 0.12313680384653121, 0.17117591468574628, 0.277126135527371, 0.07650830937687271, 0.08297196007654091  …  0.17094395549661287, 0.051410100988147626, 0.09387715713427044, 0.08816897335398366, 0.2520408798035178, 0.25128351944915317, 0.14977177340738312, 0.18912594543721503, 0.11275807131849558, 0.07055954948494333], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1;;], relbiomass = [0.0;;], lowbiomass_correction = [0.9998313309928305, 0.9999999999987705, 1.0, 0.9999999994898934, 1.0, 5.097540315123487e-28, 3.18970993896727e-5, 0.0001759588018472759, 1.0, 1.051256601986637e-26  …  6.928308479763097e-23, 7.915052028947594e-35, 1.0, 4.419009091576093e-27, 3.375703335723127e-9, 1.5013034326321805e-9, 2.0090136456370457e-13, 3.2014895796942255e-10, 3.0384078965034104e-12, 0.9999999999999998], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], mean_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[56.409239198773854 kg ha^-1, 52.04714259189714 kg ha^-1, 33.70818829650214 kg ha^-1, 67.2525983026358 kg ha^-1, 39.30472700857849 kg ha^-1, 75.9748884866471 kg ha^-1, 110.40422953366713 kg ha^-1, 159.59651462352954 kg ha^-1, 56.03410286849438 kg ha^-1, 50.431910387509866 kg ha^-1  …  92.17701953271228 kg ha^-1, 42.53319505308386 kg ha^-1, 50.78290176132377 kg ha^-1, 46.08126572041 kg ha^-1, 113.93241263007225 kg ha^-1, 134.36396391208115 kg ha^-1, 102.68314404619511 kg ha^-1, 111.36223619322624 kg ha^-1, 109.07478185148425 kg ha^-1, 48.35143704969511 kg ha^-1], species_cut_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[39.31771570482043 kg ha^-1, 37.44302539546155 kg ha^-1, 26.89941970884557 kg ha^-1, 47.937915204097784 kg ha^-1, 31.120153559908427 kg ha^-1, 58.65255538751381 kg ha^-1, 77.97644313734705 kg ha^-1, 116.62325529881237 kg ha^-1, 41.68012940976707 kg ha^-1, 25.254604764931884 kg ha^-1  …  70.0776352526111 kg ha^-1, 34.34795074371096 kg ha^-1, 38.6427729937317 kg ha^-1, 22.590915109896766 kg ha^-1, 73.85728890422081 kg ha^-1, 95.09230114087521 kg ha^-1, 68.93612566875717 kg ha^-1, 74.66138791144812 kg ha^-1, 75.37962029135345 kg ha^-1, 36.58713564849211 kg ha^-1], K_prep = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], denominator = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], traitmat = [-3.856400870867581 -3.8086432206392216 … -4.518419702573105 -4.055095828586328; -1.4417950256808751 -1.2699864496842714 … -1.482716106357589 -0.8959412381504506; … ; 0.5204226504297005 0.3271822943801811 … 1.0396467680769246 0.8081723418178165; 0.15416636471420084 1.1985995327965824 … 1.2077809040677203 0.38635435093006665], similarity_matprep = [1.01654627e-315 9.9e-322 … 2.631277371124e-312 0.0; 2.121995795e-314 1.071619374e-315 … 0.0 7.85138442657e-313; … ; 1.18520242e-315 8.69849763e-316 … 6.364684e-317 1.200832244e-315; NaN 9.9e-322 … 0.0 9.39429146e-316], amc_resid = [1.5229388508291588, 0.09359947658537272, -1.0821734938192344, 1.0288867698648432, -0.1332149999920049, 0.4383901031450742, -1.2172006758611948, 0.02814492278310479, 2.0815749326107587, -0.3883739564845643  …  -0.6743079494934937, -0.5962868240218121, -0.15285872447075527, 0.6597972101183847, -0.8933858321473459, -1.0085029826371394, 0.9245615986058627, 0.29861739745680077, -1.7459636219505195, -1.0535377142401423], rsa_above_resid = [0.4850233722318578, 1.9297179788030974, -0.43054802004903614, -0.6959869391456405, -0.42186407445180885, -0.7569132263353215, 2.930207509334158, -0.6161362832131321, 0.11793776643784315, 0.020507973278086643  …  0.15796153978307328, -0.0836897442686846, 0.3247573691888546, 1.1066631917627532, 0.9382686562678197, -0.21406222531286603, -0.22296961572071278, 0.36632167943299243, -1.2922860447851836, -0.2261044651007771], biomass_density_factor = [1.0323108654755182, 1.1446925724982613, 0.7934555823348995, 0.8424461101569445, 0.7061227650455253, 0.7488461809940775, 2.172033987524396, 0.7127755794373806, 1.1670147996258606, 0.7246346438170501  …  0.7558881696000421, 0.7330399788728188, 0.7405558297158956, 0.9548250177883524, 0.9221729243963462, 0.7750271857363051, 0.792504571659694, 0.745698379198362, 1.1481139414816812, 0.7827701239896953], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[1181.0709750489982 kg ha^-1, 1121.5969344871337 kg ha^-1, 1347.1623476684913 kg ha^-1, 1307.4051199203086 kg ha^-1, 1428.0425223264285 kg ha^-1, 1386.707729776412 kg ha^-1, 814.2315709865238 kg ha^-1, 1421.3624572193557 kg ha^-1, 1110.8183981620639 kg ha^-1, 1409.68376930723 kg ha^-1  …  1380.2332071371532 kg ha^-1, 1401.5784634142328 kg ha^-1, 1394.4480634517604 kg ha^-1, 1228.0593364743718 kg ha^-1, 1249.6116418386937 kg ha^-1, 1363.0844950118726 kg ha^-1, 1347.97040714113 kg ha^-1, 1389.6314884590074 kg ha^-1, 1119.9245133343447 kg ha^-1, 1356.3261194537872 kg ha^-1], heightinfluence = [0.828890707807004, 0.9032438834239417, 1.5441614276998592, 0.8792785243960503, 1.4382579215434441, 1.2071892254466337, 0.8573815543798398, 0.9493857121156876, 1.0126796398738884, 0.5369371138464184  …  1.1133683936519465, 1.7637983077206238, 1.1182852937330694, 0.5287700503854837, 0.7150882973967428, 0.8620764396002266, 0.7627789135505807, 0.7607140057133239, 0.8121034795617224, 1.0890000883142708], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.006815857377060798 m, 0.007262020509481296 m, 0.015508388132112047 m, 0.008780789284376393 m, 0.015465339725734354 m, 0.021783130016369234 m, 0.014055897834193823 m, 0.020386207817263698 m, 0.01093628230529889 m, 0.0024105546691231584 m  …  0.020884530022681126 m, 0.026353213224805466 m, 0.008935148798565683 m, 0.0018939729601177469 m, 0.008146063162497125 m, 0.015064965767237563 m, 0.010963042692136273 m, 0.011280610435248214 m, 0.013889832109987375 m, 0.01085327497671728 m], relative_lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[1.1158438632541872 mg g^-1, 1.0591412111898626 mg g^-1, 1.1074869127956428 mg g^-1, 1.0632310091564938 mg g^-1, 1.0342315301969032 mg g^-1, 1.1743591162795772 mg g^-1, 0.9141662046395261 mg g^-1, 1.243825806675734 mg g^-1, 0.9869422287298191 mg g^-1, 0.8936716014070214 mg g^-1  …  1.113890090935343 mg g^-1, 1.3435605953187153 mg g^-1, 0.856949079371664 mg g^-1, 1.0275177480838196 mg g^-1, 1.383685581837173 mg g^-1, 1.1473072173887089 mg g^-1, 1.0285726436727995 mg g^-1, 0.9470978679735927 mg g^-1, 0.7085171001074035 mg g^-1, 1.241420281234472 mg g^-1], ρ = [1.0366317616132636, 0.9586588699554041, 1.0356134096586056, 0.9503818667896726, 0.9204254713601931, 1.1195937635153985, 0.75586809866272, 1.231102440866623, 0.8496555978661772, 0.7183601596982541  …  1.0307617932375404, 1.4268375582976067, 0.6747135146305967, 0.9080858352135162, 1.4766136768793823, 1.5987519878206893, 0.903949700120143, 0.7914026938433366, 0.49237316961732125, 1.2332766756606934], low_ρ_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[1.583820752889749e-35 kg ha^-1, 1.4641260995474863e-35 kg ha^-1, 1.398966828248333e-35 kg ha^-1, 1.727725465186524e-35 kg ha^-1, 1.4927933906153357e-35 kg ha^-1, 1.7039840467166445e-35 kg ha^-1, 1.4149078683816178e-35 kg ha^-1, 1.6876561885597582e-35 kg ha^-1, 1.5511460039358281e-35 kg ha^-1, 1.6520896445067875e-35 kg ha^-1  …  1.633616205305001e-35 kg ha^-1, 1.3425936510648283e-35 kg ha^-1, 1.5468319820220092e-35 kg ha^-1, 1.5404609511794228e-35 kg ha^-1, 1.5596338164235167e-35 kg ha^-1, 3.787295781400655e-37 kg ha^-1, 1.6508883957873138e-35 kg ha^-1, 1.615839450635987e-35 kg ha^-1, 1.6309196995810463e-35 kg ha^-1, 1.599171296067315e-35 kg ha^-1], nutrients_splitted = [0.15602641366758546, 0.17301210595759434, 0.11992514373004624, 0.12732971207800675, 0.1067254122025951, 0.113182751355962, 0.3282874226858301, 0.10773093757782123, 0.17638595114345149, 0.10952335045120556  …  0.11424709763383493, 0.11079375680677746, 0.11192972397705965, 0.14431498126001097, 0.13937985057304775, 0.11713982321557297, 0.11978140525942231, 0.11270698359883814, 0.17352922144108837, 0.11831011302587108], Nutred = [0.5953809453463718, 0.6408349641771149, 0.5443237833728258, 0.5392726858775341, 0.5410462366823519, 0.534592205165159, 0.682860323585162, 0.5364186617285623, 0.5870620689769325, 0.5562581729662356  …  0.5632600679506409, 0.552863921658375, 0.5692415381337543, 0.6142116681297158, 0.6063159470752802, 0.5503162599836116, 0.5508264230172792, 0.5712778999172536, 0.5387503159814623, 0.5502680887446298], amc_nut = [0.3375958044197057, 0.3245686588394364, 0.24605830891376299, 0.3273511454703133, 0.2757853106465638, 0.3058035453517569, 0.35377093192285414, 0.2840762186885706, 0.3343530964376934, 0.2653834546001404  …  0.2560506468036535, 0.25759872601094785, 0.2772203395220676, 0.3311932881102643, 0.25778437996066644, 0.24700759949233408, 0.32242593335280867, 0.29956548185109755, 0.25021035162064, 0.24625413893608517], rsa_above_nut = [0.5953809453463718, 0.6408349641771149, 0.5443237833728258, 0.5392726858775341, 0.5410462366823519, 0.534592205165159, 0.682860323585162, 0.5364186617285623, 0.5870620689769325, 0.5562581729662356  …  0.5632600679506409, 0.552863921658375, 0.5692415381337543, 0.6142116681297158, 0.6063159470752802, 0.5503162599836116, 0.5508264230172792, 0.5712778999172536, 0.5387503159814623, 0.5502680887446298], Wp = [3.0, 3.0, 2.608714968744024, 2.76978551396592, 2.3215830450452164, 2.4620486453663992, 3.0, 2.343456098653633, 3.0, 2.3824462065453753  …  2.4852012218875017, 2.410081179271596, 2.4347917151020773, 3.0, 3.0, 2.548126279059296, 2.6055882457880353, 2.4516993355298515, 3.0, 2.5735834305034127], Waterred = [0.7231185304766926, 0.5821854138591487, 0.8408469703814612, 0.8703574361892036, 0.8398231782677213, 0.876623130374633, 0.5425575959233299, 0.8618347903639069, 0.7714521646355391, 0.784283763745954  …  0.7661555713878572, 0.797855834803631, 0.7440749531121039, 0.6494539849038244, 0.6677629357943329, 0.8144801375798537, 0.8156007598004132, 0.7386071463107645, 0.9228338899514524, 0.8159936025706576], W_sla = [0.9999999138826552, 0.9999998996736279, 0.9999996834784476, 0.9999994449959133, 0.9999981997614567, 0.9999993182615514, 0.999999925083171, 0.9999857088786435, 0.999999965306329, 0.9999971464676807  …  0.9999988408022809, 0.9999993942406338, 0.9999909769829756, 0.9999997156992307, 0.9999995591790638, 0.9999965848992817, 0.999999613276549, 0.9999986112486521, 0.9999999779539022, 0.9999995788710685], W_rsa = [0.7231185927497458, 0.582185472267705, 0.8408472365277339, 0.8703579192414056, 0.8398246901524982, 0.8766237280027334, 0.5425576365700275, 0.8618471071255056, 0.7714521914000477, 0.7842860017314075  …  0.7661564595146776, 0.7978563181125686, 0.7440816669736526, 0.6494541695441445, 0.6677632301583452, 0.8144829191210559, 0.8156010752124757, 0.7386081720538591, 0.9228339102963391, 0.8159939462093162], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m  …  0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m, 0.0 m], proportion_mown = [0.8308688448704827, 0.8575678275197622, 0.9512659216160859, 0.8496978389052753, 0.9438248025296319, 0.9202616112078625, 0.8419225631940203, 0.8710762960578347, 0.8866884970179422, 0.5969385072064642  …  0.9062566692079675, 0.9626474449956034, 0.907079202219059, 0.5843914630253791, 0.7727526562183469, 0.8436396604054445, 0.8002803485170047, 0.7991946253927144, 0.8238042557125892, 0.9020143840120917], grazed_share = [0.0415540328647658, 0.03841365504761305, 0.036704098902405946, 0.04532959972311414, 0.039165786595961406, 0.04470670620340648, 0.03712233720644917, 0.044278319119057094, 0.040696759344765576, 0.043345174798421864  …  0.04286049501485691, 0.03522505977938614, 0.04058357418283417, 0.04041642015070506, 0.040919450478481216, 0.0009936567195610352, 0.043313658145620916, 0.04239409384768108, 0.042789747938668646, 0.04195677855080934], trampling_proportion = [0.009775714180831408, 0.010652615546020294, 0.018211424768165112, 0.010369974544147436, 0.016962427286130267, 0.014237265201546057, 0.010111727566242418, 0.011196799869505822, 0.011943271438457744, 0.006332491978261224  …  0.013130767532801204, 0.020801763087113283, 0.01318875613056934, 0.006236171827318719, 0.008433559145454395, 0.01016709778042631, 0.008996009451914111, 0.0089716564839816, 0.009577730123743314, 0.012843374290473034], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.16618872687472558 kg ha^-1, 0.18109232061017713 kg ha^-1, 0.30747989711347434 kg ha^-1, 0.17799420946235792 kg ha^-1, 0.28932058240680214 kg ha^-1, 0.24198391280077947 kg ha^-1, 0.1738411107688343 kg ha^-1, 0.18920095653134753 kg ha^-1, 0.2050465167616953 kg ha^-1, 0.11010078712190025 kg ha^-1  …  0.22367951988908824 kg ha^-1, 0.3441177113688147 kg ha^-1, 0.22926894117293922 kg ha^-1, 0.1066323010513807 kg ha^-1, 0.14043316908095607 kg ha^-1, 0.13313389497724368 kg ha^-1, 0.15445003326212833 kg ha^-1, 0.15497743058057561 kg ha^-1, 0.16983061778067796 kg ha^-1, 0.2163500203899945 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1;;; 0.0 kg ha^-1;;; 0.0 kg ha^-1;;; … ;;; 0.0 kg ha^-1;;; 0.0 kg ha^-1;;; 0.0 kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.0006093551692031842 m^2 g^-1, 0.0005734992364800688 m^2 g^-1, 0.0003123678699827183 m^2 g^-1, 0.0008551768143897866 m^2 g^-1, 0.00040634468778357244 m^2 g^-1, 0.0007286985641542526 m^2 g^-1, 0.0011215279853323205 m^2 g^-1, 0.002211394766311939 m^2 g^-1, 0.0004527606162190234 m^2 g^-1, 0.0005810734050307186 m^2 g^-1  …  0.0010434648989605076 m^2 g^-1, 0.00034242175574303736 m^2 g^-1, 0.0006980831871928941 m^2 g^-1, 0.0005739580217463382 m^2 g^-1, 0.001491526671829982 m^2 g^-1, 0.0018096491032535268 m^2 g^-1, 0.0009782748581215537 m^2 g^-1, 0.0012123796099739732 m^2 g^-1, 0.000667279335664722 m^2 g^-1, 0.0004608476744278553 m^2 g^-1], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[50.88651521216607 d, 44.87675409313593 d, 97.23257755339125 d, 29.777636147741546 d, 70.21565702090864 d, 93.48121159188008 d, 57.45820569606534 d, 14.974906409699797 d, 134.49675856833295 d, 36.77114450725609 d  …  49.79261126799043 d, 153.04192607924082 d, 15.002570878870522 d, 21.826442695862596 d, 16.783054858227626 d, 19.024127327491414 d, 79.20521396838122 d, 49.247123771463826 d, 290.54334739472546 d, 85.83951335262849 d], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[0.0007895471496705581 d^-1, 0.0008684975463630649 d^-1, 0.0005085385655186066 d^-1, 0.0012074674783167877 d^-1, 0.0006272551347211161 d^-1, 0.000520920102436989 d^-1, 0.0007221186362604141 d^-1, 0.0022033514186484597 d^-1, 0.00042305370270137837 d^-1, 0.0010158571184554798 d^-1  …  0.000802499030198196 d^-1, 0.0003960247153741834 d^-1, 0.0021996572748909132 d^-1, 0.0015744795896441145 d^-1, 0.001987517246021095 d^-1, 0.0017769448702462981 d^-1, 0.0005787629437119635 d^-1, 0.0008091726318722283 d^-1, 0.0003032548164293113 d^-1, 0.0005494893997914466 d^-1], TS = [1.0 0.6353891012079924 … 0.35981833725155465 0.5829219821220063; 0.6353891012079924 1.0 … 0.35787031398619107 0.5809739588566428; … ; 0.35981833725155465 0.35787031398619107 … 1.0 0.7768963551295482; 0.5829219821220063 0.5809739588566428 … 0.7768963551295482 1.0]), traits = (amc = [0.5303613772698965, 0.35303222645399085, 0.20716146535188834, 0.4690674413755016, 0.3248927801832268, 0.3958082320121276, 0.19040949170585791, 0.34491169143484535, 0.5996678441472023, 0.2932368124730832  …  0.25776277944541226, 0.26744237001354754, 0.322455706774736, 0.4232768199288046, 0.23058316374770027, 0.21630130255465643, 0.45612447320332306, 0.3784675110793846, 0.1248091969805102, 0.2107141265093538], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.23650284874699043 m, 0.28083542716130344 m, 0.8207808852953102 m, 0.266130571301572 m, 0.7120580220674734 m, 0.5016404344997768 m, 0.2530405401821829 m, 0.3102610208743601 m, 0.3530091733610995 m, 0.09924044026822874 m  …  0.4266970211325124 m, 1.0708772129588422 m, 0.43047413448062727 m, 0.09624441377257514 m, 0.1760196591711688 m, 0.2558193471804969 m, 0.20028074204508475 m, 0.1991978555266654 m, 0.22702023911969138 m, 0.4082231825223823 m], lmpm = [0.5384654364784269, 0.5520199467281444, 0.41854498210552427, 0.5188233329840632, 0.45081751585004803, 0.6078626509926351, 0.46990524213432855, 0.43501873089414567, 0.5703450555499228, 0.47744805733826484  …  0.5033257031022862, 0.521002603885922, 0.46183242752163567, 0.4924503417195683, 0.6076158381321095, 0.5248699240044312, 0.5488744107156635, 0.5385829707597807, 0.701842751796499, 0.5954047763120285], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[27.744884801319426 mg g^-1, 26.33556550584918 mg g^-1, 27.72671140120561 mg g^-1, 26.183760071502505 mg g^-1, 25.630613650209234 mg g^-1, 29.20609984626247 mg g^-1, 22.47659892627117 mg g^-1, 31.114491904460984 mg g^-1, 24.29938043863362 mg g^-1, 21.726748843669483 mg g^-1  …  27.64004803271597 mg g^-1, 34.33072225336291 mg g^-1, 20.83752775559677 mg g^-1, 25.401021733472497 mg g^-1, 35.12458294278499 mg g^-1, 37.0357078977281 mg g^-1, 25.323832279171466 mg g^-1, 23.17563280619986 mg g^-1, 16.88999436668177 mg g^-1, 31.15111507600075 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.021143962592334028 m^2 g^-1, 0.022178249544088036 m^2 g^-1, 0.016532058307939024 m^2 g^-1, 0.025918933572675475 m^2 g^-1, 0.01870899700827985 m^2 g^-1, 0.016781089956631995 m^2 g^-1, 0.020190246869007826 m^2 g^-1, 0.033655577530762704 m^2 g^-1, 0.01461453228804259 m^2 g^-1, 0.023922286966585733 m^2 g^-1  …  0.021319290573416833 m^2 g^-1, 0.01391449506815441 m^2 g^-1, 0.033631981131705124 m^2 g^-1, 0.029166336846545588 m^2 g^-1, 0.03222882160169033 m^2 g^-1, 0.030729791183918366 m^2 g^-1, 0.017871828105638407 m^2 g^-1, 0.021408718949858546 m^2 g^-1, 0.010906245168601371 m^2 g^-1, 0.01733381902850119 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.12774498120353692 m^2 g^-1, 0.16762290500870772 m^2 g^-1, 0.10247245228739105 m^2 g^-1, 0.09514553838980025 m^2 g^-1, 0.10271215534939414 m^2 g^-1, 0.0934637893009403 m^2 g^-1, 0.19523943038709146 m^2 g^-1, 0.09734965707245172 m^2 g^-1, 0.11761231250577582 m^2 g^-1, 0.11492295667215817 m^2 g^-1  …  0.11871708923616352 m^2 g^-1, 0.11204678573464456 m^2 g^-1, 0.12332115666038562 m^2 g^-1, 0.14490411313685791 m^2 g^-1, 0.14025591660789624 m^2 g^-1, 0.10844811246368252 m^2 g^-1, 0.10820224165169821 m^2 g^-1, 0.12446845685060647 m^2 g^-1, 0.07868588650792509 m^2 g^-1, 0.1081157103639435 m^2 g^-1], ampm = [0.6272465908072172, 0.5810736281348888, 0.622789157261081, 0.6751269524052799, 0.6415569127676027, 0.6398554220975107, 0.5476386678874354, 0.617466082265553, 0.6003632163683398, 0.5947605267721366  …  0.5464992397388057, 0.6172614352781012, 0.6108689211800162, 0.5702209207913433, 0.6395956190864311, 0.6723546475008004, 0.6377056452908928, 0.614124589555011, 0.7387818439963147, 0.6917199047377253]), transfer_function = (K_amc = [0.4505035083693575, 0.6751488093660347, 0.8762557499976236, 0.5092085370284372, 0.7199618481797665, 0.6079621435569027, 0.8921249827967457, 0.6881395376148185, 0.40869847162483863, 0.7684586005504545  …  0.8179361358471707, 0.8050680000247274, 0.7237943333196051, 0.5677360379725838, 0.8511908758292139, 0.8668761688420992, 0.5245258602588381, 0.634757110393341, 0.939081594137384, 0.8726708683175948], H_amc = [0.1277764525049167, 0.32083100804893616, 0.4936572851542078, 0.17822608650881322, 0.3593422132794869, 0.2630924671192133, 0.5072949070909534, 0.33199491513773466, 0.09185024905259587, 0.4010191098480468  …  0.44353886674366233, 0.4324803125212502, 0.3626357551965356, 0.22852315763268932, 0.4721171589157307, 0.48559670759867896, 0.19138941115993902, 0.28611939174427753, 0.5476482449618144, 0.49057652746043295], K_wrsa = [0.7231185956202828, 0.5821854729448945, 0.8408473764042794, 0.8703579792799462, 0.8398257238446513, 0.8766242773381734, 0.5425576370117303, 0.8618482018520643, 0.7714521960207539, 0.7842863966086128  …  0.7661566206675936, 0.7978566893845708, 0.7440818516105345, 0.649454170910128, 0.6677632318048539, 0.814483085024753, 0.8156011873762242, 0.7386083274572909, 0.9228339299793099, 0.8159940870716307], K_nrsa = [0.8269491222626768, 0.7388659205905591, 0.9005296102526746, 0.9189737370499663, 0.8998910774029071, 0.9228901733363584, 0.7140985231323315, 0.9136551261575402, 0.8571576225129711, 0.865178997880383  …  0.853847887917246, 0.8736604308653567, 0.8400511572565841, 0.78090885681883, 0.7923520198780336, 0.8840519281404706, 0.8847507421101402, 0.8366302046608068, 0.9517712062370687, 0.8849963044197692], H_rsa = [0.2827400574815741, 0.12125418774935842, 0.41763761879657013, 0.45145185125827164, 0.41646697523866294, 0.45863198444999037, 0.07584729240927435, 0.44170106462215697, 0.3381223079404471, 0.3528281627807021  …  0.33205446118161763, 0.36837745658648735, 0.3067604549704042, 0.1983329041678551, 0.2193120364430617, 0.38742853492419604, 0.3887096938685902, 0.30048870854481247, 0.5115805447679593, 0.3891598914362435], H_sla = [-0.11488152855260558, -0.08433797237275809, -0.24583036884768117, 0.027557100096396336, -0.18530507430626897, -0.23904559765356703, -0.14274799098792246, 0.25091683175989177, -0.2967122613654648, -0.03231380009268181  …  -0.10972536102686492, -0.31464574532289474, 0.25027840081855257, 0.12398292736457506, 0.2117041955828236, 0.16929636672770187, -0.20889336267277037, -0.10709177794662739, -0.3873965984540475, -0.22385232484308915]), output = (biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[59.957708943193985 kg ha^-1; 59.91036950499711 kg ha^-1; … ; 51.26258183416141 kg ha^-1; 51.46797277673574 kg ha^-1;;;; 59.95205664903378 kg ha^-1; 59.89998843493467 kg ha^-1; … ; 45.996198129811674 kg ha^-1; 46.11677946959746 kg ha^-1;;;; 59.9773228494666 kg ha^-1; 59.94682206774109 kg ha^-1; … ; 33.609015079578135 kg ha^-1; 33.88810101444415 kg ha^-1;;;; … ;;;; 59.956482672746915 kg ha^-1; 59.907967527864805 kg ha^-1; … ; 100.73126793665756 kg ha^-1; 101.12277017238306 kg ha^-1;;;; 59.98643331832861 kg ha^-1; 59.96824214350441 kg ha^-1; … ; 108.83003711741173 kg ha^-1; 109.36297869290955 kg ha^-1;;;; 59.97401893087328 kg ha^-1; 59.94106384320787 kg ha^-1; … ; 47.291109149737395 kg ha^-1; 47.627756451444164 kg ha^-1], mown = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; … ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], grazed = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; … ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm; 120.05699583999998 mm; … ; 119.46578679693134 mm; 118.78898513922549 mm;;;]), likelihood_calc = (simulated_cutted_biomass = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">sol.output.biomass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5844×1×1×25 DimArray{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}},4}<span class="sgr33"> biomass</span><span class="sgr90"> with dimensions: </span>
  <span class="sgr31">Dim{</span><span class="sgr33">:time</span><span class="sgr31">}</span> Sampled{Dates.Date} <span class="sgr36">Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;)</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:x</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:y</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:species</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:25</span> ForwardOrdered Regular Points
[:, :, 1, 1]
                                     <span class="sgr90">1</span>
  <span class="sgr90">2006-01-01</span>  59.9577 kg ha^-1
  <span class="sgr90">2006-01-02</span>  59.9104 kg ha^-1
  <span class="sgr90">2006-01-03</span>  59.8631 kg ha^-1
 ⋮                    
  <span class="sgr90">2021-12-28</span>    51.31 kg ha^-1
  <span class="sgr90">2021-12-29</span>  51.2205 kg ha^-1
  <span class="sgr90">2021-12-30</span>  51.2626 kg ha^-1
  <span class="sgr90">2021-12-31</span>   51.468 kg ha^-1
<span class="sgr90">[and 24 more slices...]</span></code></pre><p>The four dimension of the array are: daily time step, patch x dim, patch y dim, and species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.output.biomass; dims = (:x, :y)); dims = (:x, :y))
total_biomass = vec(sum(species_biomass; dims = :species))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg ha⁻¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="1f6fbde4.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color))
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.output.biomass; dims=(:x, :y)); dims = (:x, :y))
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = :species)
biomass_cumfraction = cumsum(biomass_fraction; dims = 2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, vec(ylower), vec(yupper);
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap,
             label = &quot;Specific leaf area [m² g⁻¹]&quot;)

    fig
end</code></pre><img src="0dd94a8d.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.output.water; dims = (:x, :y)); dims = (:x, :y))

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="07580e51.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We can calculate for all traits the community weighted mean over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
traits = [:height, :sla, :lncm, :rsa_above, :amc, :ampm, :lmpm]
trait_names = [
    &quot;Potential\n height [m]&quot;, &quot;Specific leaf\narea [m² g⁻¹]&quot;, &quot;Leaf nitrogen \nper leaf mass\n [mg g⁻¹]&quot;,
    &quot;Root surface\narea per above\nground biomass\n[m² g⁻¹]&quot;, &quot;Arbuscular\n mycorrhizal\n colonisation&quot;,
    &quot;Aboveground\nbiomass per total\nbiomass [-]&quot;, &quot;Leaf biomass\nper total \nbiomass [-]&quot;]

begin
    fig = Figure(; size = (500, 1000))

    for i in eachindex(traits)
        trait_vals = sol.traits[traits[i]]
        weighted_trait = trait_vals .* relative_biomass&#39;
        cwm_trait = vec(sum(weighted_trait; dims = 1))

        Axis(fig[i, 1];
                xlabel = i == length(traits) ? &quot;Date [year]&quot; : &quot;&quot;,
                xticklabelsvisible = i == length(traits) ? true : false,
                ylabel = trait_names[i])
        lines!(sol.numeric_date, ustrip.(cwm_trait);
                color = :black, linewidth = 2)

    end

    [rowgap!(fig.layout, i, 5) for i in 1:length(traits)-1]

    fig
end</code></pre><img src="aff3f234.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.output.mown)
sum(sol.output.grazed)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.output.grazed; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.output.mown; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg ha⁻¹]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_grazed)), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_mown)), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="1c80f3c8.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.output.biomass; dims = (:x, :y)); dims = (:x, :y))
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="309a1e82.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 5 March 2024 07:42">Tuesday 5 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
