<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    npatches = 1, nutheterog = 0.0);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (moistureconv_alpha = 0.005770219242443869, moistureconv_beta = 2.8251458862680428e-5, sen_α = 13.596882651330734, sen_leaflifespan = 3.560535466315811, sla_tr = 0.013357368106485636, sla_tr_exponent = 1.3046128930533996, βₚₑₜ = 0.5101369905784072, biomass_dens = 1076.2884929478287, belowground_density_effect = 1.0071358076972758, height_strength = 0.08840626237979175, leafnitrogen_graz_exp = 1.4404761159967254, trampling_factor = 199.2494880452916, grazing_half_factor = 116.0077387268054, mowing_mid_days = 15.757511543381788, totalN_β = 0.03832368437919404, CN_β = 0.09822840663519905, max_rsa_above_water_reduction = 0.5036506531583642, max_sla_water_reduction = 0.6032352808142815, max_amc_nut_reduction = 0.15850272303492818, max_rsa_above_nut_reduction = 0.3757056647419493, b_biomass = 1102.776745565195, b_soilmoisture = 3.9672282211666547, b_sla = 0.0, b_lncm = 0.0, b_amc = 0.0, b_height = 0.0, b_rsa_above = 0.0, b_var_sla = 0.0, b_var_lncm = 0.0, b_var_amc = 0.0, b_var_height = 0.0, b_var_rsa_above = 0.0), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, npatches = 1, ntimesteps = 5844, plotID = &quot;HEG01&quot;, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = missing, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 0.2 °C, 1.1 °C, -0.7 °C, 0.1 °C, -0.7 °C, -0.5 °C, -2.1 °C, -6.2 °C, -4.2 °C  …  -5.8 °C, -1.5 °C, 6.0 °C, -4.6 °C, -7.8 °C, -1.0 °C, 4.9 °C, 6.8 °C, 11.1 °C, 11.9 °C], temperature_sum = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 3.4000000000000004 °C, 4.5 °C, 3.8000000000000003 °C, 3.9000000000000004 °C, 3.2 °C, 2.7 °C, 0.6000000000000001 °C, -5.6000000000000005 °C, -9.8 °C  …  3227.099999999999 °C, 3225.599999999999 °C, 3231.599999999999 °C, 3226.999999999999 °C, 3219.199999999999 °C, 3218.199999999999 °C, 3223.099999999999 °C, 3229.899999999999 °C, 3240.999999999999 °C, 3252.899999999999 °C], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), patch = (xs = [1], ys = [1], WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm], nutrients = [0.5980535864510707], nneighbours = [0], neighbours = Union{Missing, Int64}[missing missing missing missing], surroundings = Union{Missing, Int64}[1 missing … missing missing]), traits = (TS = [1.0 0.7334936681658348 … 0.7438679780956846 0.804664115733044; 0.7334936681658348 1.0 … 0.7006444687851827 0.5381577838988788; … ; 0.7438679780956846 0.7006444687851827 … 1.0 0.8220737741912679; 0.804664115733044 0.5381577838988788 … 0.8220737741912679 1.0], amc = [0.20123731252932464, 0.4118195378102981, 0.14794857312254123, 0.3197024398543806, 0.25998553529672574, 0.31156550558375035, 0.7249428489222175, 0.19771279877361725, 0.060996977652432366, 0.12190681590396167  …  0.23355597240946008, 0.1287221608267934, 0.1798726271108728, 0.15475514335369067, 0.1677719143498077, 0.18519330461823758, 0.689042754464638, 0.03541791589355579, 0.3399788605495354, 0.12845603195894942], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[1.0278374012480769 m, 0.05467873949428617 m, 0.31082846874065095 m, 0.1289775551963183 m, 0.24487633976207812 m, 0.17054672787416963 m, 0.32595440795441327 m, 0.20557127762829858 m, 0.6144850139976272 m, 0.2976466644164279 m  …  0.3583681787976044 m, 0.570048054630794 m, 0.24212571859627752 m, 0.16378030481777817 m, 0.16995770562379586 m, 0.4094814858666474 m, 0.4105672761032536 m, 0.32879175854985776 m, 0.2770269477642767 m, 0.9228598351028056 m], lmpm = [0.22691589497075654, 0.5495299384863559, 0.4787626896913358, 0.5629839101172408, 0.4512937084404685, 0.4426439772126034, 0.624136442954971, 0.5663471391402342, 0.43800538307343473, 0.5440753223327832  …  0.5996535024536161, 0.4577015112649399, 0.43873350390378685, 0.5672810229623633, 0.38363173101790254, 0.5116769211967825, 0.586424396933469, 0.47514881488081884, 0.46827214899126235, 0.5588963159432464], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[23.008023818010237 mg g^-1, 22.761222631004284 mg g^-1, 22.511589137641685 mg g^-1, 35.22472899305767 mg g^-1, 24.311625294053513 mg g^-1, 33.95354600890998 mg g^-1, 19.256763230821953 mg g^-1, 20.391672379427693 mg g^-1, 35.98762088397272 mg g^-1, 26.799451813775423 mg g^-1  …  20.338858096813745 mg g^-1, 35.005627162050416 mg g^-1, 27.242357234832706 mg g^-1, 21.998955376003547 mg g^-1, 20.994922946683847 mg g^-1, 28.17663043109918 mg g^-1, 44.37391951204741 mg g^-1, 21.874370953120547 mg g^-1, 27.056392724931293 mg g^-1, 27.768508739928052 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.02358535250102706 m^2 g^-1, 0.027014258722284096 m^2 g^-1, 0.023829481303579963 m^2 g^-1, 0.026928440923504535 m^2 g^-1, 0.02587375917134058 m^2 g^-1, 0.029838171157339402 m^2 g^-1, 0.018650093914395798 m^2 g^-1, 0.01738831003951177 m^2 g^-1, 0.022581446898367916 m^2 g^-1, 0.029171565165109905 m^2 g^-1  …  0.021645950253133147 m^2 g^-1, 0.027201173139583288 m^2 g^-1, 0.017750614215339845 m^2 g^-1, 0.033700238903117345 m^2 g^-1, 0.01890475358397896 m^2 g^-1, 0.023123748518411855 m^2 g^-1, 0.030586992938922534 m^2 g^-1, 0.0336110826718732 m^2 g^-1, 0.02610266010307049 m^2 g^-1, 0.020912539650517602 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.13438894844228927 m^2 g^-1, 0.1516549061994082 m^2 g^-1, 0.10361957721616834 m^2 g^-1, 0.10893692453628254 m^2 g^-1, 0.1515070726333837 m^2 g^-1, 0.1441759777030574 m^2 g^-1, 0.10786832170356538 m^2 g^-1, 0.1016649950757751 m^2 g^-1, 0.10266309957256947 m^2 g^-1, 0.1041904835126172 m^2 g^-1  …  0.09073003544371988 m^2 g^-1, 0.1114877967876391 m^2 g^-1, 0.1140229156581106 m^2 g^-1, 0.11379094182802106 m^2 g^-1, 0.12837802375297927 m^2 g^-1, 0.10328133053082802 m^2 g^-1, 0.10109045598532373 m^2 g^-1, 0.13079027047568975 m^2 g^-1, 0.10868472188317548 m^2 g^-1, 0.1100580341561119 m^2 g^-1], ampm = [0.5675385764436572, 0.578452566827743, 0.6104182799024347, 0.6282972406188589, 0.5714777161954478, 0.6277731511760842, 0.6569857294262852, 0.6325502193864232, 0.63527444393879, 0.6673042379313643  …  0.6312142131090697, 0.585207149651593, 0.616419336604015, 0.5971379189077508, 0.6384292227967485, 0.6240976639383238, 0.6172888388773359, 0.5723568118307619, 0.6181134237377253, 0.6610952322568955], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[38.16968072594556 d, 26.7045429806908 d, 37.14920578609988 d, 26.929084209183287 d, 29.914647913310603 d, 20.55681457512141 d, 70.80075113132195 d, 85.13342315823576 d, 42.79870689991565 d, 21.816149785937043 d  …  47.839452374729554 d, 26.224346613021137 d, 80.63649622467311 d, 14.922737717018192 d, 68.31842898489374 d, 40.20761875865981 d, 19.258744480771718 d, 15.027131205148642 d, 29.229237305561384 d, 52.38182399440502 d], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[13.690164423632686 d^-1, 13.730213353484682 d^-1, 13.692726839408856 d^-1, 13.729101609786872 d^-1, 13.715905795999989 d^-1, 13.77008728151818 d^-1, 13.647172166758496 d^-1, 13.638705654967014 d^-1, 13.680075245785565 d^-1, 13.76008906040164 d^-1  …  13.671309411871928 d^-1, 13.732654783954542 d^-1, 13.6410380354684 d^-1, 13.835480657530045 d^-1, 13.648999415712174 d^-1, 13.685436402491364 d^-1, 13.781761549842042 d^-1, 13.833823117059541 d^-1, 13.718696827632842 d^-1, 13.664855379174195 d^-1], ρ = [0.8414038248410424, 0.8284335494875963, 0.8153772964570903, 1.5539854960427935, 0.9109232981086026, 1.4738501427488795, 0.6511205467942267, 0.7071074276888636, 1.6026964585868948, 1.0481685286800346  …  0.7044708408338566, 1.5400809976563496, 1.0732120453960763, 0.7887655873814593, 0.7374352634311426, 1.126627652799997, 2.1671955205957834, 0.7823391080391529, 1.062674905711404, 1.1031963900994828]), funresponse = (amc_nut_upper = [0.9912374216339039, 0.9691010985598236, 0.9944334243957321, 0.9797989753102652, 0.986256826126802, 0.9807381446497191, 0.9535423860463331, 0.9914865497537718, 0.9974965155393342, 0.9955913479667574  …  0.9886894961020816, 0.9953110691087003, 0.9926629573585453, 0.9940900700542187, 0.993382808666709, 0.9923267067263047, 0.9539991481216594, 0.9980382309021998, 0.9774148790252126, 0.9953223051980328], amc_nut_midpoint = [0.49864699673980073, 0.24260559762639888, 0.5356137963284361, 0.36634337112921816, 0.44103857470021235, 0.3772063419520359, 0.06264461191862081, 0.5015285553507777, 0.5710432639683467, 0.5490070039627626  …  0.46917622980974866, 0.5457651380612437, 0.5151355599127289, 0.5316423632363836, 0.523461772693372, 0.5112462923932986, 0.06792778385449683, 0.5773090543150615, 0.33876754715867496, 0.545895101109924], rsa_above_water_upper = [0.9032923283975487, 0.8821320106435951, 0.9483534132586491, 0.9409006327750796, 0.8822855397542657, 0.8905271584419867, 0.9424313489552306, 0.9509773115149981, 0.9496459753280883, 0.9475743598509341  …  0.9642341553698094, 0.9371911005464467, 0.9334407150831172, 0.9337860618871576, 0.9119107666358847, 0.948812345023452, 0.9517353079809294, 0.9083972906992619, 0.9412632342755692, 0.9392793432914784], rsa_above_nut_upper = [0.9278594799446818, 0.9120746274918047, 0.9614734636366872, 0.955913951645198, 0.9121891548059657, 0.9183371123400271, 0.9570558120525825, 0.963430799405905, 0.9624376694576735, 0.9608923172079482  …  0.9733199384383249, 0.953146771134063, 0.9503491155473925, 0.9506067321111056, 0.9342885316039344, 0.9618158105842891, 0.9639962380970274, 0.9316676021877888, 0.956184439605302, 0.954704526740543], rsa_above_midpoint = [0.2479754432442295, 0.1709499978507339, 0.41200181428924343, 0.3848730280941667, 0.171508857517577, 0.20150908518743132, 0.39044497162158065, 0.42155303815140577, 0.41670685559604015, 0.40916599034688517  …  0.469809133088264, 0.37136999966924666, 0.35771826182347294, 0.3589753550158214, 0.2793473277132203, 0.413672366877357, 0.42431221294612964, 0.26655796169119395, 0.38619292992174414, 0.37897138965762495], sla_water_midpoint = [-0.042399658352412994, 0.06031309998736989, -0.03509302560908423, 0.05775258691552665, 0.026203398412319667, 0.14357323045868586, -0.1869764992617382, -0.22234472852734166, -0.07235830211197347, 0.12413600499519983  …  -0.10009422404185087, 0.06588562464355885, -0.2122778011240457, 0.25212423224181735, -0.1797380993737857, -0.056194845123145654, 0.16519966504751626, 0.24971267083100335, 0.03306096267127534, -0.12167241461855882]), u = (u_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1 0.0 kg ha^-1 … 0.0 kg ha^-1 0.0 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[0.3 mm]), du = (du_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1 0.0 kg ha^-1 d^-1 … 0.0 kg ha^-1 d^-1 0.0 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.3 mm d^-1]), o = (biomass = [0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; … ;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], mown_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], grazed_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm; 0.29999999999999716 mm; … ; 0.0 mm; 0.3 mm;;]), calc = (negbiomass = [1; 0; … ; 0; 0;;; 1; 0; … ; 0; 0;;; 1; 0; … ; 0; 0;;; … ;;; 1; 0; … ; 0; 0;;; 1; 0; … ; 0; 0;;; 1; 0; … ; 0; 0], potgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.40445706447435364 kg ha^-1 d^-1, 1.1007208228588288 kg ha^-1 d^-1, 0.8016187718794922 kg ha^-1 d^-1, 1.0349099503658823 kg ha^-1 d^-1, 0.8763549258885054 kg ha^-1 d^-1, 0.9023697844060563 kg ha^-1 d^-1, 0.7599152333176611 kg ha^-1 d^-1, 0.6677372399673875 kg ha^-1 d^-1, 0.6677753000543889 kg ha^-1 d^-1, 1.0201297156901865 kg ha^-1 d^-1  …  0.8819841558167862 kg ha^-1 d^-1, 0.9124748013733894 kg ha^-1 d^-1, 0.5418741758440407 kg ha^-1 d^-1, 1.3731472359587307 kg ha^-1 d^-1, 0.487229198542334 kg ha^-1 d^-1, 0.8131338329574297 kg ha^-1 d^-1, 1.2462951651801364 kg ha^-1 d^-1, 1.1967565654135346 kg ha^-1 d^-1, 0.8481554232217026 kg ha^-1 d^-1, 0.7582885902604252 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], species_specific_red = [0.9839221477021841, 0.7843269377921864, 0.8480674285260449, 0.8268683125274031, 0.81581445331799, 0.8066957916421112, 0.8938929343395265, 0.8342048441544105, 0.9252603154516246, 0.839873141183242  …  0.8969325454586833, 0.8927385186846, 0.826716511402047, 0.7911347323681859, 0.8002229449024518, 0.8730147901735361, 0.9213959741840231, 0.8303913839078557, 0.8657856676025256, 0.9764599775526935], LAIs = [0.05658002743539642, 0.15398127471701936, 0.11213949783425387, 0.14477490573929466, 0.12259443610994347, 0.12623368867328774, 0.10630553531205605, 0.09341063533181607, 0.09341595960713694, 0.14270727939052683  …  0.12338191644285895, 0.12764729270562156, 0.07580348676968833, 0.1920913617477689, 0.06815912946576681, 0.1137503547803594, 0.17434585975185846, 0.1674158402761245, 0.11864957082090262, 0.10607798208851274], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1], relbiomass = [1.0], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [0.8079866054059434, 0.7659727261004002, 0.89745553506686, 0.8826580153240909, 0.766277558645951, 0.7826413191931443, 0.8856972572481349, 0.9026652935371304, 0.9000219212342037, 0.8959087220073919  …  0.9289867998663258, 0.8752927270923163, 0.8678463246309852, 0.8685320118268116, 0.8250985423890292, 0.8983667455694674, 0.9041702979706161, 0.818122524558833, 0.8833779617754968, 0.8794389398132499], denominator = [1.5623910021185878, 1.281901869816692, 2.925560147937805, 2.55662967375727, 1.283573790612396, 1.3802071253210226, 2.624608935686321, 3.0821482994294693, 3.000657781219873, 2.8820858556593385  …  4.224566692323181, 2.4056335529210022, 2.270084423776375, 2.2819243236977, 1.7152515713578729, 2.951789762917149, 3.130553405122895, 1.6494620857932618, 2.57241259514334, 2.4883656425656646], traitmat = [-3.7471294163738387 -3.6113904515486372 … -3.6457180501890716 -3.867406316651023; 0.02745698453063783 -2.906280319800911 … -1.2836404931790444 -0.08027791397099637; … ; 0.27181559485293416 0.31642424456184387 … 0.48154833043617007 0.6681787556771236; -1.2258084039800432 0.7065241759018946 … -0.12708215835487824 0.2366840155809931], similarity_matprep = [0.0 0.0 … 6.9530742501917e-310 5.88942562484557e-310; 7.9001903e-316 5.94656164234e-313 … 6.93015656605294e-310 0.0; … ; 7.82905157e-316 0.0 … 7.82928833e-316 -6.629926937817618e-96; 4.4e-323 9.81550733e-316 … 0.0 1.6135e-319], amc_resid = [-0.28671156798778313, 0.9546473148342769, -0.600842781715523, 0.4116272301391239, 0.05960269517007561, 0.36366090429035447, 2.800474535763337, -0.30748818601638567, -1.113412801660708, -0.7543560547586114  …  -0.09619664931607941, -0.7141803516660779, -0.4126540210486132, -0.5607188044581083, -0.4839863818610412, -0.3812892167419528, 2.58884745712645, -1.264198536241434, 0.5311544832497958, -0.7157491518515291], rsa_above_resid = [0.5952439542551159, 1.3062652750102537, -0.6718551129241295, -0.45288392304602665, 1.3001774101581962, 0.9982790229811102, -0.49688955587389366, -0.7523458447176667, -0.7112433708470951, -0.6483448880852481  …  -1.2026532964883232, -0.3478376474353172, -0.24344010442553463, -0.25299291008920444, 0.3477108795381519, -0.6857842912723481, -0.7760056699451294, 0.44704848217196363, -0.46326976239723183, -0.40671603280699836], nutgradient = [0.5;;], biomass_density_factor = [0.9377978772380037, 1.14184081307979, 0.9062557989329344, 0.910145691515491, 1.0285071406308892, 1.0072964120672054, 1.3798858451577165, 0.900567354134543, 0.9700162540106896, 0.9186525487347075  …  0.9695046698746701, 0.9063506881835448, 0.8892134981031544, 0.8961947974398288, 0.9237100246410974, 0.8960732712286211, 1.349350640328684, 1.0297872961936687, 0.9218825234910987, 0.9061280562328077], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[1147.1543037479566 kg ha^-1, 943.4769290432763 kg ha^-1, 1186.7930921780467 kg ha^-1, 1181.756691789128 kg ha^-1, 1046.6654238944438 kg ha^-1, 1068.5473712074695 kg ha^-1, 781.7652484182743 kg ha^-1, 1194.2362053637803 kg ha^-1, 1109.3178762245227 kg ha^-1, 1170.890629663515 kg ha^-1  …  1109.8990878949437 kg ha^-1, 1186.669722656144 kg ha^-1, 1209.375999545583 kg ha^-1, 1200.0215299851443 kg ha^-1, 1164.5250948425128 kg ha^-1, 1200.183124727819 kg ha^-1, 799.3295055178392 kg ha^-1, 1045.3734998778366 kg ha^-1, 1166.8172280002846 kg ha^-1, 1186.9592165185707 kg ha^-1], heightinfluence = [1.1776513443030758, 0.925747430167902, 0.9920522599328033, 0.9449798156221096, 0.974980429728559, 0.955740072624848, 0.9959676371910714, 0.9648062419152564, 1.0706543166263596, 0.9886401255757483  …  1.0043580015460118, 1.0591517277508746, 0.9742684263675454, 0.9539885715391692, 0.9555876031291601, 1.0175887753356434, 1.0178698341406258, 0.9967020906248807, 0.9833026738968265, 1.1504777077238966], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.04111349604992308 m, 0.0021871495797714468 m, 0.01243313874962604 m, 0.005159102207852731 m, 0.009795053590483126 m, 0.006821869114966786 m, 0.01303817631817653 m, 0.008222851105131943 m, 0.024579400559905092 m, 0.011905866576657115 m  …  0.014334727151904175 m, 0.02280192218523176 m, 0.0096850287438511 m, 0.006551212192711126 m, 0.006798308224951834 m, 0.016379259434665894 m, 0.016422691044130144 m, 0.013151670341994312 m, 0.011081077910571068 m, 0.03691439340411222 m], nutrients_splitted = [0.560853383848389, 0.6828819934185749, 0.5419895307939218, 0.5443158950038292, 0.615102384144839, 0.6024172318560878, 0.8252456785896392, 0.5385875359809149, 0.5801216996269256, 0.5494034514732088  …  0.5798157448996077, 0.542046279650565, 0.5317973216612938, 0.5359725127676804, 0.5524280930774151, 0.5358998335812198, 0.8069839898286181, 0.6158679857703746, 0.551335149460415, 0.5419131338139681], Nutred = [0.9324154591978479, 0.9635045724300071, 0.9196714579632265, 0.9488986838950253, 0.953221260414218, 0.956886864491959, 0.9530066420695902, 0.926165014850118, 0.9219744633453588, 0.9186512202662438  …  0.942248654853202, 0.9174032090622737, 0.9214828288800448, 0.918949896806814, 0.9251130110695569, 0.9234032288652526, 0.9533653804952237, 0.9302671793600191, 0.9523753049963446, 0.9173379395727995], amc_nut = [0.9324154591978479, 0.9635045724300071, 0.9196714579632265, 0.9488986838950253, 0.953221260414218, 0.956886864491959, 0.9530066420695902, 0.926165014850118, 0.9219744633453588, 0.9186512202662438  …  0.942248654853202, 0.9174032090622737, 0.9214828288800448, 0.918949896806814, 0.9251130110695569, 0.9234032288652526, 0.9533653804952237, 0.9302671793600191, 0.9523753049963446, 0.9173379395727995], rsa_above_nut = [0.8973090128893453, 0.90429681982479, 0.8646971758657741, 0.8740916538869631, 0.8998398693148686, 0.9015820787571307, 0.9419170381507727, 0.8596805799354494, 0.880740779147591, 0.8691484691540353  …  0.8628641218510144, 0.8767170780917684, 0.875946309345079, 0.8773125419251708, 0.894359699852231, 0.8611462944499539, 0.9421731645015243, 0.907141531970191, 0.8767313829587556, 0.874675329981265], water_splitted = [0.9377978772380037, 1.14184081307979, 0.9062557989329344, 0.910145691515491, 1.0285071406308892, 1.0072964120672054, 1.3798858451577165, 0.900567354134543, 0.9700162540106896, 0.9186525487347075  …  0.9695046698746701, 0.9063506881835448, 0.8892134981031544, 0.8961947974398288, 0.9237100246410974, 0.8960732712286211, 1.349350640328684, 1.0297872961936687, 0.9218825234910987, 0.9061280562328077], Waterred = [0.8960547346088873, 0.879327865600267, 0.9295293871363284, 0.9221338670262594, 0.8778125317608513, 0.8820828996042936, 0.9417689120346463, 0.9335642900470218, 0.9373370228313612, 0.9247509872279388  …  0.9477760124422661, 0.9187679554609826, 0.9208539096268031, 0.9024339928755192, 0.9052024146206674, 0.9290902547346004, 0.9494993883779248, 0.895591093950697, 0.9245173085949346, 0.9252239876395087], sla_water = [0.9955455307002968, 0.9973082365351764, 0.9945990784218605, 0.9916158282372078, 0.9960085686597594, 0.9920715226905145, 0.9997612647911659, 0.9978095453949888, 0.9967293201305771, 0.9888540653354132  …  0.9971435875945996, 0.9911081773854692, 0.99756291512536, 0.9768315710065658, 0.9975865486614347, 0.9948836107393398, 0.9983857461341828, 0.9880360039343371, 0.9929957270451186, 0.9964835268642983], rsa_above_water = [0.9000640422528694, 0.8817011966683501, 0.9345769640277781, 0.9299305646073982, 0.8813303011459489, 0.8891323653884048, 0.9419937991209999, 0.9356137094053003, 0.9404128120847943, 0.9351743797647927  …  0.9504910067451544, 0.9270107707966659, 0.9231035914271962, 0.9238378648487124, 0.9073923619311741, 0.9338682884163247, 0.9510345996569469, 0.9064356869430602, 0.9310385567781274, 0.9284889942445644], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], mowing_λ = [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN  …  NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], biomass_ρ = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1  …  NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1], grazed_share = [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN  …  NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], trampling_proportion = [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN  …  NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1  …  NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1, NaN kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1 NaN kg ha^-1 … NaN kg ha^-1 NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1  …  NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1, NaN m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">size(sol.o.biomass)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(5844, 1, 25)</code></pre><p>The three dimension of the array are: daily time step, patch within site, species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
total_biomass = vec(sum(species_biomass; dims=2))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg ha⁻¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="ab95652e.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color) + 0.0001)
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = 2)
biomass_cumfraction = cumsum(biomass_fraction; dims=2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, ylower, yupper;
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap, label = &quot;SLA [m² g⁻¹]&quot;)

    fig
end</code></pre><img src="64b52ddc.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.o.water; dims=2); dims = 2)

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="cc6c6a9d.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We calculate for all traits the community weighted mean over time.  As an example, we show here the specific leaf area (SLA):</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
trait_vals = sol.traits.sla
weighted_trait = trait_vals .* relative_biomass&#39;
cwm_trait = vec(sum(weighted_trait; dims = 1))

lines(sol.numeric_date, ustrip.(cwm_trait), color = :black, linewidth = 2;
      axis = (; ylabel = &quot;Community weighted mean\nspecific leaf area [m² kg⁻¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="6ef7066e.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.o.mown_biomass)
sum(sol.o.grazed_biomass)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.o.grazed_biomass; dims=2); dims=2)
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.o.mown_biomass; dims=2); dims=2)
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg ha⁻¹]&quot;)
      lines!(sol.numeric_date, ustrip.(cum_grazed), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(cum_mown), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="4d7a4e8d.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.o.biomass; dims = 2); dims = 2)
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="62eed7c1.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../../Modelling_API/main_equations/">Difference equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 21 November 2023 09:00">Tuesday 21 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
