<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li></ul></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    npatches = 1, nutheterog = 0.0);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (moistureconv_alpha = 0.02037577320704022, moistureconv_beta = 1.3344031835366224, sen_α = 9.594548519615396, sen_leaflifespan = 11.793866321332152, sla_tr = 0.009908918158486471, sla_tr_exponent = 2.4959875375040887, biomass_dens = 905.1894196309725, belowground_density_effect = 1.243431419474298, height_strength = 0.11624675015957471, leafnitrogen_graz_exp = 2.9221819460701206, trampling_factor = 65.13587711112287, grazing_half_factor = 157.3045262441305, mowing_mid_days = 6.106174292354222, totalN_β = 0.1, CN_β = 0.1, max_rsa_above_water_reduction = 0.2530927775106053, max_SLA_water_reduction = 0.8961798337437242, max_AMC_nut_reduction = 0.5200095484139818, max_rsa_above_nut_reduction = 0.7063511868742249, b_biomass = 1295.2142567548983, b_soilmoisture = 19.01215359412841, b_sla = 0.003958791090577544, b_lncm = 3.626705514150837, b_amc = 0.16342654224714848, b_height = 0.06186955140054361, b_rsa_above = 0.014533309346240423, b_var_sla = 6.613912654470809e-5, b_var_lncm = 20.544957165043726, b_var_amc = 0.007630530303688995, b_var_height = 0.0406815972546423, b_var_rsa_above = 0.0011803171892367265, amc_nut_lower = 0.47999045158601816, rsa_above_water_lower = 0.7469072224893947, rsa_above_nut_lower = 0.29364881312577507, sla_water_lower = 0.10382016625627577), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, npatches = 1, ntimesteps = 5844, plotID = &quot;HEG01&quot;, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = missing, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 0.2 °C, 1.1 °C, -0.7 °C, 0.1 °C, -0.7 °C, -0.5 °C, -2.1 °C, -6.2 °C, -4.2 °C  …  -5.8 °C, -1.5 °C, 6.0 °C, -4.6 °C, -7.8 °C, -1.0 °C, 4.9 °C, 6.8 °C, 11.1 °C, 11.9 °C], temperature_sum = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 3.4000000000000004 °C, 4.5 °C, 3.8000000000000003 °C, 3.9000000000000004 °C, 3.2 °C, 2.7 °C, 0.6000000000000001 °C, -5.6000000000000005 °C, -9.8 °C  …  3227.099999999999 °C, 3225.599999999999 °C, 3231.599999999999 °C, 3226.999999999999 °C, 3219.199999999999 °C, 3218.199999999999 °C, 3223.099999999999 °C, 3229.899999999999 °C, 3240.999999999999 °C, 3252.899999999999 °C], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), patch = (xs = [1], ys = [1], WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm], nutrients = [0.6013229371581524], nneighbours = [0], neighbours = Union{Missing, Int64}[missing missing missing missing], surroundings = Union{Missing, Int64}[1 missing … missing missing]), traits = (TS = [1.0 0.7467135436451628 … 0.5457213463203544 0.6454862598431523; 0.7467135436451628 1.0 … 0.7990078026751916 0.8987727161979894; … ; 0.5457213463203544 0.7990078026751916 … 1.0 0.9002350864772022; 0.6454862598431523 0.8987727161979894 … 0.9002350864772022 1.0], amc = [0.23786618563285247, 0.3391675339057905, 0.23540928867901995, 0.45721103608804353, 0.11569798095789176, 0.329509110413798, 0.04548271030707831, 0.6538775809651216, 0.22541266440531038, 0.22113626945963266  …  0.13854523109471856, 0.089487137181159, 0.22127071559090092, 0.5519479463709297, 0.14846016087282946, 0.18648002318835175, 0.34345029158400225, 0.4625743336013789, 0.5700771127085964, 0.4780403144470445], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.04520786874916115 m, 0.2070871874593896 m, 0.1350890889924459 m, 0.30926553306986126 m, 0.47707916508059206 m, 0.5612174065934886 m, 0.2121957437740352 m, 0.3788100192841239 m, 0.3439060380661358 m, 0.2192911164689373 m  …  1.1795808723777836 m, 0.22507008443083787 m, 0.19498709206997977 m, 0.31531895380629277 m, 0.544113346522498 m, 0.03963662082474974 m, 0.3097150989850454 m, 0.0520100679998049 m, 0.09491772678292773 m, 0.31583414237334784 m], lmpm = [0.503171787336824, 0.5391910291990318, 0.47636027758065425, 0.5814949963727797, 0.32091399538356724, 0.5628630551149534, 0.6209480473922935, 0.6064395056399393, 0.5910991049727251, 0.6061279264617611  …  0.4970227209491456, 0.5184703484405881, 0.5594481705166385, 0.5664537741226576, 0.6099317824322633, 0.5902767990453833, 0.6486501691871571, 0.4429065189101142, 0.6507620972747181, 0.5588939931513796], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[27.190816538755268 mg g^-1, 17.797755772443875 mg g^-1, 23.18254228763196 mg g^-1, 20.541619121904425 mg g^-1, 29.422781948767373 mg g^-1, 22.70953738310144 mg g^-1, 16.269055835529798 mg g^-1, 34.61512713112382 mg g^-1, 23.374663678330332 mg g^-1, 32.79534360213358 mg g^-1  …  29.170752625720645 mg g^-1, 14.728563809981653 mg g^-1, 25.592436573441887 mg g^-1, 34.17937101484419 mg g^-1, 35.69316562277233 mg g^-1, 19.411625221317042 mg g^-1, 27.307802147824262 mg g^-1, 21.47937080811961 mg g^-1, 15.635679852690048 mg g^-1, 22.347677899122925 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.03198823005001974 m^2 g^-1, 0.019588513855964055 m^2 g^-1, 0.03417708784284994 m^2 g^-1, 0.02900880608742552 m^2 g^-1, 0.03934382185128716 m^2 g^-1, 0.02535748435973962 m^2 g^-1, 0.015278864651554282 m^2 g^-1, 0.02090599250929166 m^2 g^-1, 0.022355242273477 m^2 g^-1, 0.0274168203495434 m^2 g^-1  …  0.016647324791190736 m^2 g^-1, 0.012820233890141476 m^2 g^-1, 0.014359128094687975 m^2 g^-1, 0.019126302010733662 m^2 g^-1, 0.016997713746169204 m^2 g^-1, 0.018555785894962522 m^2 g^-1, 0.02723559888410056 m^2 g^-1, 0.021817057656916442 m^2 g^-1, 0.013606851617214026 m^2 g^-1, 0.01893140100148102 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.15942590180233737 m^2 g^-1, 0.11610609892671378 m^2 g^-1, 0.1583608352215794 m^2 g^-1, 0.11427255265101716 m^2 g^-1, 0.14885084917325656 m^2 g^-1, 0.11581564869292059 m^2 g^-1, 0.16094145943479804 m^2 g^-1, 0.09515400319576255 m^2 g^-1, 0.10256596406793735 m^2 g^-1, 0.1260569995220511 m^2 g^-1  …  0.08811806415052523 m^2 g^-1, 0.20484130719008395 m^2 g^-1, 0.09848565889059417 m^2 g^-1, 0.11964679983744264 m^2 g^-1, 0.13915514792338332 m^2 g^-1, 0.12779877164010195 m^2 g^-1, 0.09846792411567448 m^2 g^-1, 0.1777400820502749 m^2 g^-1, 0.1078830397485231 m^2 g^-1, 0.11588748789521172 m^2 g^-1], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[17.117279414194037 d, 62.22019648211566 d, 14.381043955191728 d, 22.1397400893767 d, 9.928685519461778 d, 31.544167288713208 d, 119.64818823506032 d, 52.42500461563821 d, 43.94777816307005 d, 25.685013838570196 d  …  95.47088424791856 d, 189.8539514278406 d, 140.8839198232335 d, 66.25552694582915 d, 90.37858305142738 d, 71.75162386707777 d, 26.137206211934373 d, 46.85839984629366 d, 162.31644945204803 d, 68.06565765540653 d], ampm = [0.5296545129861305, 0.6240760211613863, 0.5244494913394643, 0.6315927643398791, 0.5240354766090086, 0.6215699090291131, 0.6536295235708353, 0.6383573743578309, 0.6825517829385491, 0.638029396275538  …  0.6936216073023946, 0.5457582615164086, 0.6380821696724185, 0.5962671306554291, 0.6420334551918562, 0.6213439989951404, 0.6827896517759549, 0.5838095147895399, 0.6850127339733876, 0.615013095312218], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[0.010283552071871042 d^-1, 0.009784098970886024 d^-1, 0.010414646584684894 d^-1, 0.01012724972901176 d^-1, 0.010782406297788984 d^-1, 0.009968432737682933 d^-1, 0.009693119726545516 d^-1, 0.009819514953243787 d^-1, 0.009862909442835917 d^-1, 0.010053721576537084 d^-1  …  0.00971808216460297 d^-1, 0.009656669251012523 d^-1, 0.009678261879778357 d^-1, 0.00977255429309562 d^-1, 0.009725042558392493 d^-1, 0.009758919243031784 d^-1, 0.01004577755403098 d^-1, 0.009846240134352962 d^-1, 0.009667208230699184 d^-1, 0.009767820426882354 d^-1], ρ = [1.212953957412679, 0.3515574079521183, 0.7611154184098828, 0.5345137187891957, 1.5274345313178677, 0.7166199380312404, 0.2704099720100695, 2.455933644160336, 0.7796945998000241, 2.097396393015151  …  1.489515558617627, 0.2021988809477839, 1.0161548973579002, 2.3666780295564824, 2.6861951953325027, 0.45305688864453375, 1.2282668144027178, 0.6089909743075752, 0.24078419699581674, 0.6837606195875737]), funresponse = (amc_nut_upper = [0.9616602436680678, 0.9262191807584623, 0.9623662653060698, 0.8837781715534192, 0.9863306910700084, 0.9299623159718727, 0.992913362177735, 0.8511271738471677, 0.9651465735304086, 0.9662903471721621  …  0.9831999137921233, 0.989265586565594, 0.9662548054792539, 0.8622764320022234, 0.9816547423691394, 0.9745529235503603, 0.9245520881344378, 0.8822096484429839, 0.8595476980468191, 0.8779248891932895], amc_nut_midpoint = [0.4648302641949734, 0.33988009318538975, 0.46731939734060846, 0.19025107750053055, 0.5518078085654035, 0.3530768019359298, 0.5750155177333854, 0.07513749421339067, 0.47712158608919464, 0.48115404731920525  …  0.5407700144320164, 0.5621550065318983, 0.481028742369459, 0.11444505439174568, 0.5353223947025122, 0.5102843906745619, 0.3340026309605132, 0.1847211296154671, 0.10482469466277705, 0.16961488400568564], rsa_above_water_upper = [0.9370722005382819, 0.9649866753978718, 0.9375376605364709, 0.9663658888002513, 0.9422760951383901, 0.9652057744459938, 0.9364319985573513, 0.9794877694689264, 0.9747617787646466, 0.9574594999687576  …  0.9834207642254271, 0.9265393988973297, 0.977432766693217, 0.9623042561432809, 0.9481640996347711, 0.9561622018884395, 0.9774440158818943, 0.9309307839712567, 0.9710602584336493, 0.9651516022720225], rsa_above_nut_upper = [0.8243761585203464, 0.9022820657610846, 0.8256752008138368, 0.9061312827687997, 0.8388995959858851, 0.9028935445800623, 0.8225894325872027, 0.942752857179204, 0.9295631914133183, 0.881274633820667  …  0.9537293676175864, 0.7949803890583529, 0.9370175941506439, 0.8947957595819397, 0.8553323010407151, 0.8776540325226945, 0.9370489892692712, 0.8072362111703059, 0.9192326979683622, 0.9027423566253662], rsa_above_midpoint = [0.14416861088954247, 0.34637326384704137, 0.14754027300652012, 0.35636390020274156, 0.18186416872952038, 0.34796035610694126, 0.13953116669516225, 0.45141513581098064, 0.4171813802040414, 0.2918485091077861  …  0.47990465043814456, 0.0678719400335892, 0.4365292701380945, 0.3269425685826903, 0.22451522742905006, 0.282451244447332, 0.43661075611639066, 0.09968190598647164, 0.390368601611242, 0.3475679480214257], sla_water_midpoint = [0.2049760205583706, -0.16015219340048126, 0.26493527765379077, 0.11936634074075103, 0.39311330573622305, 0.010723888396740655, -0.27936717311908654, -0.12186427832613744, -0.07908360346264676, 0.07230674450628816  …  -0.24269475320842993, -0.34193960400079976, -0.3032967966226338, -0.17341548852328514, -0.23311285545505678, -0.1896489715305839, 0.06691128239647504, -0.09503736939004881, -0.32241178046612423, -0.17897885972500716]), u = (u_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.13901653888793275 kg ha^-1 2.7238880090168416e-7 kg ha^-1 … 5.387069067238922e-9 kg ha^-1 6.823303732948401e-8 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[76.00685518399715 mm]), du = (du_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.002006992336134125 kg ha^-1 d^-1 -6.983273979526841e-10 kg ha^-1 d^-1 … -5.134423466541582e-11 kg ha^-1 d^-1 -1.1239133900473963e-10 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[-0.7525628277199305 mm d^-1]), o = (biomass = [59.395365916876464 kg ha^-1; 58.78457057864243 kg ha^-1; … ; 0.13700954655179862 kg ha^-1; 0.13901653888793275 kg ha^-1;;; 59.420765982895574 kg ha^-1; 58.839387327593066 kg ha^-1; … ; 2.730871282996368e-7 kg ha^-1; 2.7238880090168416e-7 kg ha^-1;;; 59.387993970570335 kg ha^-1; 58.76948900199345 kg ha^-1; … ; 6.543803875690327 kg ha^-1; 6.655058829996115 kg ha^-1;;; … ;;; 59.417041315488746 kg ha^-1; 58.83200685862367 kg ha^-1; … ; 7.793430915077964e-8 kg ha^-1; 7.739727472543504e-8 kg ha^-1;;; 59.42628875818071 kg ha^-1; 58.85180245037772 kg ha^-1; … ; 5.438413301904338e-9 kg ha^-1; 5.387069067238922e-9 kg ha^-1;;; 59.42292064224696 kg ha^-1; 58.842488224172605 kg ha^-1; … ; 6.834542866848875e-8 kg ha^-1; 6.823303732948401e-8 kg ha^-1], water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm; 118.6256575467159 mm; … ; 76.75941801171707 mm; 76.00685518399715 mm;;]), calc = (negbiomass = [0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; … ;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0], potgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.011099035623596182 kg ha^-1 d^-1, 1.2320504198127055e-8 kg ha^-1 d^-1, 0.541524114367527 kg ha^-1 d^-1, 8.225531251514232 kg ha^-1 d^-1, 4.337706646258883e-29 kg ha^-1 d^-1, 0.499098959826706 kg ha^-1 d^-1, 5.913105683025201e-5 kg ha^-1 d^-1, 2.577873321667511e-25 kg ha^-1 d^-1, 7.536375651026809e-10 kg ha^-1 d^-1, 1.7027187784043476e-20 kg ha^-1 d^-1  …  4.267350095206196e-26 kg ha^-1 d^-1, 4.867998050810026e-8 kg ha^-1 d^-1, 3.53979281763526e-26 kg ha^-1 d^-1, 4.8334133165766725e-30 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0013817503169751997 kg ha^-1 d^-1, 1.3553161353235064e-6 kg ha^-1 d^-1, 3.43863732874282e-9 kg ha^-1 d^-1, 1.874019320370255e-10 kg ha^-1 d^-1, 3.1344251665245544e-9 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.006233826755060706 kg ha^-1 d^-1, 7.317407074923405e-9 kg ha^-1 d^-1, 0.315709168360206 kg ha^-1 d^-1, 4.9736410179266555 kg ha^-1 d^-1, 2.9561140805926637e-29 kg ha^-1 d^-1, 0.3380979789966671 kg ha^-1 d^-1, 3.660550770717054e-5 kg ha^-1 d^-1, 1.6859158550239212e-25 kg ha^-1 d^-1, 4.958449520079368e-10 kg ha^-1 d^-1, 1.0516987840022571e-20 kg ha^-1 d^-1  …  3.763778132373668e-26 kg ha^-1 d^-1, 2.985410268973644e-8 kg ha^-1 d^-1, 2.211216010796134e-26 kg ha^-1 d^-1, 2.8802927023349742e-30 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0008006661489565503 kg ha^-1 d^-1, 8.573231875025134e-7 kg ha^-1 d^-1, 1.7650453424658359e-9 kg ha^-1 d^-1, 1.0637858683692481e-10 kg ha^-1 d^-1, 1.890366283691546e-9 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.004226834418926581 kg ha^-1 d^-1, 8.01573447287609e-9 kg ha^-1 d^-1, 0.2044542140544181 kg ha^-1 d^-1, 3.5100834323136025 kg ha^-1 d^-1, 2.1846004143811796e-29 kg ha^-1 d^-1, 0.24383456729507513 kg ha^-1 d^-1, 4.4439092699222124e-5 kg ha^-1 d^-1, 1.434359012204612e-25 kg ha^-1 d^-1, 4.3207999630794176e-10 kg ha^-1 d^-1, 7.396559280674369e-21 kg ha^-1 d^-1  …  3.912383451314974e-26 kg ha^-1 d^-1, 4.343690299900751e-8 kg ha^-1 d^-1, 3.062418563514642e-26 kg ha^-1 d^-1, 2.9255536453243243e-30 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.000860852992103329 kg ha^-1 d^-1, 5.921943855233708e-7 kg ha^-1 d^-1, 2.3020797678104335e-9 kg ha^-1 d^-1, 1.5772282150234063e-10 kg ha^-1 d^-1, 2.0027576226962857e-9 kg ha^-1 d^-1], species_specific_red = [0.811379341682464, 0.8579919194575422, 0.842216714735121, 0.8735040885125236, 0.9844994435090431, 0.9786116301950281, 0.8943041713702252, 0.9447758548378465, 0.9504687035286274, 0.8922835960604031  …  1.2741489580839358, 0.8859477090610293, 0.9024180831685485, 0.8608691654516727, 1.0089118758184659, 0.8370981023895102, 0.9138152976274054, 0.7415218554689429, 0.820039204263538, 0.8712494557492193], LAIs = [0.00041635582494404307, 4.621765226369879e-10, 0.02031408196269316, 0.30856265048346315, 1.627194911627112e-30, 0.018722595925864064, 2.2181710899307595e-6, 9.670322808607714e-27, 2.8271049915369027e-11, 6.387373693288082e-22  …  1.6008022043260537e-27, 1.826122028081477e-9, 1.3278751494267204e-27, 1.8131483283470735e-31, 0.0, 5.183331350589e-5, 5.084169352361758e-8, 1.2899289003527097e-10, 7.029969869049054e-12, 1.1758104219065995e-10], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1], relbiomass = [1.0], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [0.7513646968488413, 0.861658143916568, 0.7532037852762836, 0.8671075819287681, 0.771925910216102, 0.8625238306037861, 0.7488351818337249, 0.9189537104423531, 0.900280752838568, 0.8319173686042469  …  0.9344934456935334, 0.7097483309274122, 0.9108341473480515, 0.8510595828632856, 0.7951901240522091, 0.8267915878803629, 0.910878594245304, 0.7270992214471663, 0.8856556008788592, 0.8623097898298686], denominator = [1.2065864991731041, 2.1685410944542647, 1.2155778010446567, 2.257465131225143, 1.3153620399592623, 2.182196385872402, 1.1944348025741216, 3.7015883347332617, 3.008446298379495, 1.7848364075979126  …  4.579694401211771, 1.0335857876668209, 3.364516696442361, 2.014228278443896, 1.464773115122996, 1.7320174945821134, 3.3661946583937543, 1.0993006380959076, 2.623652774476245, 2.1788041403184506], traitmat = [-3.4423872547783274 -3.932811912283983 … -4.297181817719034 -3.966933306912527; -3.0964841199245776 -1.574615378938686 … -2.354744796469495 -1.1525380690926788; … ; 0.11875742828229252 0.5068852507250677 … 0.776905215135443 0.4684342408590871; 0.4614543412012875 0.15708634514131475 … 0.9022789144995178 0.2366745936889484], similarity_matprep = [1.36807544e-315 1.368076904e-315 … 1.413009486e-315 0.0; 1.368075955e-315 8.487983166e-314 … 1.413050276e-315 1.467e-321; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 1.47e-321 1.34304892e-315], amc_resid = [-0.3741995863709757, 0.18539031360544814, -0.38777151551197026, 0.837464078715247, -1.0490582590331197, 0.13203706285451133, -1.436928281991173, 1.9238525034769418, -0.4429929915613806, -0.4666158500988988  …  -0.9228497668780484, -1.193847284030113, -0.46587316800797623, 1.3607919420960939, -0.8680795722320949, -0.6580573828636229, 0.20904831995612963, 0.8670910004709657, 1.4609376810275962, 0.9525252698268386], rsa_above_resid = [1.0091680842547248, -0.36812442021200636, 0.9753057829269085, -0.42641945791936564, 0.6729490861629763, -0.37735887889762226, 1.057353118089447, -1.0342669806008646, -0.7986140580343261, -0.05174946250499176  …  -1.2579648154389618, 2.453087337706797, -0.928341650581933, -0.2555527901215684, 0.36468783448231773, 0.003627744301978142, -0.9289055029299094, 1.5914418137395545, -0.6295650782506734, -0.3750748520028895], nutgradient = [0.5;;], biomass_density_factor = [18.054979122069643, 12.607576276031036, 17.961865280412223, 11.46398848648274, 19.788358913960487, 12.682571703356297, 24.363182059981884, 15.788925891518554, 14.959535752803577, 14.90226898444901  …  18.46705040062511, 36.85405213216629, 15.444295093201202, 12.887157207416513, 17.674723435248037, 15.675623396556986, 13.676410679510038, 16.508586456906247, 13.265171994820236, 11.76699903078218], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[88.33877511758865 kg ha^-1, 117.91873385251404 kg ha^-1, 88.70688066707662 kg ha^-1, 127.28992137183148 kg ha^-1, 82.0602602060641 kg ha^-1, 117.3576337698174 kg ha^-1, 69.42114703568808 kg ha^-1, 98.39953433671027 kg ha^-1, 102.7636818191876 kg ha^-1, 103.0811534701449 kg ha^-1  …  86.75000728877282 kg ha^-1, 49.765818400116984 kg ha^-1, 100.16157485585697 kg ha^-1, 115.85696136230794 kg ha^-1, 89.86403844458344 kg ha^-1, 98.9711174101975 kg ha^-1, 110.44880755771923 kg ha^-1, 94.93479032536995 kg ha^-1, 113.19427567899287 kg ha^-1, 124.64709329692654 kg ha^-1], heightinfluence = [0.9003870287439137, 0.9599488897865941, 0.9334579163231979, 0.9975443804972759, 1.0592897122081333, 1.0902475287426674, 0.9618285315083775, 1.0231325721031057, 1.0102900045922827, 0.9644392022590761  …  1.3177681231976235, 0.9665655151782264, 0.9554967818463742, 0.9997716755440361, 1.0839542625161298, 0.8983371443154888, 0.9977097937371083, 0.9028898292855734, 0.91867726915417, 0.9999612339761212], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[4.750005032968974e-5 m, 4.336942535323846e-10 m, 0.006779220421761755 m, 0.2740093574639149 m, 2.470897455829133e-30 m, 0.03509194790633315 m, 2.4868307433547144e-6 m, 1.414481398786794e-26 m, 3.851295733567693e-11 m, 4.1241255670740436e-22 m  …  1.2139380405241262e-26 m, 2.587957993572236e-9 m, 1.5771790315478424e-27 m, 2.413003788747324e-31 m, 0.0 m, 8.937824935933258e-6 m, 4.667142479196255e-8 m, 3.1084602558062355e-11 m, 3.958664946440368e-12 m, 1.6553801972939068e-10 m], nutrients_splitted = [10.856873076012038, 7.581224796748424, 10.80088158725652, 6.893559228239044, 11.899194103682428, 7.626321267381081, 14.650140194827113, 9.494243291660338, 8.99551197739824, 8.961076156049717  …  11.104660987551526, 22.161186874293904, 9.287008887780988, 7.749343223582551, 10.62821660954138, 9.4261119026027, 8.2239394395841, 9.926991696596161, 7.976652185833372, 7.075766418727074], Nutred = [0.9616602436680678, 0.9262191807584623, 0.9623662653060698, 0.9061312827687997, 0.9863306910700084, 0.9299623159718727, 0.992913362177735, 0.942752857179204, 0.9651465735304086, 0.9662903471721621  …  0.9831999137921233, 0.989265586565594, 0.9662548054792539, 0.8947957595819397, 0.9816547423691394, 0.9745529235503603, 0.9370489892692712, 0.8822096484429839, 0.9192326979683622, 0.9027423566253662], amc_nut = [0.9616602436680678, 0.9262191807584623, 0.9623662653060698, 0.8837781715534192, 0.9863306910700084, 0.9299623159718727, 0.992913362177735, 0.8511271738471677, 0.9651465735304086, 0.9662903471721621  …  0.9831999137921233, 0.989265586565594, 0.9662548054792539, 0.8622764320022234, 0.9816547423691394, 0.9745529235503603, 0.9245520881344378, 0.8822096484429839, 0.8595476980468191, 0.8779248891932895], rsa_above_nut = [0.8243761585203464, 0.9022820657610846, 0.8256752008138368, 0.9061312827687997, 0.8388995959858851, 0.9028935445800623, 0.8225894325872027, 0.942752857179204, 0.9295631914133183, 0.881274633820667  …  0.9537293676175864, 0.7949803890583529, 0.9370175941506439, 0.8947957595819397, 0.8553323010407151, 0.8776540325226945, 0.9370489892692712, 0.8072362111703059, 0.9192326979683622, 0.9027423566253662], water_splitted = [14.545343840319365, 10.156839877137646, 14.47033002645432, 9.235549550623881, 15.94177885741084, 10.217257242869419, 19.62732040346526, 12.719779646864136, 12.051611344712333, 12.00547643474044  …  14.87731422880809, 29.690140129609063, 12.442140253010601, 10.3820741878895, 14.239004537755662, 12.628501571379264, 11.017907829742546, 13.299548269198755, 10.686608190523236, 9.479659085410896], Waterred = [0.9370722005382819, 0.9649866753978718, 0.9375376605364709, 0.9663658888002513, 0.9422760951383901, 0.9652057744459938, 0.9364319985573513, 0.9794877694689264, 0.9747617787646466, 0.9574594999687576  …  0.9834207642254271, 0.9265393988973297, 0.977432766693217, 0.9623042561432809, 0.9481640996347711, 0.9561622018884395, 0.9774440158818943, 0.9309307839712567, 0.9710602584336493, 0.9651516022720225], sla_water = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], rsa_above_water = [0.9370722005382819, 0.9649866753978718, 0.9375376605364709, 0.9663658888002513, 0.9422760951383901, 0.9652057744459938, 0.9364319985573513, 0.9794877694689264, 0.9747617787646466, 0.9574594999687576  …  0.9834207642254271, 0.9265393988973297, 0.977432766693217, 0.9623042561432809, 0.9481640996347711, 0.9561622018884395, 0.9774440158818943, 0.9309307839712567, 0.9710602584336493, 0.9651516022720225], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.0 m, 0.12708718745938957 m, 0.0550890889924459 m, 0.22926553306986125 m, 0.39707916508059204 m, 0.4812174065934886 m, 0.1321957437740352 m, 0.2988100192841239 m, 0.2639060380661358 m, 0.13929111646893733 m  …  1.0995808723777836 m, 0.14507008443083785 m, 0.11498709206997977 m, 0.23531895380629275 m, 0.46411334652249797 m, 0.0 m, 0.22971509898504539 m, 0.0 m, 0.014917726782927729 m, 0.23583414237334782 m], mowing_λ = [0.0, 0.6136892823671757, 0.40779821230067254, 0.7413226129472097, 0.8323129454071092, 0.8574527463686686, 0.6229896105494412, 0.7888123441106858, 0.767378320980176, 0.635188140367136  …  0.9321793003995249, 0.644555160663374, 0.5897164312225937, 0.746288641915431, 0.852971810907983, 0.0, 0.7416980952424834, 0.0, 0.15716481302848573, 0.7467024958136669], biomass_ρ = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.09547681662377061 kg ha^-1, 8.755062035989134e-7 kg ha^-1, 4.518283762004409 kg ha^-1, 119.84544463481647 kg ha^-1, 1.2128730530889362e-26 kg ha^-1, 8.19960906714491 kg ha^-1, 0.0021271710074952832 kg ha^-1, 2.003997594439821e-23 kg ha^-1, 4.902544177635857e-8 kg ha^-1, 7.344482994572734e-19 kg ha^-1  …  2.0164309837162457e-23 kg ha^-1, 2.578607575226629e-6 kg ha^-1, 3.520419462881356e-23 kg ha^-1, 1.012103726141407e-27 kg ha^-1, 0.0 kg ha^-1, 0.048712224430167074 kg ha^-1, 3.144960542304033e-5 kg ha^-1, 3.338183443967923e-7 kg ha^-1, 2.094851244214302e-8 kg ha^-1, 2.8061230894833314e-7 kg ha^-1], grazed_share = [0.0003948805359290923, 3.6209874932121567e-9, 0.01868707374744848, 0.49566622641537045, 5.016295873216966e-29, 0.0339125888078374, 8.79772134383707e-6, 8.288291043587125e-26, 2.027632823064733e-10, 3.0375891065234073e-21  …  8.339714033947564e-26, 1.0664808246264878e-8, 1.45600280084296e-25, 4.185938282477757e-30, 0.0, 0.0002014678533437151, 1.3007175441495364e-7, 1.380632193234951e-9, 8.664050722037999e-11, 1.160578482444189e-9], trampling_proportion = [0.000418552180154035, 0.001917294404521186, 0.0012507077700684539, 0.0028633016042211045, 0.0044169860286601935, 0.005195970868997376, 0.0019645914225425065, 0.0035071717340911823, 0.003184016986055964, 0.002030283165874508  …  0.010921022367613406, 0.0020837871178726584, 0.0018052669755483648, 0.0029193465476507825, 0.0050376147723647175, 0.00036697138173419564, 0.0028674638617910714, 0.00048152960875161543, 0.0008787855428596513, 0.0029241163654700605], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[3.294604012611342e-5 kg ha^-1, 4.774762548916069e-9 kg ha^-1, 0.007424698635483145 kg ha^-1, 0.6419922292336827 kg ha^-1, 3.507347267715655e-29 kg ha^-1, 0.05945261579952634 kg ha^-1, 1.545439276718211e-5 kg ha^-1, 2.861788931113001e-26 kg ha^-1, 2.0020382263114213e-10 kg ha^-1, 7.109471645699022e-22 kg ha^-1  …  1.4784328870220919e-25 kg ha^-1, 2.657417895746763e-8 kg ha^-1, 6.254260066985656e-26 kg ha^-1, 1.2484509856751068e-30 kg ha^-1, 0.0 kg ha^-1, 3.945639665686679e-5 kg ha^-1, 7.342102380418844e-8 kg ha^-1, 2.639504090422115e-10 kg ha^-1, 7.645539079498081e-11 kg ha^-1, 1.2000443158646538e-9 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1 NaN kg ha^-1 … NaN kg ha^-1 NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[3.361013423933693e-5 m^2 g^-1, 4.102342592410301e-11 m^2 g^-1, 0.0017151201002884096 m^2 g^-1, 0.02570181111975129 m^2 g^-1, 2.0377026797747043e-31 m^2 g^-1, 0.0015855593745548028 m^2 g^-1, 1.7906085043582334e-7 m^2 g^-1, 7.806324020534809e-28 m^2 g^-1, 2.5034933865905854e-12 m^2 g^-1, 5.156178307270569e-23 m^2 g^-1  …  1.7132204590813782e-28 m^2 g^-1, 1.4741286857095711e-10 m^2 g^-1, 1.1614571765665157e-28 m^2 g^-1, 1.4636557257188526e-32 m^2 g^-1, 0.0 m^2 g^-1, 4.184220612829747e-6 m^2 g^-1, 4.104172541632317e-9 m^2 g^-1, 1.3039293973892185e-11 m^2 g^-1, 5.674911141905788e-13 m^2 g^-1, 9.922507455776029e-12 m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">size(sol.o.biomass)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(5844, 1, 25)</code></pre><p>The three dimension of the array are: daily time step, patch within site, species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
total_biomass = vec(sum(species_biomass; dims=2))

lines(sol.numeric_date, ustrip.(total_biomass), color = :black, linewidth = 2;
      axis = (; ylabel = &quot;Dry biomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="b3ebe5b7.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean soil water content per site
soil_water_per_site = ustrip.(dropdims(mean(sol.o.water; dims=2); dims = 2))

lines(sol.numeric_date, soil_water_per_site, color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="6f5ea446.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We calculate the community weighted mean specific leaf area (SLA) over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
trait_vals = sol.traits[:sla]
weighted_trait = trait_vals .* relative_biomass&#39;
cwm_trait = vec(sum(weighted_trait; dims = 1))

lines(sol.numeric_date, ustrip.(cwm_trait), color = :red, linewidth = 2;
      axis = (; ylabel = &quot;Community weighted mean\nspecific leaf area [m² kg⁻¹]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="f9bcc1b6.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../../Modelling_API/main_equations/">Difference equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 14 November 2023 12:27">Tuesday 14 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
