<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li><li><a class="tocitem" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    trait_seed = 99);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (moistureconv_alpha = -0.8396916069440019, moistureconv_beta = 0.40575461296117304, α_sen = 0.004206956275356788, β_sen = 0.16718393481337973, sla_tr = 0.028051942122749175, sla_tr_exponent = 0.3856413257304432, β_pet = 1.16267383992498, biomass_dens = 1349.5087435157145, belowground_density_effect = 1.575060909640071, height_strength = 0.10138624694334897, leafnitrogen_graz_exp = 1.6803748450844105, trampling_factor = 274.5659308341029, grazing_half_factor = 118.80750087317014, mowing_mid_days = 12.494938708379609, totalN_β = 0.10891372711876313, CN_β = 0.06029036662014756, δ_wrsa = 0.8383157020917221, δ_sla = 0.7691300352241937, δ_amc = 0.9086617563796902, δ_nrsa = 0.8539014804567874, b_biomass = 1175.5314864290444, b_soilmoisture = 7.945037263262286, b_sla = 0.009931369689262101, b_lncm = 4.548582758895961, b_amc = 0.28530045557465133, b_height = 0.3200877099078715, b_rsa_above = 0.009312561114905884, RUE_max = 3//1000 kg MJ^-1, α = 0.6, α_pet = 2.0 mm d^-1, α_ll = 2.41, β_ll = 0.38, ϕ_amc = 0.35, ϕ_rsa = 0.12 m^2 g^-1, ϕ_sla = 0.025 m^2 g^-1, η_min_amc = 0.05, η_min_rsa = 0.05, η_min_sla = -0.8, η_max_amc = 0.6, η_max_rsa = 0.6, η_max_sla = 0.8, κ_min_amc = 0.7, κ_min_rsa = 0.7, β_κη_amc = 10, β_κη_rsa = 40 g m^-2, β_η_sla = 75 g m^-2, β_sla = 5, β_rsa = 7, β_amc = 7), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, ntimesteps = 5844, plotID = &quot;HEG01&quot;, npatches = 1, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = 99, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 0.2 °C, 1.1 °C, -0.7 °C, 0.1 °C, -0.7 °C, -0.5 °C, -2.1 °C, -6.2 °C, -4.2 °C  …  -5.8 °C, -1.5 °C, 6.0 °C, -4.6 °C, -7.8 °C, -1.0 °C, 4.9 °C, 6.8 °C, 11.1 °C, 11.9 °C], temperature_sum = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 3.4000000000000004 °C, 4.5 °C, 3.8000000000000003 °C, 3.9000000000000004 °C, 3.2 °C, 2.7 °C, 0.6000000000000001 °C, -5.6000000000000005 °C, -9.8 °C  …  3227.099999999999 °C, 3225.599999999999 °C, 3231.599999999999 °C, 3226.999999999999 °C, 3219.199999999999 °C, 3218.199999999999 °C, 3223.099999999999 °C, 3229.899999999999 °C, 3240.999999999999 °C, 3252.899999999999 °C], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), u = (biomass = [59.55926237816727 kg ha^-1; 59.11302155238553 kg ha^-1; … ; 0.007362823035351239 kg ha^-1; 0.007345633339657826 kg ha^-1;;;; 59.533647263479025 kg ha^-1; 59.06140506336614 kg ha^-1; … ; 13.953264648506838 kg ha^-1; 13.92624721878885 kg ha^-1;;;; 59.65114817721314 kg ha^-1; 59.29763284607088 kg ha^-1; … ; 2.1084116910913167e-17 kg ha^-1; 2.1068926594224946e-17 kg ha^-1;;;; … ;;;; 59.55272087725212 kg ha^-1; 59.10001585062961 kg ha^-1; … ; 0.06399059425980162 kg ha^-1; 0.06387626143189426 kg ha^-1;;;; 59.71938810427719 kg ha^-1; 59.43378762592987 kg ha^-1; … ; 12.276353030380575 kg ha^-1; 12.280819626753209 kg ha^-1;;;; 59.638683960094994 kg ha^-1; 59.2716323096098 kg ha^-1; … ; 1.3577899480184593e-10 kg ha^-1; 1.3603360481608316e-10 kg ha^-1], mown = [0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; … ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], grazed = [0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; … ;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;;; 0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], water = [120.05699583999998 mm; 120.05699583999998 mm; … ; 119.483387979254 mm; 118.83274111681925 mm;;;], du_biomass = [-1.7189695693413685e-5 kg ha^-1 d^-1;;; -0.027017429717987818 kg ha^-1 d^-1;;; -1.5190316688222047e-20 kg ha^-1 d^-1;;; … ;;; -0.00011433282790736135 kg ha^-1 d^-1;;; 0.004466596372633497 kg ha^-1 d^-1;;; 2.546100142372407e-13 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[-0.6506468624347519 mm d^-1;;], u_biomass = [0.007345633339657826 kg ha^-1;;; 13.92624721878885 kg ha^-1;;; 2.1068926594224946e-17 kg ha^-1;;; … ;;; 0.06387626143189426 kg ha^-1;;; 12.280819626753209 kg ha^-1;;; 1.3603360481608316e-10 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[118.83274111681925 mm;;], WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm;;], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm;;], nutrients = [0.5628965433498377;;]), traits = (amc = [0.5303613772698965, 0.35303222645399085, 0.20716146535188834, 0.4690674413755016, 0.3248927801832268, 0.3958082320121276, 0.19040949170585791, 0.34491169143484535, 0.5996678441472023, 0.2932368124730832  …  0.25776277944541226, 0.26744237001354754, 0.322455706774736, 0.4232768199288046, 0.23058316374770027, 0.21630130255465643, 0.45612447320332306, 0.3784675110793846, 0.1248091969805102, 0.2107141265093538], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.23650284874699043 m, 0.28083542716130344 m, 0.8207808852953102 m, 0.266130571301572 m, 0.7120580220674734 m, 0.5016404344997768 m, 0.2530405401821829 m, 0.3102610208743601 m, 0.3530091733610995 m, 0.09924044026822874 m  …  0.4266970211325124 m, 1.0708772129588422 m, 0.43047413448062727 m, 0.09624441377257514 m, 0.1760196591711688 m, 0.2558193471804969 m, 0.20028074204508475 m, 0.1991978555266654 m, 0.22702023911969138 m, 0.4082231825223823 m], lmpm = [0.5384654364784269, 0.5520199467281444, 0.41854498210552427, 0.5188233329840632, 0.45081751585004803, 0.6078626509926351, 0.46990524213432855, 0.43501873089414567, 0.5703450555499228, 0.47744805733826484  …  0.5033257031022862, 0.521002603885922, 0.46183242752163567, 0.4924503417195683, 0.6076158381321095, 0.5248699240044312, 0.5488744107156635, 0.5385829707597807, 0.701842751796499, 0.5954047763120285], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[27.744884801319426 mg g^-1, 26.33556550584918 mg g^-1, 27.72671140120561 mg g^-1, 26.183760071502505 mg g^-1, 25.630613650209234 mg g^-1, 29.20609984626247 mg g^-1, 22.47659892627117 mg g^-1, 31.114491904460984 mg g^-1, 24.29938043863362 mg g^-1, 21.726748843669483 mg g^-1  …  27.64004803271597 mg g^-1, 34.33072225336291 mg g^-1, 20.83752775559677 mg g^-1, 25.401021733472497 mg g^-1, 35.12458294278499 mg g^-1, 37.0357078977281 mg g^-1, 25.323832279171466 mg g^-1, 23.17563280619986 mg g^-1, 16.88999436668177 mg g^-1, 31.15111507600075 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.021143962592334028 m^2 g^-1, 0.022178249544088036 m^2 g^-1, 0.016532058307939024 m^2 g^-1, 0.025918933572675475 m^2 g^-1, 0.01870899700827985 m^2 g^-1, 0.016781089956631995 m^2 g^-1, 0.020190246869007826 m^2 g^-1, 0.033655577530762704 m^2 g^-1, 0.01461453228804259 m^2 g^-1, 0.023922286966585733 m^2 g^-1  …  0.021319290573416833 m^2 g^-1, 0.01391449506815441 m^2 g^-1, 0.033631981131705124 m^2 g^-1, 0.029166336846545588 m^2 g^-1, 0.03222882160169033 m^2 g^-1, 0.030729791183918366 m^2 g^-1, 0.017871828105638407 m^2 g^-1, 0.021408718949858546 m^2 g^-1, 0.010906245168601371 m^2 g^-1, 0.01733381902850119 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.12774498120353692 m^2 g^-1, 0.16762290500870772 m^2 g^-1, 0.10247245228739105 m^2 g^-1, 0.09514553838980025 m^2 g^-1, 0.10271215534939414 m^2 g^-1, 0.0934637893009403 m^2 g^-1, 0.19523943038709146 m^2 g^-1, 0.09734965707245172 m^2 g^-1, 0.11761231250577582 m^2 g^-1, 0.11492295667215817 m^2 g^-1  …  0.11871708923616352 m^2 g^-1, 0.11204678573464456 m^2 g^-1, 0.12332115666038562 m^2 g^-1, 0.14490411313685791 m^2 g^-1, 0.14025591660789624 m^2 g^-1, 0.10844811246368252 m^2 g^-1, 0.10820224165169821 m^2 g^-1, 0.12446845685060647 m^2 g^-1, 0.07868588650792509 m^2 g^-1, 0.1081157103639435 m^2 g^-1], ampm = [0.6272465908072172, 0.5810736281348888, 0.622789157261081, 0.6751269524052799, 0.6415569127676027, 0.6398554220975107, 0.5476386678874354, 0.617466082265553, 0.6003632163683398, 0.5947605267721366  …  0.5464992397388057, 0.6172614352781012, 0.6108689211800162, 0.5702209207913433, 0.6395956190864311, 0.6723546475008004, 0.6377056452908928, 0.614124589555011, 0.7387818439963147, 0.6917199047377253], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[50.88651521216607 d, 44.87675409313593 d, 97.23257755339125 d, 29.777636147741546 d, 70.21565702090864 d, 93.48121159188008 d, 57.45820569606534 d, 14.974906409699797 d, 134.49675856833295 d, 36.77114450725609 d  …  49.79261126799043 d, 153.04192607924082 d, 15.002570878870522 d, 21.826442695862596 d, 16.783054858227626 d, 19.024127327491414 d, 79.20521396838122 d, 49.247123771463826 d, 290.54334739472546 d, 85.83951335262849 d], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[0.007492383350021335 d^-1, 0.00793235794915902 d^-1, 0.0059263793228593355 d^-1, 0.009821368849407252 d^-1, 0.00658796276175335 d^-1, 0.005995379124894412 d^-1, 0.0071166178770038484 d^-1, 0.015371228708143985 d^-1, 0.005449989465100462 d^-1, 0.00875356305231988 d^-1  …  0.0075645615616827784 d^-1, 0.0052993623832544145 d^-1, 0.015350641991838887 d^-1, 0.011866653145936205 d^-1, 0.014168428499909548 d^-1, 0.01299495122174181 d^-1, 0.006317725585065612 d^-1, 0.0076017521945908415 d^-1, 0.0047823744919929705 d^-1, 0.006154590043113469 d^-1], TS = [1.0 0.6353891012079924 … 0.35981833725155465 0.5829219821220063; 0.6353891012079924 1.0 … 0.35787031398619107 0.5809739588566428; … ; 0.35981833725155465 0.35787031398619107 … 1.0 0.7768963551295482; 0.5829219821220063 0.5809739588566428 … 0.7768963551295482 1.0]), funresponse = (K_amc = [0.7659501028705106, 0.861634443698363, 0.9472929683363843, 0.7909546408937977, 0.8807218942720489, 0.8330172778736342, 0.9540522331555945, 0.8671676521111087, 0.7481438662546707, 0.9013783681101084  …  0.9224525919182579, 0.9169715999349358, 0.8823542845900793, 0.8158835636146208, 0.9366169561870235, 0.9432978745769071, 0.7974788280014095, 0.8444301973866344, 0.9740527067186052, 0.9457660410471085], H_amc = [0.1277764525049167, 0.32083100804893616, 0.4936572851542078, 0.17822608650881322, 0.3593422132794869, 0.2630924671192133, 0.5072949070909534, 0.33199491513773466, 0.09185024905259587, 0.4010191098480468  …  0.44353886674366233, 0.4324803125212502, 0.3626357551965356, 0.22852315763268932, 0.4721171589157307, 0.48559670759867896, 0.19138941115993902, 0.28611939174427753, 0.5476482449618144, 0.49057652746043295], K_wrsa = [0.8549287319320471, 0.781087200879799, 0.9166124103816337, 0.9320744114871741, 0.9160771182673721, 0.9353576215222983, 0.7603243026906201, 0.9276157364627371, 0.8802529920285106, 0.8869774369513836  …  0.877478389547158, 0.8940875553989258, 0.8659123735967948, 0.8163324544819994, 0.8259254377561258, 0.9027989107328971, 0.9033847374565122, 0.8630445353196433, 0.9595690448955914, 0.9035905961965162], K_nrsa = [0.8522315993057532, 0.7770172229945581, 0.9150620869331452, 0.9308115541110853, 0.9145168427874084, 0.9341558048541502, 0.7558683056379158, 0.926269984396069, 0.8780266823918588, 0.8848761466933913  …  0.87520049512065, 0.8921184548756554, 0.8634194463840472, 0.812917748482629, 0.8226890823599913, 0.9009917697830379, 0.9015884880663025, 0.8604982898979405, 0.9588173616051879, 0.9017981740860392], H_rsa = [0.2827400574815741, 0.12125418774935842, 0.41763761879657013, 0.45145185125827164, 0.41646697523866294, 0.45863198444999037, 0.07584729240927435, 0.44170106462215697, 0.3381223079404471, 0.3528281627807021  …  0.33205446118161763, 0.36837745658648735, 0.3067604549704042, 0.1983329041678551, 0.2193120364430617, 0.38742853492419604, 0.3887096938685902, 0.30048870854481247, 0.5115805447679593, 0.3891598914362435], H_sla = [-0.11488152855260558, -0.08433797237275809, -0.24583036884768117, 0.027557100096396336, -0.18530507430626897, -0.23904559765356703, -0.14274799098792246, 0.25091683175989177, -0.2967122613654648, -0.03231380009268181  …  -0.10972536102686492, -0.31464574532289474, 0.25027840081855257, 0.12398292736457506, 0.2117041955828236, 0.16929636672770187, -0.20889336267277037, -0.10709177794662739, -0.3873965984540475, -0.22385232484308915]), calc = (negbiomass = [0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; … ;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0;;;; 0; 0; … ; 0; 0], potgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.00030590508428393176 kg ha^-1 d^-1, 0.6729195277442106 kg ha^-1 d^-1, 5.361914316763371e-19 kg ha^-1 d^-1, 3.891503029723501e-7 kg ha^-1 d^-1, 1.584254520115964e-14 kg ha^-1 d^-1, 0.0006206288877839338 kg ha^-1 d^-1, 9.13236552228683 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.683188874223794 kg ha^-1 d^-1, 0.00014495686888736694 kg ha^-1 d^-1  …  0.0034626941852824726 kg ha^-1 d^-1, 1.7557933298159943e-22 kg ha^-1 d^-1, 9.137128343173224e-27 kg ha^-1 d^-1, 1.7718172346143672e-11 kg ha^-1 d^-1, 2.5720127642897975e-20 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0023395348177844967 kg ha^-1 d^-1, 0.00275004236181048 kg ha^-1 d^-1, 0.2911418648225455 kg ha^-1 d^-1, 4.637087782802324e-12 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.00014830558246424383 kg ha^-1 d^-1, 0.30502943953592043 kg ha^-1 d^-1, 3.596671068165319e-19 kg ha^-1 d^-1, 2.2648732733678374e-7 kg ha^-1 d^-1, 9.988640993793505e-15 kg ha^-1 d^-1, 0.0003871986393810424 kg ha^-1 d^-1, 4.428044834992993 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.42420345718194 kg ha^-1 d^-1, 7.419898762980657e-5 kg ha^-1 d^-1  …  0.001962730353325854 kg ha^-1 d^-1, 1.1780436431014202e-22 kg ha^-1 d^-1, 4.8935265057835e-27 kg ha^-1 d^-1, 7.548851505762796e-12 kg ha^-1 d^-1, 1.301849255363397e-20 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0012552715514747438 kg ha^-1 d^-1, 0.001344989093135496 kg ha^-1 d^-1, 0.1805969491342115 kg ha^-1 d^-1, 2.76160216265143e-12 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0001654952781576575 kg ha^-1 d^-1, 0.33204686925390825 kg ha^-1 d^-1, 3.748574235047539e-19 kg ha^-1 d^-1, 2.514913421152826e-7 kg ha^-1 d^-1, 1.0405065491113081e-14 kg ha^-1 d^-1, 0.0003059071957068929 kg ha^-1 d^-1, 4.916815874427828 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.380458027727298 kg ha^-1 d^-1, 8.660077940653037e-5 kg ha^-1 d^-1  …  0.0017484387754701887 kg ha^-1 d^-1, 1.0383496922809757e-22 kg ha^-1 d^-1, 7.229899330362847e-27 kg ha^-1 d^-1, 1.0940339838887945e-11 kg ha^-1 d^-1, 1.5599532973373122e-20 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0012593701515313806 kg ha^-1 d^-1, 0.0014593219210428574 kg ha^-1 d^-1, 0.176130352761578 kg ha^-1 d^-1, 2.5069921484141894e-12 kg ha^-1 d^-1], species_specific_red = [0.70036634157034, 0.6548368158488208, 0.9690257428258384, 0.8407773368878477, 0.9108270335909627, 0.9012728715246932, 0.7004597528612468, 0.8427155256228172, 0.7667879051639478, 0.7394582234401474  …  0.8188436093652041, 0.9692648155108742, 0.7736894637558592, 0.6154835122200543, 0.731209865432317, 0.8229679607361848, 0.7751087441834112, 0.7065352618483204, 0.8961077075372051, 0.8603402859845194], LAIs = [1.3364424635077825e-5, 0.02939860360628222, 2.342520718603594e-20, 1.7001253535768234e-8, 6.921313578828711e-16, 2.7114122723903453e-5, 0.39897607798274937, 0.0, 0.11722353544787678, 6.332896212290354e-6  …  0.00015127867384700605, 7.670734759451904e-24, 3.991841567759985e-28, 7.740740221616354e-13, 1.1236645781573468e-21, 0.0, 0.00010220992837242545, 0.00012014424007930125, 0.012719447012935129, 2.0258574761700024e-13], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1;;], relbiomass = [1.0;;], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [6.89914382810027e-310, 6.89914382810185e-310, 6.899143828105e-310, 6.8991438281066e-310, 6.89914382810976e-310, 6.89914382811134e-310, 6.89914382811924e-310, 6.8991438281224e-310, 6.899143828124e-310, 6.89914382812715e-310  …  6.8991438281382e-310, 6.8991438281398e-310, 6.8991438281414e-310, 6.89925724491943e-310, 6.8992572449815e-310, 6.89925724491943e-310, 6.8992572449878e-310, 6.89914382816826e-310, 6.89914336748564e-310, 0.0], denominator = [6.89916751865866e-310, 6.89916751564526e-310, 6.89916749073486e-310, 6.89916748530883e-310, 6.89925014424314e-310, 6.89916747948123e-310, 6.89916747760615e-310, 6.8991674712252e-310, 6.8991674626751e-310, 6.89918393923475e-310  …  6.89925014424314e-310, 6.89925014424314e-310, 6.89925014424314e-310, 6.89924762506724e-310, 6.89925014424314e-310, 6.89914382817774e-310, 6.89925014424314e-310, 6.89925014424314e-310, 6.89925014508977e-310, 0.0], traitmat = [-3.856400870867581 -3.8086432206392216 … -4.518419702573105 -4.055095828586328; -1.4417950256808751 -1.2699864496842714 … -1.482716106357589 -0.8959412381504506; … ; 0.5204226504297005 0.3271822943801811 … 1.0396467680769246 0.8081723418178165; 0.15416636471420084 1.1985995327965824 … 1.2077809040677203 0.38635435093006665], similarity_matprep = [2.0e-323 4.9e-322 … 1.18721461e-315 0.0; 1.0995944e-315 8.4e-323 … 1.20585389e-315 1.13806998e-315; … ; 1.949235902832307e233 2.0e-323 … 0.0 1.69759663277e-313; 5.386692122902658e228 NaN … 0.0 3.16e-322], amc_resid = [1.5229388508291588, 0.09359947658537272, -1.0821734938192344, 1.0288867698648432, -0.1332149999920049, 0.4383901031450742, -1.2172006758611948, 0.02814492278310479, 2.0815749326107587, -0.3883739564845643  …  -0.6743079494934937, -0.5962868240218121, -0.15285872447075527, 0.6597972101183847, -0.8933858321473459, -1.0085029826371394, 0.9245615986058627, 0.29861739745680077, -1.7459636219505195, -1.0535377142401423], rsa_above_resid = [0.4850233722318578, 1.9297179788030974, -0.43054802004903614, -0.6959869391456405, -0.42186407445180885, -0.7569132263353215, 2.930207509334158, -0.6161362832131321, 0.11793776643784315, 0.020507973278086643  …  0.15796153978307328, -0.0836897442686846, 0.3247573691888546, 1.1066631917627532, 0.9382686562678197, -0.21406222531286603, -0.22296961572071278, 0.36632167943299243, -1.2922860447851836, -0.2261044651007771], nutgradient = [0.0;;], biomass_density_factor = [11.753696479298911, 9.249402566602026, 9.534091109420213, 11.06482521757523, 9.290513458896875, 9.683048408579724, 9.99516489582795, 9.394406460927069, 13.48855511659852, 9.034749277685892  …  9.041919660631258, 9.157480458591841, 8.956708919569788, 9.718695767582274, 9.266355200427487, 9.35264277494518, 10.359770020088568, 8.892584099236158, 12.338323617893984, 9.372751184261], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[282.30991025814996 kg ha^-1, 328.69561592366705 kg ha^-1, 322.4297552649934 kg ha^-1, 293.3454748933115 kg ha^-1, 327.77141769104446 kg ha^-1, 319.2717420904884 kg ha^-1, 312.9053383009009 kg ha^-1, 325.4653555925012 kg ha^-1, 258.68132581727923 kg ha^-1, 333.6324718993462 kg ha^-1  …  333.46446947222313 kg ha^-1, 330.78658496798266 kg ha^-1, 335.4751655922271 kg ha^-1, 318.5277408025049 kg ha^-1, 328.31369809150897 kg ha^-1, 326.38732908706135 kg ha^-1, 305.86789443784244 kg ha^-1, 337.00904421798367 kg ha^-1, 273.74200536455083 kg ha^-1, 325.9425782338247 kg ha^-1], heightinfluence = [0.96125302730075, 0.9729947908860714, 1.1160027580547633, 0.9691001168734845, 1.0872068205748822, 1.0314763926190862, 0.9656331393994484, 0.9807883453576264, 0.9921104637220864, 0.9248982108845435  …  1.0116271559288212, 1.1822423511038826, 1.0126275482713114, 0.9241046943315797, 0.9452336722736536, 0.9663691239956637, 0.9516593734085428, 0.9513725640700427, 0.9587414982086436, 1.0067342430139365], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[3.295328258668085e-6 m, 0.007415589284218227 m, 3.2749192307422185e-20 m, 4.2987528067180755e-9 m, 7.094238015263309e-16 m, 1.6145900281559238e-5 m, 0.11028008522485439 m, 0.0 m, 0.05640404160107606 m, 6.193302714410905e-7 m  …  6.221326125811885e-5 m, 1.3235988661938262e-23 m, 1.2789379008444902e-28 m, 5.597251030719964e-14 m, 1.2224969336609642e-22 m, 0.0 m, 2.5184220823967224e-5 m, 2.4122301757168197e-5 m, 0.005274142863951019 m, 1.0489340832380448e-13 m], relative_lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[0.0003486350975711602 mg g^-1, 0.6937665673945663 mg g^-1, 4.589113374164424e-18 mg g^-1, 5.942764031530321e-7 mg g^-1, 7.211351482005199e-14 mg g^-1, 0.00034700319054882625 mg g^-1, 17.71038667480724 mg g^-1, 0.0 mg g^-1, 2.0292633825693693 mg g^-1, 0.00041380854935106154 mg g^-1  …  0.002383884999701211 mg g^-1, 5.974293063998236e-22 mg g^-1, 4.804644862222704e-25 mg g^-1, 1.1982333368204057e-10 mg g^-1, 1.5079869181901487e-19 mg g^-1, 7.932232530422629e-31 mg g^-1, 0.0032689003472365424 mg g^-1, 0.004510748033868073 mg g^-1, 0.8472591551650716 mg g^-1, 1.2108779591861148e-11 mg g^-1], ρ = [1.3857312393461698, 1.2695062836627369, 1.3842063383409369, 1.2572337929270263, 1.2129249105837006, 1.5105518523546906, 0.9727580041773063, 1.6800712895359313, 1.108945090302377, 0.9188466958038954  …  1.3769439072623169, 1.9820458874814344, 0.8565381014003665, 1.1947232522481421, 2.059666298855643, 2.2514453206660843, 1.18862885256478, 1.0241309419244298, 0.6018225560135606, 1.6833955952918074], nutrients_splitted = [6.616115119780515, 5.2064567327913975, 5.366706929475058, 6.228351867743213, 5.229597911958196, 5.450554478278674, 5.626243770073194, 5.28807892367923, 7.592661049917074, 5.085629138441832  …  5.089665322216273, 5.154714095935034, 5.041700490616494, 5.47062025344076, 5.215999311772426, 5.264570289202476, 5.831478734207134, 5.005604850907764, 6.945199715244188, 5.275889243298615], Nutred = [0.8522315993057531, 0.861634443698362, 0.9472929683363829, 0.9308115541110852, 0.9145168427874066, 0.9341558048541496, 0.9540522331555943, 0.9262699843960677, 0.8780266823918587, 0.9013783681101037  …  0.9224525919182517, 0.9169715999349323, 0.8823542845900744, 0.8158835636146208, 0.9366169561870202, 0.9432978745769045, 0.9015884880663027, 0.860498289897937, 0.9740527067186051, 0.945766041047106], amc_nut = [0.7659501028705107, 0.861634443698362, 0.9472929683363829, 0.7909546408937977, 0.8807218942720477, 0.8330172778736341, 0.9540522331555943, 0.867167652111108, 0.7481438662546707, 0.9013783681101037  …  0.9224525919182517, 0.9169715999349323, 0.8823542845900744, 0.8158835636146208, 0.9366169561870202, 0.9432978745769045, 0.7974788280014093, 0.844430197386631, 0.9740527067186051, 0.945766041047106], rsa_above_nut = [0.8522315993057531, 0.7770172229945578, 0.9150620869331446, 0.9308115541110852, 0.9145168427874066, 0.9341558048541496, 0.7558683056379157, 0.9262699843960677, 0.8780266823918587, 0.8848761466933883  …  0.8752004951206477, 0.8921184548756533, 0.8634194463840444, 0.812917748482629, 0.8226890823599907, 0.9009917697830367, 0.9015884880663027, 0.860498289897937, 0.9588173616051879, 0.9017981740860381], Wp = [11.718754139812043, 9.221905194596365, 9.505747392289962, 11.03193081028844, 9.26289386910571, 9.654261859143444, 9.965450461255612, 9.366478009617008, 13.448455249046075, 9.007890044337843  …  9.015039110588877, 9.130256360063175, 8.930081690909947, 9.689803242794131, 9.238807430260927, 9.32483848209849, 10.328971657914986, 8.866147506028371, 12.301643251567134, 9.344887111508807], Waterred = [0.8549287319320472, 0.781087200879799, 0.9166124103816337, 0.9320744114871741, 0.916077118267372, 0.9353576215222984, 0.76032430269062, 0.927615736462737, 0.8802529920285106, 0.8869774369513835  …  0.877478389547158, 0.8940875553989259, 0.8659123735967947, 0.8163324544819993, 0.8259254377561259, 0.902798910732897, 0.9033847374565122, 0.8630445353196433, 0.9595690448955915, 0.9035905961965162], W_sla = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], W_rsa = [0.8549287319320472, 0.781087200879799, 0.9166124103816337, 0.9320744114871741, 0.916077118267372, 0.9353576215222984, 0.76032430269062, 0.927615736462737, 0.8802529920285106, 0.8869774369513835  …  0.877478389547158, 0.8940875553989259, 0.8659123735967947, 0.8163324544819993, 0.8259254377561259, 0.902798910732897, 0.9033847374565122, 0.8630445353196433, 0.9595690448955915, 0.9035905961965162], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.15650284874699044 m, 0.20083542716130343 m, 0.7407808852953103 m, 0.186130571301572 m, 0.6320580220674734 m, 0.4216404344997768 m, 0.1730405401821829 m, 0.23026102087436007 m, 0.2730091733610995 m, 0.019240440268228742 m  …  0.3466970211325124 m, 0.9908772129588422 m, 0.35047413448062725 m, 0.016244413772575142 m, 0.0960196591711688 m, 0.1758193471804969 m, 0.12028074204508475 m, 0.11919785552666541 m, 0.14702023911969136 m, 0.3282231825223823 m], mowing_λ = [0.6617376897409655, 0.7151356550395246, 0.902531843232172, 0.6993956778105506, 0.8876496050592639, 0.840523222415725, 0.6838451263880404, 0.7421525921156691, 0.7733769940358842, 0.19387701441292837  …  0.8125133384159349, 0.925294889991207, 0.8141584044381178, 0.16878292605075837, 0.5455053124366939, 0.6872793208108889, 0.6005606970340095, 0.5983892507854288, 0.6476085114251783, 0.8040287680241831], biomass_ρ = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0017331370116860944 kg ha^-1, 3.328674146733343 kg ha^-1, 2.2803261509758837e-17 kg ha^-1, 2.8401300593557585e-6 kg ha^-1, 3.3967007262881655e-13 kg ha^-1, 0.0017863281795450132 kg ha^-1, 76.29006228139852 kg ha^-1, 0.0 kg ha^-1, 9.217623600641346 kg ha^-1, 0.0017418609462302285 kg ha^-1  …  0.011820299081389169 kg ha^-1, 3.433072670135317e-21 kg ha^-1, 1.9657464335617387e-24 kg ha^-1, 5.609488183466255e-10 kg ha^-1, 8.801343476450076e-19 kg ha^-1, 4.799565246242751e-30 kg ha^-1, 0.015271589086771504 kg ha^-1, 0.01983983993337215 kg ha^-1, 3.004837120114789 kg ha^-1, 6.512963924189754e-11 kg ha^-1], grazed_share = [1.741274290004916e-5, 0.03344302656067573, 2.2910325454634873e-19, 2.8534647978090938e-8, 3.4126486282654367e-15, 1.7947151965365726e-5, 0.7664825292966125, 0.0, 0.09260901407399155, 1.750039184428703e-5  …  0.00011875796749945333, 3.449191342587216e-23, 1.974975839965426e-26, 5.635825377968033e-12, 8.842666799975285e-21, 4.8220997590681543e-32, 0.00015343290960271303, 0.00019932990271891352, 0.03018945177229854, 6.543543041578757e-13], trampling_proportion = [0.009229928420285865, 0.010960083163109133, 0.03203237872250357, 0.01038620099748186, 0.027789282918126993, 0.019577376457343663, 0.009875340130936744, 0.012108467316343914, 0.013776787125777464, 0.00387302802028114  …  0.016652581493492104, 0.04179281592121251, 0.016799989806005503, 0.003756102958927035, 0.006869468436936434, 0.009983787829660517, 0.007816298716196303, 0.007774037216576924, 0.008859853351164324, 0.015931608325841902], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[1.1543891128526872e-5 kg ha^-1, 0.0287375855799867 kg ha^-1, 5.276978500650183e-19 kg ha^-1, 2.346274958675976e-8 kg ha^-1, 7.782169914014273e-15 kg ha^-1, 2.315155166159928e-5 kg ha^-1, 0.7744889380543577 kg ha^-1, 0.0 kg ha^-1, 0.11451354919381261 kg ha^-1, 7.342112980316922e-6 kg ha^-1  …  0.00014295316802094248 kg ha^-1, 7.23887247279762e-23 kg ha^-1, 3.855580970774869e-26 kg ha^-1, 1.7635728713186268e-12 kg ha^-1, 2.935453730912734e-21 kg ha^-1, 2.1283146720580179e-32 kg ha^-1, 0.0001004243687301071 kg ha^-1, 0.00015060149801073496 kg ha^-1, 0.04423632175686033 kg ha^-1, 6.16385064632077e-13 kg ha^-1], clonalgrowth = [NaN kg ha^-1;;; NaN kg ha^-1;;; NaN kg ha^-1;;; … ;;; NaN kg ha^-1;;; NaN kg ha^-1;;; NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[2.946108167402185e-7 m^2 g^-1, 0.0005856269322010907 m^2 g^-1, 6.596298311326004e-22 m^2 g^-1, 4.1866324450346944e-10 m^2 g^-1, 1.863978407520975e-17 m^2 g^-1, 5.401195486281639e-7 m^2 g^-1, 0.008799309959668709 m^2 g^-1, 0.0 m^2 g^-1, 0.0023351197344433114 m^2 g^-1, 1.4929192615896117e-7 m^2 g^-1  …  3.1083943139828744e-6 m^2 g^-1, 1.719824614157385e-25 m^2 g^-1, 9.992055713572772e-30 m^2 g^-1, 1.696215942074463e-14 m^2 g^-1, 2.2383656330829973e-23 m^2 g^-1, 0.0 m^2 g^-1, 2.2472857896595122e-6 m^2 g^-1, 2.592535835175002e-6 m^2 g^-1, 0.00025337430420973374 m^2 g^-1, 4.4539443985835316e-15 m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">sol.u.biomass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5844×1×1×25 DimArray{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}},4}<span class="sgr33"> biomass</span><span class="sgr90"> with dimensions: </span>
  <span class="sgr31">Dim{</span><span class="sgr33">:time</span><span class="sgr31">}</span> Sampled{Dates.Date} <span class="sgr36">Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;)</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:x</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:y</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:species</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:25</span> ForwardOrdered Regular Points
[:, :, 1, 1]
                                        <span class="sgr90">1</span>
  <span class="sgr90">2006-01-01</span>     59.5593 kg ha^-1
  <span class="sgr90">2006-01-02</span>      59.113 kg ha^-1
  <span class="sgr90">2006-01-03</span>     58.6701 kg ha^-1
 ⋮                    
  <span class="sgr90">2021-12-28</span>  0.00761167 kg ha^-1
  <span class="sgr90">2021-12-29</span>  0.00745552 kg ha^-1
  <span class="sgr90">2021-12-30</span>  0.00736282 kg ha^-1
  <span class="sgr90">2021-12-31</span>  0.00734563 kg ha^-1
<span class="sgr90">[and 24 more slices...]</span></code></pre><p>The four dimension of the array are: daily time step, patch x dim, patch y dim, and species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.u.biomass; dims = (:x, :y)); dims = (:x, :y))
total_biomass = vec(sum(species_biomass; dims = :species))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg ha⁻¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="79fad23c.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color))
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.u.biomass; dims=(:x, :y)); dims = (:x, :y))
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = :species)
biomass_cumfraction = cumsum(biomass_fraction; dims = 2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, vec(ylower), vec(yupper);
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap,
             label = &quot;Specific leaf area [m² g⁻¹]&quot;)

    fig
end</code></pre><img src="481bf70f.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.u.water; dims = (:x, :y)); dims = (:x, :y))

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="4f96daa4.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We can calculate for all traits the community weighted mean over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
traits = [:height, :sla, :lncm, :rsa_above, :amc, :ampm, :lmpm]

begin
    fig = Figure(; size = (500, 1000))

    for i in eachindex(traits)
        trait_vals = sol.traits[traits[i]]
        weighted_trait = trait_vals .* relative_biomass&#39;
        cwm_trait = vec(sum(weighted_trait; dims = 1))

        Axis(fig[i, 1];
                xlabel = i == length(traits) ? &quot;Date [year]&quot; : &quot;&quot;,
                xticklabelsvisible = i == length(traits) ? true : false,
                ylabel = string(traits[i]))
        lines!(sol.numeric_date, ustrip.(cwm_trait);
                color = :black, linewidth = 2)

    end

    [rowgap!(fig.layout, i, 5) for i in 1:length(traits)-1]

    fig
end</code></pre><img src="0c1edfd5.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.u.mown)
sum(sol.u.grazed)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.u.grazed; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.u.mown; dims=(:x, :y, :species)); dims=(:x, :y, :species))
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg ha⁻¹]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_grazed)), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_mown)), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="4cb18f9a.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.u.biomass; dims = (:x, :y)); dims = (:x, :y))
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="bd45ff37.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../how_to_heterogeneous_site_management/">Heterogenous site or management conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 19 December 2023 13:41">Tuesday 19 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
