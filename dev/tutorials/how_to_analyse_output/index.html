<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output Â· GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output Â· GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    npatches = 1, nutheterog = 0.0);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (moistureconv_alpha = 0.02037577320704022, moistureconv_beta = 1.3344031835366224, sen_Î± = 9.594548519615396, sen_leaflifespan = 11.793866321332152, sla_tr = 0.009908918158486471, sla_tr_exponent = 2.4959875375040887, Î²â‚šâ‚‘â‚œ = 1.0, biomass_dens = 905.1894196309725, belowground_density_effect = 1.243431419474298, height_strength = 0.11624675015957471, leafnitrogen_graz_exp = 2.9221819460701206, trampling_factor = 65.13587711112287, grazing_half_factor = 157.3045262441305, mowing_mid_days = 6.106174292354222, totalN_Î² = 0.1, CN_Î² = 0.1, max_rsa_above_water_reduction = 0.2530927775106053, max_SLA_water_reduction = 0.8961798337437242, max_AMC_nut_reduction = 0.5200095484139818, max_rsa_above_nut_reduction = 0.7063511868742249, b_biomass = 1295.2142567548983, b_soilmoisture = 19.01215359412841, b_sla = 0.003958791090577544, b_lncm = 3.626705514150837, b_amc = 0.16342654224714848, b_height = 0.06186955140054361, b_rsa_above = 0.014533309346240423, b_var_sla = 6.613912654470809e-5, b_var_lncm = 20.544957165043726, b_var_amc = 0.007630530303688995, b_var_height = 0.0406815972546423, b_var_rsa_above = 0.0011803171892367265, amc_nut_lower = 0.47999045158601816, rsa_above_water_lower = 0.7469072224893947, rsa_above_nut_lower = 0.29364881312577507, sla_water_lower = 0.10382016625627577), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  â€¦  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  â€¦  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, npatches = 1, ntimesteps = 5844, plotID = &quot;HEG01&quot;, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = missing, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, ğš¯, Unitful.FreeUnits{(K,), ğš¯, Unitful.Affine{-5463//20}}}[3.2 Â°C, 0.2 Â°C, 1.1 Â°C, -0.7 Â°C, 0.1 Â°C, -0.7 Â°C, -0.5 Â°C, -2.1 Â°C, -6.2 Â°C, -4.2 Â°C  â€¦  -5.8 Â°C, -1.5 Â°C, 6.0 Â°C, -4.6 Â°C, -7.8 Â°C, -1.0 Â°C, 4.9 Â°C, 6.8 Â°C, 11.1 Â°C, 11.9 Â°C], temperature_sum = Unitful.Quantity{Float64, ğš¯, Unitful.FreeUnits{(K,), ğš¯, Unitful.Affine{-5463//20}}}[3.2 Â°C, 3.4000000000000004 Â°C, 4.5 Â°C, 3.8000000000000003 Â°C, 3.9000000000000004 Â°C, 3.2 Â°C, 2.7 Â°C, 0.6000000000000001 Â°C, -5.6000000000000005 Â°C, -9.8 Â°C  â€¦  3227.099999999999 Â°C, 3225.599999999999 Â°C, 3231.599999999999 Â°C, 3226.999999999999 Â°C, 3219.199999999999 Â°C, 3218.199999999999 Â°C, 3223.099999999999 Â°C, 3229.899999999999 Â°C, 3240.999999999999 Â°C, 3252.899999999999 Â°C], precipitation = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  â€¦  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  â€¦  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, ğŒ ğ“^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), ğŒ ğ“^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  â€¦  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  â€¦  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, ğ‹^-2, Unitful.FreeUnits{(ha^-1,), ğ‹^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  â€¦  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), patch = (xs = [1], ys = [1], WHC = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[120.05699583999998 mm], PWP = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[59.33808384000001 mm], nutrients = [0.6013229371581524], nneighbours = [0], neighbours = Union{Missing, Int64}[missing missing missing missing], surroundings = Union{Missing, Int64}[1 missing â€¦ missing missing]), traits = (TS = [1.0 0.5298990532723915 â€¦ 0.5694008576485657 0.45948373984099455; 0.5298990532723915 1.0 â€¦ 0.9604981956238259 0.929584686568603; â€¦ ; 0.5694008576485657 0.9604981956238259 â€¦ 1.0 0.8900828821924289; 0.45948373984099455 0.929584686568603 â€¦ 0.8900828821924289 1.0], amc = [0.47192826406258787, 0.24106318109348424, 0.45426072800733014, 0.2546660187605324, 0.19848290228683962, 0.5389160179775039, 0.20435822396563988, 0.2613022624347637, 0.29333527177935104, 0.15457041073083796  â€¦  0.17198760697909354, 0.14757740622074506, 0.23594035855169618, 0.15369055783625493, 0.21437164483674043, 0.18461119586675426, 0.037584780922784194, 0.13819130150447842, 0.2635607763336029, 0.22149824536519247], height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.11578888905254678 m, 1.4623622527537647 m, 0.2573236378274648 m, 0.5207870228267193 m, 0.1580568142929124 m, 0.4318635842573459 m, 0.3399782685915875 m, 0.8094475349997624 m, 0.9884213320672348 m, 0.17038603393630133 m  â€¦  0.6569048121152159 m, 0.2486291015421304 m, 0.9311412873506184 m, 0.18231492118961865 m, 0.31662038776454293 m, 0.3255661374006869 m, 1.3477740638779399 m, 0.24897656536364768 m, 0.3836381925271947 m, 0.2756131080115155 m], lmpm = [0.547397142712661, 0.3315336738085912, 0.6147631852079365, 0.38731253463346316, 0.5738792607626887, 0.2601128385109734, 0.541308010181049, 0.2768807212003544, 0.56434583309886, 0.587960401165501  â€¦  0.5230982360038958, 0.5346003433508868, 0.6008230574042196, 0.5875300580332358, 0.5924985811132533, 0.44375643632650796, 0.3980329966219766, 0.5824492992909588, 0.6204851609767612, 0.6069225833101284], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[23.90459041421017 mg g^-1, 29.305887514372422 mg g^-1, 28.480710964927145 mg g^-1, 23.285117063932965 mg g^-1, 20.774221381451643 mg g^-1, 26.08857285421886 mg g^-1, 26.272563160955162 mg g^-1, 22.480271476640937 mg g^-1, 19.071703894583024 mg g^-1, 18.33286174199817 mg g^-1  â€¦  20.174094833790505 mg g^-1, 33.648939365121066 mg g^-1, 27.764066171216914 mg g^-1, 16.005170654648836 mg g^-1, 23.582728869105807 mg g^-1, 24.700199446056416 mg g^-1, 18.214930246602936 mg g^-1, 25.32302920246687 mg g^-1, 19.20713912791287 mg g^-1, 20.745603535494517 mg g^-1], sla = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[0.019236889597681647 m^2 g^-1, 0.018290926824181836 m^2 g^-1, 0.030246747309035163 m^2 g^-1, 0.01010609798634742 m^2 g^-1, 0.03135168135128541 m^2 g^-1, 0.018422967196996768 m^2 g^-1, 0.024201783080570204 m^2 g^-1, 0.023139863853484217 m^2 g^-1, 0.015985716395726598 m^2 g^-1, 0.018172001647578564 m^2 g^-1  â€¦  0.021865359802344445 m^2 g^-1, 0.022613403338756333 m^2 g^-1, 0.024776361897395256 m^2 g^-1, 0.022605761664574828 m^2 g^-1, 0.02026171219893396 m^2 g^-1, 0.025264367683566144 m^2 g^-1, 0.01601524741166022 m^2 g^-1, 0.019547808695164107 m^2 g^-1, 0.019096008110081702 m^2 g^-1, 0.013626850247308517 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[0.12200990871919296 m^2 g^-1, 0.09633449386820424 m^2 g^-1, 0.11468388348316677 m^2 g^-1, 0.131103044565871 m^2 g^-1, 0.12851104475054748 m^2 g^-1, 0.13888755774228584 m^2 g^-1, 0.1057453383196998 m^2 g^-1, 0.14213773053880924 m^2 g^-1, 0.11002401455149873 m^2 g^-1, 0.0952751861852504 m^2 g^-1  â€¦  0.09376004482856526 m^2 g^-1, 0.09936404506505604 m^2 g^-1, 0.09096595923144855 m^2 g^-1, 0.1336004713664323 m^2 g^-1, 0.1281853421783939 m^2 g^-1, 0.11708580481720991 m^2 g^-1, 0.08623108091677607 m^2 g^-1, 0.1412746267883561 m^2 g^-1, 0.0978984810883263 m^2 g^-1, 0.08961245493110327 m^2 g^-1], ampm = [0.6920555550277577, 0.6268522139529471, 0.6471191423241437, 0.6172091852395796, 0.6040834323817776, 0.5682340157598611, 0.5697979054537359, 0.5803620273899849, 0.5940482453672211, 0.6713205256417922  â€¦  0.550629722109364, 0.672975071398049, 0.6508707450704591, 0.618452692666564, 0.6236827169613193, 0.6205495704974058, 0.6561808422115131, 0.6131045255694303, 0.6628773671309408, 0.6388658771685563], leaflifespan = Unitful.Quantity{Float64, ğ“, Unitful.FreeUnits{(d,), ğ“, nothing}}[65.2578935017574 d, 74.51820195675673 d, 19.83409811331025 d, 355.0540675899402 d, 18.047073095676385 d, 73.12092317639902 d, 35.664135791286824 d, 40.13397151075451 d, 106.22316358280045 d, 75.8084269693972 d  â€¦  46.586486421082306 d, 42.63972828605659 d, 33.52860333900949 d, 42.6776702635174 d, 56.926419300478564 d, 31.851040775393326 d, 105.70849596823514 d, 62.56173259463424 d, 66.53248436034924 d, 161.6903207758415 d], Î¼ = Unitful.Quantity{Float64, ğ“^-1, Unitful.FreeUnits{(d^-1,), ğ“^-1, nothing}}[0.009775275565624237 d^-1, 0.00975281678175323 d^-1, 0.010189174312729605 d^-1, 0.009627765619200784 d^-1, 0.010248054285276514 d^-1, 0.009755841153912152 d^-1, 0.00992524113446949 d^-1, 0.009888410947812211 d^-1, 0.009705577657927011 d^-1, 0.00975012312777991 d^-1  â€¦  0.009847709194037817 d^-1, 0.009871141893808843 d^-1, 0.009946303891054036 d^-1, 0.009870895992392372 d^-1, 0.009801725898172789 d^-1, 0.00996483049578377 d^-1, 0.00970611823038752 d^-1, 0.009783064179783408 d^-1, 0.009771813301394096 d^-1, 0.009667489597750076 d^-1], Ï = [1.0626629989241765, 1.927220614296313, 1.772901207735325, 0.9841793888654444, 0.7051303778396322, 1.371980472995719, 1.4004473555909527, 0.8880398605267968, 0.5492289720717882, 0.4893403633962494  â€¦  0.6472439668930556, 2.886094643550096, 1.6456691969828625, 0.32907137440070144, 1.0213908116965256, 1.1693553634707128, 0.480198603318491, 1.257623030122402, 0.5607042523069145, 0.702295634546716]), funresponse = (amc_nut_upper = [0.8795755726401704, 0.9607282645882252, 0.8846588501181886, 0.9565978728710619, 0.9718923837882458, 0.8644865914613, 0.9705129889288527, 0.9544886627221099, 0.9435252772218974, 0.9806422769390186  â€¦  0.9774906849083724, 0.9817971604358781, 0.9622144096173216, 0.9807909694560086, 0.9680435953261095, 0.9749484107589124, 0.9934288595457303, 0.9832528972944158, 0.9537572410265982, 0.9661945947422149], amc_nut_midpoint = [0.17543449442472187, 0.46154450085032744, 0.19335597696568135, 0.4469824897528484, 0.5009044547764232, 0.12223714017298887, 0.49604129296859323, 0.4395463084656537, 0.4008940565117689, 0.531752870589831  â€¦  0.520641692457672, 0.5358245004615644, 0.46678401852518564, 0.5322770974019086, 0.4873352574374433, 0.5116787109991735, 0.5768329430304286, 0.5409568118113446, 0.43696762547955337, 0.48081646482268153], rsa_above_water_upper = [0.9605108246957907, 0.978773233350259, 0.9660573541298985, 0.9537416714721932, 0.9556355314123659, 0.9483404910353447, 0.9725753374097234, 0.9462459364205819, 0.9695116985176464, 0.9794151205965119  â€¦  0.9803117409677051, 0.976871584563333, 0.9818972891998492, 0.9519569057554014, 0.9558760617286151, 0.9642462665251152, 0.9843781005558642, 0.9467917681028861, 0.9778034851858322, 0.9826331012353937], rsa_above_nut_upper = [0.889790510344991, 0.9407586737005228, 0.9052701999961533, 0.870898626267338, 0.876184159223562, 0.8558245880051044, 0.9234610992822371, 0.8499789405999801, 0.9149108554196601, 0.9425501030043922  â€¦  0.9450524615054812, 0.9354514030194904, 0.9494775339498118, 0.8659175620317315, 0.876855450107612, 0.9002156745697283, 0.9564011769828844, 0.8515022904972842, 0.9380522244148125, 0.9515310959271046], rsa_above_midpoint = [0.3139514524944645, 0.4462392359014363, 0.35412896129531585, 0.2649175987222364, 0.27863619073870705, 0.22579295742816613, 0.40134341020431885, 0.21062058928909183, 0.37915126644823804, 0.45088888768672986  â€¦  0.4573837550236107, 0.43246422365629916, 0.46886902320940727, 0.25198925476485873, 0.2803785251142432, 0.3410099489390784, 0.48683932721187395, 0.2145744414195262, 0.4392146512717619, 0.4741990399135584], sla_water_midpoint = [-0.17025092612945325, -0.19713034577282418, 0.15540227733931455, -0.4055035946092865, 0.18702684721450158, -0.19340514194937475, -0.023939358181158332, -0.05571375017499414, -0.26057805175379056, -0.20047776858522293  â€¦  -0.09360844926556955, -0.07140734917725433, -0.006708985792994615, -0.07163476709655736, -0.14067130463309485, 0.007930770688192257, -0.2597858287989768, -0.16132405005641637, -0.1742813875760325, -0.3219091155783039]), u = (u_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[1.5594516561198615e-14 kg ha^-1 0.0 kg ha^-1 â€¦ 0.002499097489246487 kg ha^-1 3.88500394235771e-18 kg ha^-1], u_water = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[86.74450717002047 mm]), du = (du_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[-1.0940667494938717e-16 kg ha^-1 d^-1 0.0 kg ha^-1 d^-1 â€¦ 5.489876163710324e-6 kg ha^-1 d^-1 -2.586691247308775e-20 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(d^-1, mm), ğ‹ ğ“^-1, nothing}}[-0.7197222033693109 mm d^-1]), o = (biomass = [59.42181768360851 kg ha^-1; 58.840953041140956 kg ha^-1; â€¦ ; 1.5703923236148e-14 kg ha^-1; 1.5594516561198615e-14 kg ha^-1;;; 59.420697014001874 kg ha^-1; 58.841177842980244 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 59.404887748920416 kg ha^-1; 58.79960099261853 kg ha^-1; â€¦ ; 3.1283718821064246e-10 kg ha^-1; 3.1750276976792437e-10 kg ha^-1;;; â€¦ ;;; 59.422471399628805 kg ha^-1; 58.84113754820489 kg ha^-1; â€¦ ; 2.211583093566939e-12 kg ha^-1; 2.2156688789321034e-12 kg ha^-1;;; 59.422553886666314 kg ha^-1; 58.84188778419378 kg ha^-1; â€¦ ; 0.002493607613082777 kg ha^-1; 0.002499097489246487 kg ha^-1;;; 59.42613490543456 kg ha^-1; 58.85163336440178 kg ha^-1; â€¦ ; 3.910870854830798e-18 kg ha^-1; 3.88500394235771e-18 kg ha^-1], mown_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], grazed_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; â€¦ ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], water = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(mm,), ğ‹, nothing}}[120.05699583999998 mm; 119.16421115866667 mm; â€¦ ; 87.46422937338978 mm; 86.74450717002047 mm;;]), calc = (negbiomass = [0; 0; â€¦ ; 0; 0;;; 0; 0; â€¦ ; 0; 0;;; 0; 0; â€¦ ; 0; 0;;; â€¦ ;;; 0; 0; â€¦ ; 0; 0;;; 0; 0; â€¦ ; 0; 0;;; 0; 0; â€¦ ; 0; 0], potgrowth = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[6.426477504058381e-16 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.4176257097684245e-11 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.00023077118134038545 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.7300752613956095e-13 kg ha^-1 d^-1, 6.25990904220255e-31 kg ha^-1 d^-1, 0.15405199846554765 kg ha^-1 d^-1, 9.559540290199807e-13 kg ha^-1 d^-1  â€¦  2.4043827554194483 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.9149211138893495e-6 kg ha^-1 d^-1, 5.980871844011469 kg ha^-1 d^-1, 2.7245042377184766e-11 kg ha^-1 d^-1, 4.931364402086895e-25 kg ha^-1 d^-1, 9.270475882883754e-19 kg ha^-1 d^-1, 1.1045702832308204e-13 kg ha^-1 d^-1, 0.00011987740209387194 kg ha^-1 d^-1, 1.3616358324691086e-19 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[3.5112385633488155e-16 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.4228239483829206e-11 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.00013917611264493212 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.1310296985420109e-13 kg ha^-1 d^-1, 4.547073441891718e-31 kg ha^-1 d^-1, 0.11933250662274641 kg ha^-1 d^-1, 5.988852974079393e-13 kg ha^-1 d^-1  â€¦  1.7693959833451671 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 2.2945987810292245e-6 kg ha^-1 d^-1, 3.6582396482316466 kg ha^-1 d^-1, 1.7320934118470223e-11 kg ha^-1 d^-1, 3.1949692602610033e-25 kg ha^-1 d^-1, 8.451619410633925e-19 kg ha^-1 d^-1, 6.899396339503229e-14 kg ha^-1 d^-1, 7.859108028964992e-5 kg ha^-1 d^-1, 8.755799744857432e-20 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  â€¦  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, ğŒ ğ‹^-2 ğ“^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), ğŒ ğ‹^-2 ğ“^-1, nothing}}[4.605305312842687e-16 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 9.562657926547305e-12 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 8.857096883231448e-5 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 8.330823626284292e-14 kg ha^-1 d^-1, 6.2545036218445485e-31 kg ha^-1 d^-1, 0.1098211185753646 kg ha^-1 d^-1, 6.532494239575888e-13 kg ha^-1 d^-1  â€¦  1.2714855610409974 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.4140084387182431e-6 kg ha^-1 d^-1, 3.0664166837932845 kg ha^-1 d^-1, 1.5475444785993372e-11 kg ha^-1 d^-1, 3.0339836697244623e-25 kg ha^-1 d^-1, 1.0331687701542745e-18 kg ha^-1 d^-1, 6.49081780298679e-14 kg ha^-1 d^-1, 7.31012041259396e-5 kg ha^-1 d^-1, 1.1342490992166207e-19 kg ha^-1 d^-1], species_specific_red = [0.789299465663918, 1.30343287844416, 0.8501911184457237, 0.9695200692326102, 0.8712395689595865, 0.8461577687135523, 0.9444163028404143, 1.0493452686024738, 1.119040718216494, 0.9050261045267476  â€¦  1.0631043503830133, 0.9295189652450446, 1.1371936221279921, 0.8836130443347112, 0.9184135548808312, 0.935953022282059, 1.3170199881946036, 0.9023441387905266, 0.9470881410918173, 0.9289435236791538], LAIs = [2.3894865118726615e-17, 0.0, 8.989192011642558e-13, 0.0, 8.580511248869092e-6, 0.0, 6.432748732130041e-15, 2.327553191067207e-32, 0.005727946176237172, 3.5544188194404353e-14  â€¦  0.0893995218971174, 0.0, 1.0838230866618404e-7, 0.22238018559124095, 1.0130224720240563e-12, 1.8335750364759362e-26, 3.446939177302424e-20, 4.107002306518046e-15, 4.457269712696412e-6, 5.062820890157559e-21], biomass_per_patch = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[NaN kg ha^-1], relbiomass = [1.0], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  â€¦  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [0.8439735195424352, 0.9161304923098743, 0.8658885243428995, 0.8172277811212199, 0.8247106494938401, 0.7958870676880906, 0.8916418601114466, 0.7876112305213228, 0.8795370544263117, 0.9186666660109435  â€¦  0.9222093209219695, 0.9086168492670723, 0.9284740126596767, 0.8101759571444684, 0.8256610136986781, 0.8587326994213155, 0.9382759966610221, 0.7897678771379233, 0.9122989006936884, 0.9313812944983046], denominator = [1.9227505428579623, 3.576985346192993, 2.236945037925371, 1.6413873062348099, 1.711455939187006, 1.4697745831291253, 2.7685968060041533, 1.4125040638277182, 2.4903923656464726, 3.6885245604264245  â€¦  3.8565031640754164, 3.282880898654572, 4.194279745801885, 1.5804109715876162, 1.7207855016518776, 2.123633698464443, 4.8603457937174035, 1.4269941049723207, 3.4207096874828973, 4.371985711572302], traitmat = [-3.9509255101356597 -4.00135014404247 â€¦ -3.9582759652451482 -4.295713149684941; -2.1559866679065585 0.3800531095368085 â€¦ -0.9580553775108319 -1.2887571792482737; â€¦ ; 0.8097468409896971 0.5187362590110874 â€¦ 0.6761432465451844 0.5704451167404063; 0.19015953061840007 -0.70125663850049 â€¦ 0.4916079921544879 0.7337393181941538], similarity_matprep = [1.16072621e-315 1.128735655e-315 â€¦ 1.507e-321 0.0; 1.128735655e-315 1.101276435e-315 â€¦ 1.349577386e-315 0.0; â€¦ ; 1.101267265e-315 3.18299368691e-312 â€¦ 1.74089043968e11 1.35475045e-315; 1.10127596e-315 2.12199579148e-312 â€¦ 3.1e-322 0.0], amc_resid = [2.088040723456636, 0.07784157319809427, 1.9342051346846683, 0.19628483177897108, -0.29291540388164816, 2.6713195990045406, -0.24175753065834893, 0.2540682402670949, 0.5329875438558972, -0.6752722855562293  â€¦  -0.5236164671542095, -0.7361620985290477, 0.03323589533642383, -0.6829333814582026, -0.1545682083606964, -0.41369976893014426, -1.6938949833163828, -0.8178892245293097, 0.27373367716168734, -0.09251514194508956], rsa_above_resid = [0.2638167812318981, -0.9033445652654097, -0.06921205310548777, 0.6771755035850435, 0.5593475342170133, 1.0310464316125418, -0.4755433419772373, 1.1787938421044541, -0.2810418883136697, -0.9514989179318375  â€¦  -1.0203747057726826, -0.7656262430991793, -1.1473891562376919, 0.7907043421350214, 0.5445416409187488, 0.03997526693169744, -1.3626287923381082, 1.139558591519711, -0.8322483263015453, -1.2089171942791126], nutgradient = [0.5;;], biomass_density_factor = [22.55637962163513, 14.131450847138021, 22.320670380330146, 12.460123512865641, 11.3422423966347, 29.23225589623124, 12.543676208380178, 13.724448579058704, 14.75978304389326, 12.19667410006224  â€¦  12.442525263969761, 12.11600154651336, 14.636624761376524, 10.506239030518806, 11.686170354702421, 11.544039656570467, 17.542785461069354, 11.635568570269143, 14.718242045232556, 14.41548451745437], TS_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[73.8592515364452 kg ha^-1, 107.57943622355111 kg ha^-1, 74.48587284587845 kg ha^-1, 119.0396949065806 kg ha^-1, 128.38759610123552 kg ha^-1, 59.95904736134769 kg ha^-1, 118.40159390166305 kg ha^-1, 110.13779546145423 kg ha^-1, 103.8806939499159 kg ha^-1, 121.10324199141611 kg ha^-1  â€¦  119.17507998323316 kg ha^-1, 121.7513061674124 kg ha^-1, 104.5830850939429 kg ha^-1, 136.54157550807764 kg ha^-1, 125.33997683319515 kg ha^-1, 126.57956289553012 kg ha^-1, 90.40718429206294 kg ha^-1, 125.77816575830506 kg ha^-1, 104.11642355554787 kg ha^-1, 105.87142207173173 kg ha^-1], heightinfluence = [0.9235316328913231, 1.3861365642084778, 0.9721548082050295, 1.0626656295294354, 0.938052453798543, 1.0321166655436917, 1.0005501714421163, 1.1618327302663358, 1.2233178029194876, 0.9422880624627803  â€¦  1.1094278500383654, 0.9691678670776214, 1.203639683727273, 0.9463861400107745, 0.9925257509783035, 0.995598994521926, 1.3467706724764772, 0.9692872356034077, 1.0155492028042317, 0.9784380151407917], relative_height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[1.2092740539453459e-17 m, 0.0 m, 5.353622447866387e-13 m, 0.0 m, 3.028249342400369e-6 m, 0.0 m, 6.325960275563606e-15 m, 1.1349676310796915e-31 m, 0.024793338685807017 m, 2.5306457703079428e-14 m  â€¦  0.18802131685298062 m, 0.0 m, 2.934501193043043e-7 m, 0.1255524629604853 m, 1.1081738364357904e-12 m, 2.197409407853058e-26 m, 3.180322904723984e-19 m, 3.661941624777803e-15 m, 6.36208746495795e-6 m, 7.168413143557805e-21 m], nutrients_splitted = [13.563668445735932, 8.497565529707096, 13.421931072439099, 7.492558068109723, 6.820350511904101, 17.57802597528049, 7.542800220384006, 8.252825730435612, 8.875396091770991, 7.334139893410192  â€¦  7.481975837394813, 7.285629636562131, 8.801338191592674, 6.317642512317188, 7.027162281820188, 6.941695832959143, 10.548879279385558, 6.996734268179326, 8.850416536443854, 8.668361490593533], Nutred = [0.889790510344991, 0.9607282645882252, 0.9052701999961533, 0.9565978728710619, 0.9718923837882458, 0.8644865914613, 0.9705129889288527, 0.9544886627221099, 0.9435252772218974, 0.9806422769390186  â€¦  0.9774906849083724, 0.9817971604358781, 0.9622144096173216, 0.9807909694560086, 0.9680435953261095, 0.9749484107589124, 0.9934288595457303, 0.9832528972944158, 0.9537572410265982, 0.9661945947422149], amc_nut = [0.8795755726401704, 0.9607282645882252, 0.8846588501181886, 0.9565978728710619, 0.9718923837882458, 0.8644865914613, 0.9705129889288527, 0.9544886627221099, 0.9435252772218974, 0.9806422769390186  â€¦  0.9774906849083724, 0.9817971604358781, 0.9622144096173216, 0.9807909694560086, 0.9680435953261095, 0.9749484107589124, 0.9934288595457303, 0.9832528972944158, 0.9537572410265982, 0.9661945947422149], rsa_above_nut = [0.889790510344991, 0.9407586737005228, 0.9052701999961533, 0.870898626267338, 0.876184159223562, 0.8558245880051044, 0.9234610992822371, 0.8499789405999801, 0.9149108554196601, 0.9425501030043922  â€¦  0.9450524615054812, 0.9354514030194904, 0.9494775339498118, 0.8659175620317315, 0.876855450107612, 0.9002156745697283, 0.9564011769828844, 0.8515022904972842, 0.9380522244148125, 0.9515310959271046], water_splitted = [15.814598007402047, 9.90776082676376, 15.649338911731718, 8.73596950325949, 7.952207181033747, 20.495149647374706, 8.794549484362925, 9.62240575800966, 10.348293450946985, 8.551261379497655  â€¦  8.72363112109928, 8.494700706818497, 10.261945430477597, 7.366073351503907, 8.193339955511911, 8.093690105085015, 12.29949595859824, 8.157862326003409, 10.319168466988348, 10.106900865722476], Waterred = [0.9605108246957907, 0.978773233350259, 0.9660573541298985, 0.9537416714721932, 0.9556355314123659, 0.9483404910353447, 0.9725753374097234, 0.9462459364205819, 0.9695116985176464, 0.9794151205965119  â€¦  0.9803117409677051, 0.976871584563333, 0.9818972891998492, 0.9519569057554014, 0.9558760617286151, 0.9642462665251152, 0.9843781005558642, 0.9467917681028861, 0.9778034851858322, 0.9826331012353937], sla_water = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  â€¦  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], rsa_above_water = [0.9605108246957907, 0.978773233350259, 0.9660573541298985, 0.9537416714721932, 0.9556355314123659, 0.9483404910353447, 0.9725753374097234, 0.9462459364205819, 0.9695116985176464, 0.9794151205965119  â€¦  0.9803117409677051, 0.976871584563333, 0.9818972891998492, 0.9519569057554014, 0.9558760617286151, 0.9642462665251152, 0.9843781005558642, 0.9467917681028861, 0.9778034851858322, 0.9826331012353937], mown_height = Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.03578888905254678 m, 1.3823622527537647 m, 0.1773236378274648 m, 0.4407870228267193 m, 0.0780568142929124 m, 0.3518635842573459 m, 0.25997826859158746 m, 0.7294475349997624 m, 0.9084213320672349 m, 0.09038603393630133 m  â€¦  0.5769048121152159 m, 0.1686291015421304 m, 0.8511412873506184 m, 0.10231492118961864 m, 0.23662038776454292 m, 0.2455661374006869 m, 1.2677740638779398 m, 0.1689765653636477 m, 0.3036381925271947 m, 0.1956131080115155 m], mowing_Î» = [0.3090874206099795, 0.945293992750871, 0.6891074575370338, 0.8463863412613907, 0.4938528885458666, 0.81475631908726, 0.7646908423546823, 0.9011671584125296, 0.9190628556825217, 0.5304779496780356  â€¦  0.8782167545060263, 0.6782355745815865, 0.9140839300256738, 0.5611988339846571, 0.7473314950915524, 0.7542741986659967, 0.9406428702376, 0.678684618838908, 0.7914701884267451, 0.7097380433855943], biomass_Ï = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[1.2298169271015366e-13 kg ha^-1, 0.0 kg ha^-1, 4.227482999829408e-10 kg ha^-1, 0.0 kg ha^-1, 0.006710233286045134 kg ha^-1, 0.0 kg ha^-1, 9.628278933160682e-12 kg ha^-1, 1.1882173400468635e-27 kg ha^-1, 3.650966480455965 kg ha^-1, 1.5665820315927095e-10 kg ha^-1  â€¦  41.68816582227282 kg ha^-1, 0.0 kg ha^-1, 3.0112260511974076e-5 kg ha^-1, 123.42008666230737 kg ha^-1, 2.2437869660869647e-9 kg ha^-1, 2.4370759735682537e-22 kg ha^-1, 3.750885126629147e-16 kg ha^-1, 1.1526654178767167e-11 kg ha^-1, 0.0048196060689708175 kg ha^-1, 6.240370276821006e-17 kg ha^-1], grazed_share = [2.7566336666685285e-16, 0.0, 9.475899791088547e-13, 0.0, 1.5040982588447163e-5, 0.0, 2.1581779592008116e-14, 2.6633882252802002e-30, 0.00818363847017718, 3.511492381280176e-13  â€¦  0.09344399062564665, 0.0, 6.749660805404384e-8, 0.2766460263628931, 5.029446704823806e-12, 5.4627038617858965e-25, 8.40760603632387e-19, 2.583698619933831e-14, 1.0803143180926474e-5, 1.3987785025943228e-19], trampling_proportion = [0.0010720189491670385, 0.013539123298671575, 0.00238240316559606, 0.004821650518619001, 0.001463351979222145, 0.003998362447099477, 0.0031476521557244046, 0.0074941827577471596, 0.009151192367482996, 0.0015775007304046293  â€¦  0.006081882399501573, 0.0023019057385254105, 0.008620871247315054, 0.0016879430473028415, 0.0029313957336801993, 0.003014218992482677, 0.012478220902675106, 0.002305122694866079, 0.0035518728556649835, 0.002551734253992893], trampled_biomass = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[1.2406445422433454e-16 kg ha^-1, 0.0 kg ha^-1, 5.680840442408162e-13 kg ha^-1, 0.0 kg ha^-1, 1.3925698663360806e-5 kg ha^-1, 0.0 kg ha^-1, 2.1640565651316852e-14 kg ha^-1, 1.0027385366410246e-29 kg ha^-1, 0.06083199956450561 kg ha^-1, 5.050235958310094e-13 kg ha^-1  â€¦  0.39172635814445067 kg ha^-1, 0.0 kg ha^-1, 1.5774368342998227e-7 kg ha^-1, 0.6330726200616975 kg ha^-1, 6.439677608563453e-12 kg ha^-1, 6.281991698271817e-25 kg ha^-1, 9.746878243124346e-18 kg ha^-1, 2.1127437639849105e-14 kg ha^-1, 3.0530583459897476e-5 kg ha^-1, 2.2673879502669815e-19 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, ğŒ ğ‹^-2, Unitful.FreeUnits{(ha^-1, kg), ğŒ ğ‹^-2, nothing}}[NaN kg ha^-1 NaN kg ha^-1 â€¦ NaN kg ha^-1 NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, ğ‹^2 ğŒ^-1, Unitful.FreeUnits{(g^-1, m^2), ğ‹^2 ğŒ^-1, nothing}}[2.009059043526239e-18 m^2 g^-1, 0.0 m^2 g^-1, 6.292840670827394e-14 m^2 g^-1, 0.0 m^2 g^-1, 6.006745666734173e-7 m^2 g^-1, 0.0 m^2 g^-1, 4.503214837811044e-16 m^2 g^-1, 3.244558211089403e-33 m^2 g^-1, 0.00040098211954368043 m^2 g^-1, 2.6989828946112933e-15 m^2 g^-1  â€¦  0.006258370570103187 m^2 g^-1, 0.0 m^2 g^-1, 7.80829553311336e-9 m^2 g^-1, 0.015567618029098009 m^2 g^-1, 7.091615135329886e-14 m^2 g^-1, 1.705219089262994e-27 m^2 g^-1, 3.77909469644886e-21 m^2 g^-1, 2.8750872287704287e-16 m^2 g^-1, 3.166798201909319e-7 m^2 g^-1, 3.5442034351290354e-22 m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">size(sol.o.biomass)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(5844, 1, 25)</code></pre><p>The three dimension of the array are: daily time step, patch within site, species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
total_biomass = vec(sum(species_biomass; dims=2))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg haâ»Â¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="f08c7e5d.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color) + 0.0001)
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = 2)
biomass_cumfraction = cumsum(biomass_fraction; dims=2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, ylower, yupper;
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap, label = &quot;SLA [mÂ² gâ»Â¹]&quot;)

    fig
end</code></pre><img src="83576c13.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.o.water; dims=2); dims = 2)

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="db242ccf.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We calculate for all traits the community weighted mean over time.  As an example, we show here the specific leaf area (SLA):</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
trait_vals = sol.traits.sla
weighted_trait = trait_vals .* relative_biomass&#39;
cwm_trait = vec(sum(weighted_trait; dims = 1))

lines(sol.numeric_date, ustrip.(cwm_trait), color = :black, linewidth = 2;
      axis = (; ylabel = &quot;Community weighted mean\nspecific leaf area [mÂ² kgâ»Â¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="f1d69bac.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.o.mown_biomass)
sum(sol.o.grazed_biomass)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.o.grazed_biomass; dims=2); dims=2)
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.o.mown_biomass; dims=2); dims=2)
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg haâ»Â¹]&quot;)
      lines!(sol.numeric_date, ustrip.(cum_grazed), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg haâ»Â¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(cum_mown), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="b933563f.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.o.biomass; dims = 2); dims = 2)
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="a4d7830b.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">Â« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../../Modelling_API/main_equations/">Difference equation Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Wednesday 15 November 2023 15:20">Wednesday 15 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
