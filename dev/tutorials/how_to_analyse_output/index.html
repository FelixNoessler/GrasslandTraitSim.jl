<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analyse model output · GrasslandTraitSim.jl</title><meta name="title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="og:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Analyse model output · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../how_to_prepare_input/">Prepare input and run simulation</a></li><li class="is-active"><a class="tocitem" href>Analyse model output</a><ul class="internal"><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Share-of-each-species"><span>Share of each species</span></a></li><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Grazed-and-mown-biomass"><span>Grazed and mown biomass</span></a></li><li><a class="tocitem" href="#Shannon-and-Simpson-diversity"><span>Shannon and Simpson diversity</span></a></li></ul></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Analyse model output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analyse model output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/tutorials/how_to_analyse_output.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-analyse-the-model-output"><a class="docs-heading-anchor" href="#How-to-analyse-the-model-output">How to analyse the model output</a><a id="How-to-analyse-the-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-analyse-the-model-output" title="Permalink"></a></h1><p>I assume that you have read the tutorial on how to prepare the input data and run a simulation (see <a href="../how_to_prepare_input/#How-to-prepare-the-input-data-to-start-a-simulation">here</a>). In this tutorial, we will analyse the output of the simulation that is stored in the object <code>sol</code>.</p><pre><code class="language-julia hljs">import GrasslandTraitSim as sim
import GrasslandTraitSim.Valid as valid

using Statistics
using CairoMakie
using Unitful

input_obj = valid.validation_input(;
    plotID = &quot;HEG01&quot;, nspecies = 25,
    npatches = 1, nutheterog = 0.0,
    trait_seed = 99);

mp = valid.model_parameters();
inf_p = (; zip(Symbol.(mp.names), mp.best)...);

sol = sim.solve_prob(; input_obj, inf_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(p = (moistureconv_alpha = 0.21651602851309687, moistureconv_beta = 0.009080524259062913, sen_α = 0.0022507510254258373, sen_leaflifespan = 0.4182589039462492, sla_tr = 0.029649325167562544, sla_tr_exponent = 3.082555885130148, βₚₑₜ = 0.02049211588764277, biomass_dens = 854.4614603568936, belowground_density_effect = 1.100089893534349, height_strength = 0.17993881467364325, leafnitrogen_graz_exp = 9.341204546398654, trampling_factor = 124.78994460980397, grazing_half_factor = 158.78495903196819, mowing_mid_days = 22.08006294455497, totalN_β = 0.18650959184142935, CN_β = 0.07936480911148232, max_rsa_above_water_reduction = 0.9707610587585661, max_sla_water_reduction = 0.7121330159290473, max_amc_nut_reduction = 0.3877113437861343, max_rsa_above_nut_reduction = 0.42223360948269534, b_biomass = 1046.5984727631396, b_soilmoisture = 4.936100774508173, b_sla = 0.013943348787610315, b_lncm = 4.3167910984713105, b_amc = 0.20720690473608316, b_height = 0.6404617014196398, b_rsa_above = 0.014366500360505423, b_var_sla = 0.0, b_var_lncm = 0.0, b_var_amc = 0.0, b_var_height = 0.0, b_var_rsa_above = 0.0), doy = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  356, 357, 358, 359, 360, 361, 362, 363, 364, 365], date = Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;), numeric_date = [2006.0, 2006.0027397260274, 2006.0054794520547, 2006.0082191780823, 2006.0109589041097, 2006.013698630137, 2006.0164383561644, 2006.0191780821917, 2006.021917808219, 2006.0246575342467  …  2021.972602739726, 2021.9753424657533, 2021.978082191781, 2021.9808219178083, 2021.9835616438356, 2021.986301369863, 2021.9890410958903, 2021.9917808219177, 2021.9945205479453, 2021.9972602739726], ts = Base.OneTo(5844), simp = (nspecies = 25, npatches = 1, ntimesteps = 5844, plotID = &quot;HEG01&quot;, patch_xdim = 1, patch_ydim = 1, nutheterog = 0.0, trait_seed = 99, included = (senescence_included = true, potgrowth_included = true, mowing_included = true, grazing_included = true, below_included = true, height_included = true, water_red = true, nutrient_red = true, temperature_red = true, season_red = true, radiation_red = true)), site = (initbiomass = 1500 kg ha^-1, initsoilwater = 180.0 mm, totalN = 5.29, CNratio = 9.995000000000001, clay = 50.2, silt = 44.7, sand = 5.0, organic = 5.608, bulk = 0.68, rootdepth = 160.0), daily_input = (temperature = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 0.2 °C, 1.1 °C, -0.7 °C, 0.1 °C, -0.7 °C, -0.5 °C, -2.1 °C, -6.2 °C, -4.2 °C  …  -5.8 °C, -1.5 °C, 6.0 °C, -4.6 °C, -7.8 °C, -1.0 °C, 4.9 °C, 6.8 °C, 11.1 °C, 11.9 °C], temperature_sum = Unitful.Quantity{Float64, 𝚯, Unitful.FreeUnits{(K,), 𝚯, Unitful.Affine{-5463//20}}}[3.2 °C, 3.4000000000000004 °C, 4.5 °C, 3.8000000000000003 °C, 3.9000000000000004 °C, 3.2 °C, 2.7 °C, 0.6000000000000001 °C, -5.6000000000000005 °C, -9.8 °C  …  3227.099999999999 °C, 3225.599999999999 °C, 3231.599999999999 °C, 3226.999999999999 °C, 3219.199999999999 °C, 3218.199999999999 °C, 3223.099999999999 °C, 3229.899999999999 °C, 3240.999999999999 °C, 3252.899999999999 °C], precipitation = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.0 mm d^-1, 0.3 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.8 mm d^-1, 1.1 mm d^-1, 1.2 mm d^-1, 0.0 mm d^-1, 0.8 mm d^-1, 1.6 mm d^-1, 1.3 mm d^-1, 0.0 mm d^-1, 0.3 mm d^-1], PET = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[0.1 mm d^-1, 0.2 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.2 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1  …  0.0 mm d^-1, 0.1 mm d^-1, 0.9 mm d^-1, 0.0 mm d^-1, 0.0 mm d^-1, 0.1 mm d^-1, 0.1 mm d^-1, 0.2 mm d^-1, 0.6 mm d^-1, 1.0 mm d^-1], PAR = Unitful.Quantity{Float64, 𝐌 𝐓^-3, Unitful.FreeUnits{(ha^-1, d^-1, MJ), 𝐌 𝐓^-3, nothing}}[8540.0 MJ ha^-1 d^-1, 7860.0 MJ ha^-1 d^-1, 5350.0 MJ ha^-1 d^-1, 4700.0 MJ ha^-1 d^-1, 2150.0 MJ ha^-1 d^-1, 1650.0 MJ ha^-1 d^-1, 2460.0 MJ ha^-1 d^-1, 7990.0 MJ ha^-1 d^-1, 9570.0 MJ ha^-1 d^-1, 10000.0 MJ ha^-1 d^-1  …  11359.999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 2039.9999999999998 MJ ha^-1 d^-1, 3220.0 MJ ha^-1 d^-1, 2380.0 MJ ha^-1 d^-1, 2849.9999999999995 MJ ha^-1 d^-1, 5010.0 MJ ha^-1 d^-1, 3770.0 MJ ha^-1 d^-1, 9010.0 MJ ha^-1 d^-1, 16410.0 MJ ha^-1 d^-1], mowing = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m  …  NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m, NaN m], grazing = Unitful.Quantity{Float64, 𝐋^-2, Unitful.FreeUnits{(ha^-1,), 𝐋^-2, nothing}}[NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1  …  NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1, NaN ha^-1]), patch = (xs = [1], ys = [1], WHC = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm], PWP = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[59.33808384000001 mm], nutrients = [0.5835854796213336], nneighbours = [0], neighbours = Union{Missing, Int64}[missing missing missing missing], surroundings = Union{Missing, Int64}[1 missing … missing missing]), traits = (TS = [1.0 0.5099403059191145 … 0.2297371315475153 0.16651291828212433; 0.5099403059191145 1.0 … 0.3940181081028362 0.33079389483744526; … ; 0.2297371315475153 0.3940181081028362 … 1.0 0.25238843118205545; 0.16651291828212433 0.33079389483744526 … 0.25238843118205545 1.0], amc = [0.5689769932842332, 0.33504255572113895, 0.17876449078771592, 0.28718823809145017, 0.15121942054960005, 0.2517977044462722, 0.21341337374942707, 0.1458082485706625, 0.45910645530704364, 0.29674094405728213  …  0.2695052188612268, 0.1670162891829191, 0.11843861466022655, 0.45642112969046794, 0.17888573498838695, 0.11556054752433535, 0.4442855724287982, 0.3395907987375953, 0.022849605315074618, 0.2675260839157634], height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.1353936338928796 m, 0.4220062870433608 m, 0.6688946623083839 m, 0.3913904124225731 m, 1.5035731522679916 m, 0.9339838525063265 m, 0.3665516547661263 m, 0.4808384203540002 m, 0.29248581891560993 m, 0.10209598500600861 m  …  0.2608826097819992 m, 1.0375201687180646 m, 0.7514354161998551 m, 0.09766920505329246 m, 0.22214736118799355 m, 0.3700565811313098 m, 0.26691210371947743 m, 0.264335274276464 m, 0.23336427368178853 m, 0.3139955698848576 m], lmpm = [0.598821519454808, 0.5627460243113944, 0.4102357042585767, 0.5887070369356419, 0.38305023622122575, 0.5470739521675261, 0.2982208091729813, 0.42965668413907865, 0.5511937748527475, 0.5849154040658051  …  0.39160976402861797, 0.3898384811326329, 0.5672486792592263, 0.45322468286333945, 0.45318686320826645, 0.38364392657338153, 0.5127276055703845, 0.5595262316454294, 0.6307073199881081, 0.6898899193621761], lncm = Unitful.Quantity{Float64, NoDims, Unitful.FreeUnits{(mg, g^-1), NoDims, nothing}}[30.745096667136274 mg g^-1, 23.58323053438999 mg g^-1, 25.965850538543087 mg g^-1, 22.653696638986112 mg g^-1, 22.46352451974828 mg g^-1, 27.48379114741372 mg g^-1, 20.10485657743951 mg g^-1, 25.902107727399365 mg g^-1, 25.66117058624345 mg g^-1, 19.64110631035819 mg g^-1  …  29.344831762084347 mg g^-1, 30.282133691664995 mg g^-1, 15.784663867847412 mg g^-1, 22.60715473227189 mg g^-1, 31.27066488179855 mg g^-1, 32.918901581356714 mg g^-1, 24.17412199506109 mg g^-1, 20.864192643522767 mg g^-1, 14.778944330981636 mg g^-1, 36.21635671591471 mg g^-1], sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.02448908197094162 m^2 g^-1, 0.019630676423230103 m^2 g^-1, 0.017733895576482837 m^2 g^-1, 0.0230485759162377 m^2 g^-1, 0.016476122015263397 m^2 g^-1, 0.014730447179322686 m^2 g^-1, 0.017821043255116395 m^2 g^-1, 0.030162515764332477 m^2 g^-1, 0.01659058936562181 m^2 g^-1, 0.02122224199035973 m^2 g^-1  …  0.024755788858170726 m^2 g^-1, 0.014145242627371601 m^2 g^-1, 0.030140737870313905 m^2 g^-1, 0.026027827375394715 m^2 g^-1, 0.028846546119545617 m^2 g^-1, 0.027465786682511317 m^2 g^-1, 0.01571739149851368 m^2 g^-1, 0.01892959136603191 m^2 g^-1, 0.01287205244983704 m^2 g^-1, 0.019236249495486333 m^2 g^-1], rsa_above = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.12375708955598282 m^2 g^-1, 0.143027814122531 m^2 g^-1, 0.09726201561645119 m^2 g^-1, 0.09713370034370686 m^2 g^-1, 0.09133315553879987 m^2 g^-1, 0.09514908459892137 m^2 g^-1, 0.14739415693891753 m^2 g^-1, 0.10670516999027972 m^2 g^-1, 0.14456592625709774 m^2 g^-1, 0.11071677982500472 m^2 g^-1  …  0.11773286556130884 m^2 g^-1, 0.0924485240774257 m^2 g^-1, 0.0978435868700461 m^2 g^-1, 0.14184937986676688 m^2 g^-1, 0.15525106468125477 m^2 g^-1, 0.12872805876419205 m^2 g^-1, 0.10716421068203848 m^2 g^-1, 0.11266690277718544 m^2 g^-1, 0.12299126061983685 m^2 g^-1, 0.07502805067195722 m^2 g^-1], ampm = [0.6807508985640992, 0.5923642361172573, 0.6208115540234691, 0.6704882966926735, 0.6691186258228269, 0.6549624241921063, 0.6035792516056352, 0.559105225308202, 0.5802039735292078, 0.6157004253324264  …  0.5254754332636676, 0.633957012887499, 0.5971038729044488, 0.5406052012491624, 0.6311551282316757, 0.6665965821173746, 0.6635762386371661, 0.6367086657121572, 0.6639024420927454, 0.7261999151180801], leaflifespan = Unitful.Quantity{Float64, 𝐓, Unitful.FreeUnits{(d,), 𝐓, nothing}}[34.573591150705774 d, 61.86913895052454 d, 80.83670299948872 d, 40.553633834469274 d, 98.1036793255219 d, 131.72943952128443 d, 79.80057484798475 d, 19.980189601654185 d, 96.3324543534133 d, 50.394059081401736 d  …  33.60197830848113 d, 146.5592338834529 d, 20.01820276071169 d, 29.450906629066225 d, 22.46896838220073 d, 25.56468495527837 d, 111.06203680340661 d, 68.08278256051739 d, 187.8492662342694 d, 65.26360815862905 d], μ = Unitful.Quantity{Float64, 𝐓^-1, Unitful.FreeUnits{(d^-1,), 𝐓^-1, nothing}}[0.014348392318257259 d^-1, 0.009011131257656353 d^-1, 0.007424872289981798 d^-1, 0.012564472988135445 d^-1, 0.006514188511377888 d^-1, 0.005425887164061486 d^-1, 0.007492052917586477 d^-1, 0.023184431450141176 d^-1, 0.0065925785720571065 d^-1, 0.010550517140130625 d^-1  …  0.014698199806757881 d^-1, 0.005104606718195478 d^-1, 0.02314467986339007 d^-1, 0.016452653507214074 d^-1, 0.020865709079200212 d^-1, 0.018611559096322516 d^-1, 0.006016744482637671 d^-1, 0.008394138357964244 d^-1, 0.00447731763561761 d^-1, 0.00865951259634042 d^-1], ρ = [6.048052396384446, 0.5078845988255933, 1.2480168489065313, 0.3488415682384852, 0.3224247525882504, 2.121808277817438, 0.11439259812953917, 1.2196892659346437, 1.1177292100520946, 0.09198658750469503  …  3.913001088172579, 5.248832350161735, 0.011938734067646808, 0.34220386651149237, 7.085630651352522, 11.448910426375383, 0.6399688375408242, 0.16173237560222442, 0.006454688082494387, 27.928339428370514]), funresponse = (amc_nut_upper = [0.8953962069609646, 0.9461845857715454, 0.9822205077884165, 0.9595302071120028, 0.9859854920073595, 0.9683056945356665, 0.9763548186787562, 0.9866388906538723, 0.9129298648305217, 0.9569741735847056  …  0.9640628653277756, 0.9839187788030861, 0.9895506297949066, 0.9135216237080264, 0.9822022386081534, 0.9898211398253403, 0.9162920190793864, 0.9448673924399905, 0.9957473709034486, 0.9645524907218923], amc_nut_midpoint = [0.10537010679432351, 0.34552822780808456, 0.5159278255752645, 0.4086343835851548, 0.5337309442579865, 0.45013018675908695, 0.48819130576468495, 0.5368206075804706, 0.18827982801530757, 0.39654791373634823  …  0.43006752844605756, 0.5239582763477989, 0.5505890683458947, 0.19107802129185936, 0.5158414378600586, 0.5518682031036043, 0.20417812337096786, 0.33929974241582783, 0.5798910018962157, 0.4323827729450056], rsa_above_water_upper = [0.8434646794252255, 0.7916934869686368, 0.9163888748065139, 0.9166944772751167, 0.9297856810703845, 0.9213347150101691, 0.7817342796434792, 0.8922167637657413, 0.7880932039617254, 0.8811147837461654  …  0.8609838575387158, 0.9273809691222779, 0.9149954186876278, 0.7945174011829041, 0.7659186402766837, 0.8292223355626789, 0.8909671961783807, 0.8755900819550299, 0.8456848212105921, 0.9586491600189821], rsa_above_nut_upper = [0.9319147870410653, 0.9093968489130946, 0.9636332474764675, 0.9637661696123739, 0.969460203361542, 0.9657844462109785, 0.9050650805355441, 0.9531195607134098, 0.9078309017879479, 0.9482907420728423  …  0.9395347731780134, 0.9684142712071212, 0.9630271621772843, 0.9106251135625691, 0.8981860504839488, 0.9257200636306856, 0.9525760598921277, 0.9458877668426968, 0.9328804401965365, 0.9820144058491032], rsa_above_midpoint = [0.30437481142810546, 0.20660219067788949, 0.4420959911074802, 0.4426731374478525, 0.4673965645721511, 0.45143647054358027, 0.18779370366859555, 0.3964456876592197, 0.19980286680055448, 0.37547901429273967  …  0.3374607010178047, 0.4628551395409834, 0.4394643759141822, 0.2119353012438519, 0.15792503662893798, 0.2774773957227479, 0.39408581352799876, 0.36504532429350567, 0.30856766599629726, 0.521906763137491], sla_water_midpoint = [-0.015325665650760545, -0.15893762433859682, -0.21274396831601694, -0.05843844557646605, -0.2473490214934866, -0.29370834697023696, -0.21031232257613264, 0.15296919841270662, -0.2442391718747038, -0.11258061047021206  …  -0.007326129448070207, -0.30877431678294776, 0.15233965061820487, 0.030819560891264364, 0.11460264740723447, 0.07376349066761556, -0.2677500112466714, -0.1790304307163233, -0.34066799728709823, -0.1702692594014693]), u = (u_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1 24.62633885391056 kg ha^-1 … 444.69057879421433 kg ha^-1 0.0 kg ha^-1], u_water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[119.297888704175 mm]), du = (du_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1 -0.14156767480549837 kg ha^-1 d^-1 … 0.18092224189262662 kg ha^-1 d^-1 0.0 kg ha^-1 d^-1], du_water = Unitful.Quantity{Float64, 𝐋 𝐓^-1, Unitful.FreeUnits{(d^-1, mm), 𝐋 𝐓^-1, nothing}}[-0.3621227274446421 mm d^-1]), o = DimensionalData.DimStack{NamedTuple{(:biomass, :mown, :grazed, :water), Tuple{Array{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}, 3}, Matrix{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}}, Matrix{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}}, Matrix{Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}}}}, Tuple{DimensionalData.Dimensions.Dim{:time, DimensionalData.Dimensions.LookupArrays.Sampled{Dates.Date, StepRange{Dates.Date, Dates.Day}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Dates.Day}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}, DimensionalData.Dimensions.Dim{:patch, DimensionalData.Dimensions.LookupArrays.Sampled{Int64, UnitRange{Int64}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Int64}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}, DimensionalData.Dimensions.Dim{:species, DimensionalData.Dimensions.LookupArrays.Sampled{Int64, UnitRange{Int64}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Int64}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}}, Tuple{}, NamedTuple{(:biomass, :mown, :grazed, :water), Tuple{Tuple{DimensionalData.Dimensions.Dim{:time, Colon}, DimensionalData.Dimensions.Dim{:patch, Colon}, DimensionalData.Dimensions.Dim{:species, Colon}}, Tuple{DimensionalData.Dimensions.Dim{:time, Colon}, DimensionalData.Dimensions.Dim{:patch, Colon}}, Tuple{DimensionalData.Dimensions.Dim{:time, Colon}, DimensionalData.Dimensions.Dim{:patch, Colon}}, Tuple{DimensionalData.Dimensions.Dim{:time, Colon}, DimensionalData.Dimensions.Dim{:patch, Colon}}}}, DimensionalData.Dimensions.LookupArrays.NoMetadata, NamedTuple{(:biomass, :mown, :grazed, :water), NTuple{4, DimensionalData.Dimensions.LookupArrays.NoMetadata}}}((biomass = [59.14992188705432 kg ha^-1; 58.301215602224595 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;; 59.46889825641481 kg ha^-1; 58.933016208478044 kg ha^-1; … ; 24.767906528716058 kg ha^-1; 24.62633885391056 kg ha^-1;;; 59.56105943388699 kg ha^-1; 59.11882617413436 kg ha^-1; … ; 2.1468517822759887e-18 kg ha^-1; 2.1376542146735585e-18 kg ha^-1;;; … ;;; 59.50455800304749 kg ha^-1; 59.005068510240406 kg ha^-1; … ; 8.924941388849743e-6 kg ha^-1; 8.873499729095949e-6 kg ha^-1;;; 59.737702387742196 kg ha^-1; 59.470237719330285 kg ha^-1; … ; 444.5096565523217 kg ha^-1; 444.69057879421433 kg ha^-1;;; 59.49109858519465 kg ha^-1; 58.97593466762603 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1], mown = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], grazed = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1; 0.0 kg ha^-1; … ; 0.0 kg ha^-1; 0.0 kg ha^-1;;], water = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}[120.05699583999998 mm; 120.05699583999998 mm; … ; 119.66001143161964 mm; 119.297888704175 mm;;]), (DimensionalData.Dimensions.Dim{:time, DimensionalData.Dimensions.LookupArrays.Sampled{Dates.Date, StepRange{Dates.Date, Dates.Day}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Dates.Day}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}([Dates.Date(&quot;2006-01-01&quot;), Dates.Date(&quot;2006-01-02&quot;), Dates.Date(&quot;2006-01-03&quot;), Dates.Date(&quot;2006-01-04&quot;), Dates.Date(&quot;2006-01-05&quot;), Dates.Date(&quot;2006-01-06&quot;), Dates.Date(&quot;2006-01-07&quot;), Dates.Date(&quot;2006-01-08&quot;), Dates.Date(&quot;2006-01-09&quot;), Dates.Date(&quot;2006-01-10&quot;)  …  Dates.Date(&quot;2021-12-22&quot;), Dates.Date(&quot;2021-12-23&quot;), Dates.Date(&quot;2021-12-24&quot;), Dates.Date(&quot;2021-12-25&quot;), Dates.Date(&quot;2021-12-26&quot;), Dates.Date(&quot;2021-12-27&quot;), Dates.Date(&quot;2021-12-28&quot;), Dates.Date(&quot;2021-12-29&quot;), Dates.Date(&quot;2021-12-30&quot;), Dates.Date(&quot;2021-12-31&quot;)]), DimensionalData.Dimensions.Dim{:patch, DimensionalData.Dimensions.LookupArrays.Sampled{Int64, UnitRange{Int64}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Int64}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}([1]), DimensionalData.Dimensions.Dim{:species, DimensionalData.Dimensions.LookupArrays.Sampled{Int64, UnitRange{Int64}, DimensionalData.Dimensions.LookupArrays.ForwardOrdered, DimensionalData.Dimensions.LookupArrays.Regular{Int64}, DimensionalData.Dimensions.LookupArrays.Points, DimensionalData.Dimensions.LookupArrays.NoMetadata}}([1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  16, 17, 18, 19, 20, 21, 22, 23, 24, 25])), (), (biomass = (DimensionalData.Dimensions.Dim{:time, Colon}(Colon()), DimensionalData.Dimensions.Dim{:patch, Colon}(Colon()), DimensionalData.Dimensions.Dim{:species, Colon}(Colon())), mown = (DimensionalData.Dimensions.Dim{:time, Colon}(Colon()), DimensionalData.Dimensions.Dim{:patch, Colon}(Colon())), grazed = (DimensionalData.Dimensions.Dim{:time, Colon}(Colon()), DimensionalData.Dimensions.Dim{:patch, Colon}(Colon())), water = (DimensionalData.Dimensions.Dim{:time, Colon}(Colon()), DimensionalData.Dimensions.Dim{:patch, Colon}(Colon()))), DimensionalData.Dimensions.LookupArrays.NoMetadata(), (biomass = DimensionalData.Dimensions.LookupArrays.NoMetadata(), mown = DimensionalData.Dimensions.LookupArrays.NoMetadata(), grazed = DimensionalData.Dimensions.LookupArrays.NoMetadata(), water = DimensionalData.Dimensions.LookupArrays.NoMetadata())), calc = (negbiomass = [0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; … ;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0;;; 0; 0; … ; 0; 0], potgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.989772554240816 kg ha^-1 d^-1, 5.3909724287259804e-20 kg ha^-1 d^-1, 4.7063988893618066e-17 kg ha^-1 d^-1, 8.740279263765431e-8 kg ha^-1 d^-1, 1.8376466871588444e-10 kg ha^-1 d^-1, 5.467295973027256e-18 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 7.323489585042964 kg ha^-1 d^-1, 4.302198660147741e-12 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.7006072996653637e-29 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.00026071562749925125 kg ha^-1 d^-1, 3.181365300727563e-7 kg ha^-1 d^-1, 11.647691062885421 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], act_growth = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.527992895317374 kg ha^-1 d^-1, 3.8622733324326727e-20 kg ha^-1 d^-1, 2.9180214157117036e-17 kg ha^-1 d^-1, 8.679006829862736e-8 kg ha^-1 d^-1, 1.45602503812425e-10 kg ha^-1 d^-1, 2.8851592304487763e-18 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 3.5204420712696236 kg ha^-1 d^-1, 2.183007188841781e-12 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 7.420609548867561e-30 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.00014587828964680722 kg ha^-1 d^-1, 1.7330991881038453e-7 kg ha^-1 d^-1, 6.151555015344738 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], defoliation = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], sen = Unitful.Quantity{Float64, 𝐌 𝐋^-2 𝐓^-1, Unitful.FreeUnits{(ha^-1, d^-1, kg), 𝐌 𝐋^-2 𝐓^-1, nothing}}[0.0 kg ha^-1 d^-1, 0.6695605701228724 kg ha^-1 d^-1, 4.7820300926757077e-20 kg ha^-1 d^-1, 4.090862712500417e-17 kg ha^-1 d^-1, 8.451076525261273e-8 kg ha^-1 d^-1, 1.1345436465948676e-10 kg ha^-1 d^-1, 6.512843952789689e-18 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 4.288663591564925 kg ha^-1 d^-1, 3.151979309972351e-12 kg ha^-1 d^-1  …  0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 1.795158320930234e-29 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1, 0.00018083658815485303 kg ha^-1 d^-1, 2.247515785641789e-7 kg ha^-1 d^-1, 5.970632773452111 kg ha^-1 d^-1, 0.0 kg ha^-1 d^-1], species_specific_red = [0.6974175314459379, 0.7706321698014154, 1.0349761870151328, 0.8956827388653845, 1.4344954787036839, 1.1446198944879231, 0.7623451896737568, 0.9256066193868243, 0.6944381907442847, 0.7330256436923203  …  0.7847168330030617, 1.2168537567103135, 1.076899051457985, 0.6303619709201774, 0.6988178220920871, 0.8077705332810308, 0.8083102046466578, 0.7869811709405199, 0.7629560690781177, 0.9187272373363293], LAIs = [0.0, 0.04619002208087316, 2.515821786059006e-21, 2.196349733982694e-18, 4.078853171433744e-9, 8.575802662240575e-12, 2.5514399306666885e-19, 0.0, 0.3417675547708469, 2.0077203621891698e-13  …  0.0, 0.0, 0.0, 7.936276711843982e-31, 0.0, 0.0, 1.2166896868802381e-5, 1.4846575898504546e-8, 0.5435664032920507, 0.0], biomass_per_patch = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1], relbiomass = [1.0], very_low_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], nan_biomass = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], neg_act_growth = Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0], K_prep = [0.838749897142603, 0.7854193767333942, 0.9138705406040801, 0.9141853476988286, 0.9276708534029915, 0.9189653475692257, 0.7751602020010521, 0.8889703750868472, 0.7817106546184842, 0.8775340077960398  …  0.8567967460097116, 0.9251937124769001, 0.9124351141350084, 0.7883283461330101, 0.7588682017976025, 0.8240785794851352, 0.887683171015272, 0.871842904160094, 0.841036908725253, 0.957403688984086], denominator = [1.860463929535026, 1.3980759093390502, 3.4831287936100934, 3.4959064909700164, 4.147705511741901, 3.702119907977412, 1.3342833549485924, 2.701981567844252, 1.3743226884283988, 2.449659653272289  …  2.094924463241213, 4.010358085306144, 3.4260308460007955, 1.4172894410723216, 1.24413288598375, 1.7053068302995595, 2.671015578981418, 2.340877015305968, 1.8872305363104016, 7.0428634040144855], traitmat = [-3.709527894594842 -3.930661812640988 … -4.352696794577156 -3.950958785413449; -1.999568936648592 -0.8627350668500864 … -1.4551546399042636 -1.158376401820362; … ; 0.757224771215814 0.3737476693015543 … 0.6807337453888618 0.9754271192265664; 0.4005571726076341 0.5407881631143717 … 1.2325361546692288 1.4024296469436566], similarity_matprep = [2.121995791e-314 0.0 … 1.102057375e-315 1.58e-321; 9.1748516e-316 NaN … 1.6763766751e-312 3.16e-322; … ; 0.0 6.93906118339677e-310 … 8.487983164e-314 5.185827937722037e-309; 1.26677135e-315 1.246361263e-315 … 9.85615114e-316 NaN], amc_resid = [2.2263119384049843, 0.47753049952858945, -0.6907292150565266, 0.11979461714776604, -0.8966429234731065, -0.14476800559103187, -0.43171081642978126, -0.9370942448685801, 1.4049725943759488, 0.19120605643012947  …  -0.012395137106643597, -0.7785531246983267, -1.1416964756047157, 1.3848983904899121, -0.6898228516757707, -1.1632115224679171, 1.2941787960996853, 0.5115309786779357, -1.8562739745174106, -0.02719019889281006], rsa_above_resid = [0.4726926856039722, 1.3433641874009443, -0.7243824807962664, -0.7301798990945763, -0.9922545833695969, -0.8198469152482827, 1.5406401250116624, -0.29773088438280254, 1.4128577032005563, -0.116482154094445  …  0.20051194146583587, -0.9418610656153034, -0.6981064829726864, 1.2901212945511236, 1.8956234386840431, 0.6972862763094875, -0.27699094556528114, -0.028373558405659763, 0.43809173286599123, -1.7289362837564288], nutgradient = [0.5;;], biomass_density_factor = [3.215221440297642, 2.104823283837705, 2.1762266931352174, 2.3943168940190986, 2.362812386917633, 2.3937218225865498, 2.002135233934538, 1.903509336740814, 2.575563381936963, 2.007395116239717  …  1.8231632082133558, 2.331226107692363, 2.125786019884206, 2.499875369806832, 2.238187871386477, 1.6647320567175026, 2.5947162549113756, 2.0659895798044423, 1.583707599246369, 3.7522745067619243], TS_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[295.54890143649106 kg ha^-1, 434.3942721812326 kg ha^-1, 421.41870534941404 kg ha^-1, 386.37593976814475 kg ha^-1, 391.05612576127237 kg ha^-1, 386.4632514614807 kg ha^-1, 454.60055231545687 kg ha^-1, 475.96205033123624 kg ha^-1, 361.5786519502105 kg ha^-1, 453.5176313505794 kg ha^-1  …  494.9914758954255 kg ha^-1, 395.8695986452879 kg ha^-1, 430.4986231983471 kg ha^-1, 371.51647495465966 kg ha^-1, 410.8002599223262 kg ha^-1, 537.634082409068 kg ha^-1, 359.1516793954672 kg ha^-1, 441.8102359664574 kg ha^-1, 562.5803828903252 kg ha^-1, 256.8320029431671 kg ha^-1], heightinfluence = [0.8872633366369321, 1.0295225133112427, 1.1520646851574385, 1.0143264322281427, 1.5663544014843302, 1.2836407671213403, 1.0019978027172758, 1.0587236345972963, 0.9652354870554579, 0.8707361663819975  …  0.9495493459790099, 1.3350306514766543, 1.193033496414046, 0.8685389498094929, 0.9303232423416216, 1.0037374605221017, 0.9525420639692308, 0.9512630637891489, 0.9358907171849504, 0.9759117758714582], relative_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.0 m, 0.012683019201683427 m, 1.742505755033202e-21 m, 5.154350943898533e-19 m, 7.88986275147358e-9 m, 7.899197857166622e-12 m, 1.2888375923932223e-19 m, 0.0 m, 0.07695992836750741 m, 1.2337053505936304e-14 m  …  0.0 m, 0.0 m, 0.0 m, 4.3104005745201736e-32 m, 0.0 m, 0.0 m, 3.2447868896387014e-6 m, 2.8626939690247564e-9 m, 0.12587225087964524 m, 0.0 m], nutrients_splitted = [1.8763565463248943, 1.2283443056165775, 1.2700142984780645, 1.3972885729615974, 1.3789030000745548, 1.3969412979142244, 1.1684170507624583, 1.1108604092455745, 1.5030613915428266, 1.1714866417002778  …  1.0639715752931604, 1.3604697061634223, 1.24057785398645, 1.4588909666822787, 1.3061739424057288, 0.9715134557604928, 1.5142387301037254, 1.2056815198228528, 0.924228758886143, 2.1897729176995604], Nutred = [0.9319088951175218, 0.9454945087552988, 0.9803435975888634, 0.9632831622344007, 0.9849809329532562, 0.9678352238119134, 0.9732676954032613, 0.9800255487777236, 0.9128995965230875, 0.9554618245593433  …  0.9599508917886648, 0.9828575162620148, 0.9865612590352719, 0.9134794916581872, 0.9807443446148668, 0.9708199936877242, 0.9524287247248132, 0.9448663600976541, 0.9641558280743033, 0.9820109684597209], amc_nut = [0.8953950373479534, 0.9454945087552988, 0.9803435975888634, 0.9591877282865122, 0.9849809329532562, 0.9678352238119134, 0.9732676954032613, 0.9800255487777236, 0.9128995965230875, 0.9554618245593433  …  0.9599508917886648, 0.9828575162620148, 0.9865612590352719, 0.9134794916581872, 0.9807443446148668, 0.9708199936877242, 0.9162603840279566, 0.9440964307789155, 0.9641558280743033, 0.9645508900873389], rsa_above_nut = [0.9319088951175218, 0.9091373379601937, 0.9624632197854796, 0.9632831622344007, 0.9687977183658342, 0.9652669827765206, 0.9047236237163991, 0.9506096303436191, 0.9077948799779525, 0.9468871000203685  …  0.9373108745637586, 0.9676862032276923, 0.9616187490216557, 0.9105712409677109, 0.898082576364554, 0.9230393504477759, 0.9524287247248132, 0.9448663600976541, 0.9281715026985663, 0.9820109684597209], water_splitted = [3.1946237585572446, 2.0913391487865733, 2.162285126231506, 2.3789781752762624, 2.347675495583177, 2.378386916051429, 1.9893089496130443, 1.891314879769156, 2.5590635433322393, 1.9945351355200975  …  1.8114834728604763, 2.3162915676232636, 2.1121675912008904, 2.4838604115173113, 2.2238493624202738, 1.65406727927557, 2.578093717205123, 2.0527542252156614, 1.573561889003747, 3.7282363005207597], Waterred = [0.8434646137792604, 0.791684743137247, 0.916379101841866, 0.9166899981290269, 0.9297824155636675, 0.92133244384847, 0.7817224537434286, 0.8920854290737784, 0.7880926938946454, 0.8810879160762911  …  0.8608875226883466, 0.9273775687504131, 0.914951976720145, 0.7945146397716449, 0.7659039137456507, 0.8289515764535873, 0.8909665790300111, 0.8755749348760445, 0.8455263793688876, 0.9586491575153805], sla_water = [0.9999999237491897, 0.999990750003823, 0.999995042668663, 0.9999963710919405, 0.999998349802314, 0.999998877518228, 0.9999880838228786, 0.9998804034935342, 0.9999994175397876, 0.999981076307858  …  0.9999200133572257, 0.9999985799549777, 0.9999604792918153, 0.9999966437944776, 0.9999812768612356, 0.9997364795595862, 0.9999995291422795, 0.9999898539703048, 0.9999503598067759, 0.9999999975618307], rsa_above_water = [0.8434646780941256, 0.7916920662858336, 0.9163836446592244, 0.916693324724821, 0.9297839498909901, 0.9213334780285051, 0.7817317689976494, 0.8921921321358781, 0.7880931529275507, 0.8811045898282939  …  0.8609563876993738, 0.9273788856701836, 0.9149881376993275, 0.794517306335016, 0.7659182541394052, 0.8291700797181726, 0.8909669985487011, 0.8755838185754684, 0.8455683535453418, 0.9586491598527295], mown_height = Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(m,), 𝐋, nothing}}[0.05539363389287959 m, 0.3420062870433608 m, 0.5888946623083839 m, 0.3113904124225731 m, 1.4235731522679915 m, 0.8539838525063266 m, 0.28655165476612626 m, 0.4008384203540002 m, 0.21248581891560991 m, 0.02209598500600861 m  …  0.18088260978199916 m, 0.9575201687180647 m, 0.6714354161998551 m, 0.01766920505329246 m, 0.14214736118799354 m, 0.2900565811313098 m, 0.18691210371947742 m, 0.184335274276464 m, 0.1533642736817885 m, 0.2339955698848576 m], mowing_λ = [0.40913026927621865, 0.8104293645469313, 0.8803997034093283, 0.7956005117631081, 0.9467934101647613, 0.9143454142324606, 0.7817497235115661, 0.8336239438996933, 0.7264824657256899, 0.21642364295430622  …  0.6933486671769719, 0.9228930652029194, 0.8935370914448317, 0.18090866044882206, 0.6398786842563503, 0.7838168429394502, 0.7002758627833551, 0.6973540507638444, 0.6571883144843044, 0.745219335325858], biomass_ρ = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1, 43.98960444071411 kg ha^-1, 2.7342125528901985e-17 kg ha^-1, 2.2216411838139937e-14 kg ha^-1, 3.0445312305311687e-6 kg ha^-1, 9.520769755449969e-9 kg ha^-1, 1.1867824669872624e-15 kg ha^-1, 0.0 kg ha^-1, 279.1092180276354 kg ha^-1, 3.212802822648561e-10 kg ha^-1  …  0.0 kg ha^-1, 0.0 kg ha^-1, 0.0 kg ha^-1, 1.5709865743590723e-25 kg ha^-1, 0.0 kg ha^-1, 0.0 kg ha^-1, 0.017029540256343245 kg ha^-1, 1.4033900786604849e-5 kg ha^-1, 5.736850247390549 kg ha^-1, 0.0 kg ha^-1], grazed_share = [0.0, 0.0326866471526969, 2.0316673016972852e-20, 1.650799146718788e-17, 2.262250805456957e-9, 7.074445100725475e-12, 8.818433409125257e-19, 0.0, 0.2073931930674657, 2.387285668290892e-13  …  0.0, 0.0, 0.0, 1.1673277014096614e-28, 0.0, 0.0, 1.265386630793498e-5, 1.0427944716028039e-8, 0.004262788951808832, 0.0], trampling_proportion = [0.0024015583658853613, 0.007485379481778584, 0.011864587174266278, 0.006942327288625826, 0.026669781870296044, 0.01656663367468985, 0.006501747295808482, 0.008528920436199185, 0.005187996991611543, 0.0018109379286508761  …  0.004627431852014983, 0.0184031196247455, 0.013328662200063868, 0.0017324174685398035, 0.003940361436361743, 0.006563916284054843, 0.004734380614606453, 0.004688673840008582, 0.004139322563737865, 0.005569528389381525], trampled_biomass = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[0.0 kg ha^-1, 0.6483340570938464 kg ha^-1, 2.599348175079685e-19 kg ha^-1, 4.4213080149274833e-16 kg ha^-1, 2.5183235208762694e-7 kg ha^-1, 7.433617188158461e-11 kg ha^-1, 6.745331272841191e-17 kg ha^-1, 0.0 kg ha^-1, 1.2954996348274141 kg ha^-1, 6.325037863279699e-12 kg ha^-1  …  0.0 kg ha^-1, 0.0 kg ha^-1, 0.0 kg ha^-1, 7.953167250872547e-28 kg ha^-1, 0.0 kg ha^-1, 0.0 kg ha^-1, 0.00012598164244231435 kg ha^-1, 4.068473195080244e-7 kg ha^-1, 3.678980822979141 kg ha^-1, 0.0 kg ha^-1], clonalgrowth = Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}}[NaN kg ha^-1 NaN kg ha^-1 … NaN kg ha^-1 NaN kg ha^-1], relative_sla = Unitful.Quantity{Float64, 𝐋^2 𝐌^-1, Unitful.FreeUnits{(g^-1, m^2), 𝐋^2 𝐌^-1, nothing}}[0.0 m^2 g^-1, 0.0005899823146290696 m^2 g^-1, 4.619773013965621e-23 m^2 g^-1, 3.0353438729896964e-20 m^2 g^-1, 8.645694503182427e-11 m^2 g^-1, 1.2458322109291893e-13 m^2 g^-1, 6.266082879236873e-21 m^2 g^-1, 0.0 m^2 g^-1, 0.004365375982626286 m^2 g^-1, 2.5644488853855265e-15 m^2 g^-1  …  0.0 m^2 g^-1, 0.0 m^2 g^-1, 0.0 m^2 g^-1, 1.1486769244328082e-32 m^2 g^-1, 0.0 m^2 g^-1, 0.0 m^2 g^-1, 1.9107258592999645e-7 m^2 g^-1, 2.0500338892707366e-10 m^2 g^-1, 0.006942940278472802 m^2 g^-1, 0.0 m^2 g^-1]))</code></pre><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We can look at the simulated biomass:</p><pre><code class="language-julia hljs">sol.o.biomass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5844×1×25 DimArray{Unitful.Quantity{Float64, 𝐌 𝐋^-2, Unitful.FreeUnits{(ha^-1, kg), 𝐌 𝐋^-2, nothing}},3}<span class="sgr33"> biomass</span><span class="sgr90"> with dimensions: </span>
  <span class="sgr31">Dim{</span><span class="sgr33">:time</span><span class="sgr31">}</span> Sampled{Dates.Date} <span class="sgr36">Dates.Date(&quot;2006-01-01&quot;):Dates.Day(1):Dates.Date(&quot;2021-12-31&quot;)</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:patch</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:1</span> ForwardOrdered Regular Points,
  <span class="sgr31">Dim{</span><span class="sgr33">:species</span><span class="sgr31">}</span> Sampled{Int64} <span class="sgr36">1:25</span> ForwardOrdered Regular Points
[:, :, 1]
                                     <span class="sgr90">1</span>
  <span class="sgr90">2006-01-01</span>  59.1499 kg ha^-1
  <span class="sgr90">2006-01-02</span>  58.3012 kg ha^-1
  <span class="sgr90">2006-01-03</span>  57.4647 kg ha^-1
  <span class="sgr90">2006-01-04</span>  56.6402 kg ha^-1
 ⋮                    
  <span class="sgr90">2021-12-27</span>      0.0 kg ha^-1
  <span class="sgr90">2021-12-28</span>      0.0 kg ha^-1
  <span class="sgr90">2021-12-29</span>      0.0 kg ha^-1
  <span class="sgr90">2021-12-30</span>      0.0 kg ha^-1
  <span class="sgr90">2021-12-31</span>      0.0 kg ha^-1
<span class="sgr90">[and 24 more slices...]</span></code></pre><p>The three dimension of the array are: daily time step, patch within site, species.  For plotting the values with <code>Makie.jl</code>, we have to remove the units with <code>ustrip</code>:</p><pre><code class="language-julia hljs"># if we have more than one patch per site, we have to first calculate the mean biomass per site
species_biomass = dropdims(mean(sol.o.biomass; dims = :patch); dims = :patch)
total_biomass = vec(sum(species_biomass; dims = :species))

lines(sol.numeric_date, ustrip.(total_biomass), color = :darkgreen, linewidth = 2;
      axis = (; ylabel = &quot;Aboveground dry biomass [kg ha⁻¹]&quot;,
                xlabel = &quot;Date [year]&quot;))</code></pre><img src="56ffbd85.png" alt="Example block output"/><h2 id="Share-of-each-species"><a class="docs-heading-anchor" href="#Share-of-each-species">Share of each species</a><a id="Share-of-each-species-1"></a><a class="docs-heading-anchor-permalink" href="#Share-of-each-species" title="Permalink"></a></h2><p>We can look at the share of each species over time:</p><pre><code class="language-julia hljs"># colors are assigned according to the specific leaf area (SLA)
color = ustrip.(sol.traits.sla)
colormap = :viridis
colorrange = (minimum(color), maximum(color) + 0.0001)
is = sortperm(color)
cmap = cgrad(colormap)
colors = [cmap[(co .- colorrange[1]) ./ (colorrange[2] - colorrange[1])]
          for co in color[is]]

# calculate biomass proportion of each species
biomass_site = dropdims(mean(sol.o.biomass; dims=2); dims = 2)
biomass_ordered = biomass_site[:, sortperm(color)]
biomass_fraction = biomass_ordered ./ sum(biomass_ordered; dims = 2)
biomass_cumfraction = cumsum(biomass_fraction; dims=2)

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Relative proportion of biomass of the species&quot;,
         xlabel = &quot;Date [year]&quot;,
         limits = (sol.numeric_date[1], sol.numeric_date[end], 0, 1))

    for i in 1:sol.simp.nspecies
        ylower = nothing
        if i == 1
            ylower = zeros(size(biomass_cumfraction, 1))
        else
            ylower = biomass_cumfraction[:, i-1]
        end
        yupper = biomass_cumfraction[:, i]

        band!(sol.numeric_date, ylower, yupper;
              color = colors[i])
    end

    Colorbar(fig[1,2]; limits = colorrange, colormap = cmap, label = &quot;SLA [m² g⁻¹]&quot;)

    fig
end</code></pre><img src="45a365ea.png" alt="Example block output"/><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>Similarly, we plot the soil water content over time:</p><pre><code class="language-julia hljs"># if we have more than one patch per site,
# we have to first calculate the mean soil water content per site
soil_water_per_site = dropdims(mean(sol.o.water; dims = :patch); dims = :patch)

lines(sol.numeric_date, ustrip.(soil_water_per_site), color = :blue, linewidth = 2;
      axis = (; ylabel = &quot;Soil water content [mm]&quot;, xlabel = &quot;Date [year]&quot;))</code></pre><img src="759e8f7e.png" alt="Example block output"/><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We can calculate for all traits the community weighted mean over time:</p><pre><code class="language-julia hljs">relative_biomass = species_biomass ./ total_biomass
traits = [:height, :sla, :lncm, :rsa_above, :amc, :ampm, :lmpm]

begin
    fig = Figure(; resolution = (500, 1000))

    for i in eachindex(traits)
        trait_vals = sol.traits[traits[i]]
        weighted_trait = trait_vals .* relative_biomass&#39;
        cwm_trait = vec(sum(weighted_trait; dims = 1))

        Axis(fig[i, 1];
                xlabel = i == length(traits) ? &quot;Date [year]&quot; : &quot;&quot;,
                xticklabelsvisible = i == length(traits) ? true : false,
                ylabel = string(traits[i]))
        lines!(sol.numeric_date, ustrip.(cwm_trait);
                color = :black, linewidth = 2)

    end

    [rowgap!(fig.layout, i, 5) for i in 1:length(traits)-1]

    fig
end</code></pre><img src="ee2bd988.png" alt="Example block output"/><h2 id="Grazed-and-mown-biomass"><a class="docs-heading-anchor" href="#Grazed-and-mown-biomass">Grazed and mown biomass</a><a id="Grazed-and-mown-biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Grazed-and-mown-biomass" title="Permalink"></a></h2><p>We can look at the grazed and mown biomass over time:</p><pre><code class="language-julia hljs"># total
sum(sol.o.mown)
sum(sol.o.grazed)

# plot the grazed and mown biomass over time
grazed_site = dropdims(mean(sol.o.grazed; dims=:patch); dims=:patch)
cum_grazed = cumsum(grazed_site)

mown_site = dropdims(mean(sol.o.mown; dims=:patch); dims=:patch)
cum_mown = cumsum(mown_site)
begin
      fig = Figure()
      Axis(fig[1,1]; ylabel = &quot;Cummulative grazed\nbiomass [kg ha⁻¹]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_grazed)), color = :black, linewidth = 2;)
      Axis(fig[2,1]; ylabel = &quot;Cummulative mown\nbiomass [kg ha⁻¹]&quot;, xlabel = &quot;Date [year]&quot;)
      lines!(sol.numeric_date, ustrip.(vec(cum_mown)), color = :black, linewidth = 2;)
      fig
end</code></pre><img src="262014ba.png" alt="Example block output"/><h2 id="Shannon-and-Simpson-diversity"><a class="docs-heading-anchor" href="#Shannon-and-Simpson-diversity">Shannon and Simpson diversity</a><a id="Shannon-and-Simpson-diversity-1"></a><a class="docs-heading-anchor-permalink" href="#Shannon-and-Simpson-diversity" title="Permalink"></a></h2><p>We can calculate the Shannon and Simpson diversity over time:</p><pre><code class="language-julia hljs">biomass_site = dropdims(mean(sol.o.biomass; dims = :patch); dims = :patch)
tend = size(biomass_site, 1)
shannon = Array{Float64}(undef, tend)
simpson = Array{Float64}(undef, tend)
for t in 1:tend
    b1 = biomass_site[t, :]
    b1 = b1[.!iszero.(b1)]
    p1 = b1 ./ sum(b1)
    shannon[t] = -sum(p1 .* log.(p1))
    simpson[t] = sum(p1 .^ 2)
end

begin
    fig = Figure()
    Axis(fig[1,1]; ylabel = &quot;Shannon index&quot;)
    lines!(sol.numeric_date, shannon, color = :black, linewidth = 2;)
    Axis(fig[2,1]; ylabel = &quot;Simpson index&quot;, xlabel = &quot;Date [year]&quot;)
    lines!(sol.numeric_date, simpson, color = :black, linewidth = 2;)
    fig
end</code></pre><img src="c75e3dac.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_prepare_input/">« Prepare input and run simulation</a><a class="docs-footer-nextpage" href="../../Modelling_API/main_equations/">Difference equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 21 November 2023 10:56">Tuesday 21 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
