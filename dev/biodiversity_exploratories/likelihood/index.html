<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Likelihood · GrasslandTraitSim.jl</title><meta name="title" content="Likelihood · GrasslandTraitSim.jl"/><meta property="og:title" content="Likelihood · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Likelihood · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:url" content="https://FelixNoessler.github.io/GrasslandTraitSim.jl/biodiversity_exploratories/likelihood/"/><meta property="twitter:url" content="https://FelixNoessler.github.io/GrasslandTraitSim.jl/biodiversity_exploratories/likelihood/"/><link rel="canonical" href="https://FelixNoessler.github.io/GrasslandTraitSim.jl/biodiversity_exploratories/likelihood/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><a class="tocitem" href="../../variables/">Visualize model components</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/how_to_prepare_input/">Prepare input and run simulation</a></li><li><a class="tocitem" href="../../tutorials/how_to_analyse_output/">Analyse model output</a></li><li><a class="tocitem" href="../../tutorials/how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li><li><a class="tocitem" href="../../tutorials/how_to_turnoff_subprocesses/">Turn-off subprocesses</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../../Modelling_API/main_equations/">Difference equation</a></li><li><a class="tocitem" href="../../Modelling_API/initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modelling_API/biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth/">Growth: overview</a></li><li><a class="tocitem" href="../../Modelling_API/growth_potential_growth/">Growth: potential growth</a></li><li><a class="tocitem" href="../../Modelling_API/growth_env_factors/">Growth: community adjustment</a></li><li><a class="tocitem" href="../../Modelling_API/growth_species_specific/">Growth: species-specific adjustment</a></li><li><a class="tocitem" href="../../Modelling_API/senescence/">Senescence</a></li><li><a class="tocitem" href="../../Modelling_API/defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../../Modelling_API/clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../../Modelling_API/water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../time_step/">Time step</a></li><li><a class="tocitem" href="../traits/">Trait data</a></li><li class="is-active"><a class="tocitem" href>Likelihood</a><ul class="internal"><li><a class="tocitem" href="#Soil-water-content"><span>Soil water content</span></a></li><li><a class="tocitem" href="#Biomass"><span>Biomass</span></a></li><li><a class="tocitem" href="#Community-weighted-mean-traits"><span>Community weighted mean traits</span></a></li><li><a class="tocitem" href="#Downweighting-the-likelihood"><span>Downweighting the likelihood</span></a></li></ul></li><li><a class="tocitem" href="../priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References &amp; Acknowledgements</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Calibration to grasslands of the Biodiversity Exploratories</a></li><li class="is-active"><a href>Likelihood</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Likelihood</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/biodiversity_exploratories/likelihood.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Likelihood-calculation-for-the-Biodiversity-Exploratories-data-set"><a class="docs-heading-anchor" href="#Likelihood-calculation-for-the-Biodiversity-Exploratories-data-set">Likelihood calculation for the Biodiversity Exploratories data set</a><a id="Likelihood-calculation-for-the-Biodiversity-Exploratories-data-set-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-calculation-for-the-Biodiversity-Exploratories-data-set" title="Permalink"></a></h1><p>We can compute the probability of observing the data <span>$x$</span>, given the simulation of the model with the parameters <span>$\theta$</span>, by calculating the likelihood function <span>$\mathcal{L}(\theta \mid x)$</span>.</p><h2 id="Soil-water-content"><a class="docs-heading-anchor" href="#Soil-water-content">Soil water content</a><a id="Soil-water-content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-water-content" title="Permalink"></a></h2><p>In the Biodiversity Exploratories, data of the soil moisture <span>$SM_m$</span> is in <span>$\%$</span> available. The model simulates the soil water content <span>$SWC_{sim}$</span> in <span>$mm$</span>. We first transform the measured soil moisture <span>$SM_{m}$</span> to a soil water content <span>$SWC_{m}$</span>. Afterwards, we calculate the likelihood of observing the measured soil water content <span>$SWC_{m}$</span> given the simulated soil water content <span>$SWC_{sim}$</span>.</p><p class="math-container">\[\begin{align}
    SWC_{m} &amp;= \text{moistureconv_alpha} + \text{moistureconv_beta} \cdot \text{rootdepth} \cdot SM_{m} \\
    SWC_{m} &amp;\sim \text{truncated}(\text{Laplace}(\mu = SWC_{sim}, b = \text{b_soilmoisture}); \text{ lower}=0)
\end{align}\]</p><h2 id="Biomass"><a class="docs-heading-anchor" href="#Biomass">Biomass</a><a id="Biomass-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass" title="Permalink"></a></h2><p>We calculate the likelihood of observing the measured biomass <span>$B_{m}$</span> given the simulated biomass <span>$B_{sim}$</span> (both in <span>$\frac{kg}{ha}$</span>): </p><p class="math-container">\[    B_{m} \sim \text{truncated}(\text{Laplace}(\mu = B_{sim}, b = \text{b_biomass}); \text{ lower}=0)\]</p><h2 id="Community-weighted-mean-traits"><a class="docs-heading-anchor" href="#Community-weighted-mean-traits">Community weighted mean traits</a><a id="Community-weighted-mean-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Community-weighted-mean-traits" title="Permalink"></a></h2><p>We can calculate community weighted mean traits from the observed community composition by weighting species mean trait values by their cover. In the same way, we can calculate community weighted mean traits for our simulated plant community. Then, we can calculate the likelihood of observing the measured community weighted mean trait <span>$CWM_{m}$</span> (e.g. <span>$sla_m$</span>) given the simulated community weighted mean trait <span>$CWM_{sim}$</span> (e.g. <span>$sla_{sim}$</span>):</p><p class="math-container">\[    CWM_{m} \sim \text{truncated}(\text{Laplace}(\mu = CWM_{sim}, b = b\_cwm); \text{ lower}=0)\]</p><p>This can be done for all five traits that were part of the simulation model. All the traits have an own variance parameter (e.g. <span>$b\_sla$</span>).</p><h2 id="Downweighting-the-likelihood"><a class="docs-heading-anchor" href="#Downweighting-the-likelihood">Downweighting the likelihood</a><a id="Downweighting-the-likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Downweighting-the-likelihood" title="Permalink"></a></h2><p>In the calibration of the simulation model we want to give each part (biomass, soil water content, community weighted mean traits) an equal influence.</p><p>Measured soil moisture content is available with a daily resolution. The other data is available with a yearly resolution. Therefore, we downweight the likelihood of the soil moisture content by number of measurements per year <span>$n_{SM}$</span>.</p><p>Moreover, we downweight the likelihood of the community weighted mean traits by the number of traits <span>$n_{traits}$</span>.</p><p>In this process, we emulate a scenario where each of the three calibration aspects (biomass, soil water content, and community weighted mean traits) is measured only once per year.</p><p class="math-container">\[    \text{log } \mathcal{L}(\theta \mid x) = \text{log }\mathcal{L}_{B}(\theta \mid x) + \frac{1}{n_{SM}} \cdot \text{log }\mathcal{L}_{SWC}(\theta \mid x) + \frac{1}{n_{traits}}\cdot \text{log }\mathcal{L}_{CWM}(\theta \mid x)\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../traits/">« Trait data</a><a class="docs-footer-nextpage" href="../priors/">Priors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 14 May 2024 20:38">Tuesday 14 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
