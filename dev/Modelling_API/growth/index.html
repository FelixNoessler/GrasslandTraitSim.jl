<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Growth · GrasslandTraitSim.jl</title><meta name="title" content="Growth · GrasslandTraitSim.jl"/><meta property="og:title" content="Growth · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Growth · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/how_to_prepare_input/">Prepare inputs</a></li><li><a class="tocitem" href="../../tutorials/how_to_calculate_likelihood/">Calculate likelihood</a></li></ul></li><li><a class="tocitem" href="../../model_io/">Model inputs and outputs</a></li><li><a class="tocitem" href="../../calibration/">Model calibration for Biodiversity Exploratories</a></li><li><span class="tocitem">Modelling API</span><ul><li><a class="tocitem" href="../main_equations/">Difference equation</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li class="is-active"><a class="tocitem" href>Growth</a><ul class="internal"><li><a class="tocitem" href="#pot_growth"><span>Potential growth</span></a></li><li><a class="tocitem" href="#reducer_functions"><span>Reducer functions</span></a></li><li><a class="tocitem" href="#plant_height"><span>Influence of plant height</span></a></li><li><a class="tocitem" href="#below_competition"><span>Below-ground competition</span></a></li><li><a class="tocitem" href="#Leaf-senescence"><span>Leaf senescence</span></a></li><li><a class="tocitem" href="#Agricultural-defoliation"><span>Agricultural defoliation</span></a></li><li><a class="tocitem" href="#Clonal-growth"><span>Clonal growth</span></a></li></ul></li><li><a class="tocitem" href="../water/">Water dynamics</a></li><li><a class="tocitem" href="../functional_response/">Functional response</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modelling API</a></li><li class="is-active"><a href>Growth</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Growth</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/Modelling_API/growth.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Growth"><a class="docs-heading-anchor" href="#Growth">Growth</a><a id="Growth-1"></a><a class="docs-heading-anchor-permalink" href="#Growth" title="Permalink"></a></h1><p>the net growth of the plants is modelled by...</p><ul><li>the <a href="#pot_growth">potential growth!</a> that is multiplied by some <a href="#reducer_functions">growth reducer functions</a> and a <a href="#below_competition">belowground competition function</a>, these processes are included in the main function <a href="#GrasslandTraitSim.growth!"><code>growth!</code></a></li><li><a href="#Leaf-senescence">Leaf senescence</a></li><li><a href="#Agricultural-defoliation">Agricultural defoliation</a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.growth!" href="#GrasslandTraitSim.growth!"><code>GrasslandTraitSim.growth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">growth!(; t, p, calc, biomass, WR)</code></pre><p>Calculates the actual growth of the plant species.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth.jl#L9-L13">source</a></section></article><hr/><h2 id="pot_growth"><a class="docs-heading-anchor" href="#pot_growth">Potential growth</a><a id="pot_growth-1"></a><a class="docs-heading-anchor-permalink" href="#pot_growth" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.potential_growth!" href="#GrasslandTraitSim.potential_growth!"><code>GrasslandTraitSim.potential_growth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">potential_growth!(; calc, SLA, biomass, PAR, potgrowth_included)</code></pre><p>Calculates the potential growth of all plant species in a specific patch.</p><p>This function is called each time step (day) for each patch. The <code>PAR</code> value is the photosynthetically active radiation of the day.</p><p>First, the leaf area indices of all species are calculated (see <a href="#GrasslandTraitSim.calculate_LAI"><code>calculate_LAI</code></a>). Then, the total leaf area is computed. An inverse exponential function is used to calculate the total primary production:</p><p class="math-container">\[\text{totalgrowth} =
    PAR \cdot RUE_{max} \cdot (1 -  \text{exp}(-\alpha \cdot \text{LAItot}))\]</p><p>This primary production is then multiplied with the share of the leaf area index of the individual species</p><p><img src="../../img/sla_potential_growth.svg" alt="Influence of the specific leaf area on the potential growth"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/potential_growth.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.calculate_LAI" href="#GrasslandTraitSim.calculate_LAI"><code>GrasslandTraitSim.calculate_LAI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_LAI(; SLA, biomass, LAIs)</code></pre><p>Calculate the leaf area index of all species of one habitat patch.</p><p class="math-container">\[\begin{align}
\text{LAI} &amp;= \text{SLA} \cdot \text{biomass} \cdot \text{LAM} \\
\text{LAI}_{\text{tot}} &amp;= \sum \text{LAI}
\end{align}\]</p><ul><li><code>SLA</code> specific leaf area [m² g⁻¹]</li><li><code>LAM</code> Proportion of laminae in green biomass [unitless], the value 0.62 is derived by [<a href="../../References/#Jouven2006">32</a>]</li><li><code>biomass</code> [kg ha⁻¹]</li></ul><p>There is a unit conversion from the <code>SLA</code> and the <code>biomass</code> to the unitless <code>LAI</code> involved.</p><p>The array <code>LAIs</code> is mutated inplace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/potential_growth.jl#L48-L68">source</a></section></article><hr/><h2 id="reducer_functions"><a class="docs-heading-anchor" href="#reducer_functions">Reducer functions</a><a id="reducer_functions-1"></a><a class="docs-heading-anchor-permalink" href="#reducer_functions" title="Permalink"></a></h2><p>The growth of each plant species in each patch is dependent on... </p><ul><li>☀ the photosynthetically active radiation <a href="#GrasslandTraitSim.radiation_reduction"><code>radiation_reduction</code></a></li><li>🌡 the air temperature <a href="#GrasslandTraitSim.temperature_reduction"><code>temperature_reduction</code></a></li><li>💧 the <a href="../functional_response/#water_stress">soil water content</a></li><li>the <a href="../functional_response/#nut_stress">plant-available nutrients</a></li><li>📈 a seasonal effect, that is modelled by the accumulated degree days <a href="#GrasslandTraitSim.seasonal_reduction"><code>seasonal_reduction</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.radiation_reduction" href="#GrasslandTraitSim.radiation_reduction"><code>GrasslandTraitSim.radiation_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">radiation_reduction(; PAR, radiation_red)</code></pre><p>Reduction of radiation use efficiency at light intensities higher than 5 <span>$MJ\cdot m^{-2}\cdot d^{-1}$</span></p><p class="math-container">\[\text{Rred} = \text{min}(1, 1-\gamma_1(\text{PAR}(t) - \gamma_2))\]</p><p>The equations and the parameter values are taken from [<a href="../../References/#Schapendonk1998">33</a>].</p><ul><li><code>γ₁</code> is the empirical parameter for a decrease in RUE for high PAR values, here set to 0.0445 [m² d MJ⁻¹]</li><li><code>γ₂</code> is the threshold value of PAR from which starts a linear decrease in RUE, here set to 5 [MJ m⁻² d⁻¹]</li></ul><p>comment to the equation/figure: PAR values are usually between 0 and 15 <span>$MJ\cdot m^{-2}\cdot d^{-1}$</span> and therefore negative values of Rred are very unlikely <img src="../../img/radiation_reducer.svg" alt="Image of the radiation reducer function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth_reducers.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.temperature_reduction" href="#GrasslandTraitSim.temperature_reduction"><code>GrasslandTraitSim.temperature_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">temperature_reduction(; T, temperature_red)</code></pre><p>Reduction of the potential growth if the temperature is low or too high with a step function.</p><p class="math-container">\[\text{temperature_reduction}(T) =
    \begin{cases}
    0 &amp; \text{if } T &lt; T_0 \\
    \frac{T - T_0}{T_1 - T_0} &amp; \text{if } T_0 &lt; T &lt; T_1 \\
    1 &amp; \text{if } T_1 &lt; T &lt; T_2 \\
    \frac{T_3 - T}{T_3 - T_2} &amp; \text{if } T_2 &lt; T &lt; T_3 \\
    0 &amp; \text{if } T &gt; T_3 \\
    \end{cases}\]</p><p>Equations are taken from [<a href="../../References/#Moulin2021">34</a>] and theses are based on [<a href="../../References/#Schapendonk1998">33</a>]. <code>T₁</code> is in [<a href="../../References/#Moulin2021">34</a>] a species specific parameter, but here it is set to 12°C for all species.</p><ul><li><code>T₀</code> is the lower temperature threshold for growth, here set to 3°C</li><li><code>T₁</code> is the lower bound for the optimal temperature for growth, here set to 12°C</li><li><code>T₂</code> is the upper bound for the optiomal temperature for growth, here set to 20°C</li><li><code>T₃</code> is the maximum temperature for growth, here set to 35°C</li></ul><p><img src="../../img/temperature_reducer.svg" alt="Image of the temperature reducer function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth_reducers.jl#L35-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.water_reduction!" href="#GrasslandTraitSim.water_reduction!"><code>GrasslandTraitSim.water_reduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">water_reduction!(;
    calc,
    fun_response,
    WR,
    water_red,
    PET,
    PWP,
    WHC)</code></pre><p>See for details: <a href="../functional_response/#water_stress">Water stress</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth_reducers.jl#L89-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.nutrient_reduction!" href="#GrasslandTraitSim.nutrient_reduction!"><code>GrasslandTraitSim.nutrient_reduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nutrient_reduction!(;
    calc,
    fun_response,
    nutrient_red,
    nutrients)</code></pre><p>See for details: <a href="../functional_response/#nut_stress">Nutrient stress</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth_reducers.jl#L169-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.seasonal_reduction" href="#GrasslandTraitSim.seasonal_reduction"><code>GrasslandTraitSim.seasonal_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">seasonal_reduction(; ST, season_red)</code></pre><p>Reduction of growth due to seasonal effects. The function is based on the yearly cumulative sum of the daily mean temperatures (<code>ST</code>).</p><p class="math-container">\[\text{seasonal}(ST) =
    \begin{cases}
    SEA_{min} &amp; \text{if } ST &lt; 200 \\
    SEAₘᵢₙ + (SEAₘₐₓ - SEAₘᵢₙ) * \frac{ST - 200}{ST₁ - 400} &amp;
        \text{if } 200 &lt; ST &lt; ST₁ - 200 \\
    SEA_{max} &amp; \text{if } ST₁ - 200 &lt; ST &lt; ST₁ - 100 \\
    SEAₘᵢₙ + (SEAₘᵢₙ - SEAₘₐₓ) * \frac{ST - ST₂}{ST₂ - ST₁ - 100} &amp;
        \text{if } ST₁ - 100 &lt; ST &lt; ST₂ \\
    SEA_{min} &amp; \text{if } ST &gt; ST₂ \\
    \end{cases}\]</p><p>This empirical function was developed by [<a href="../../References/#Jouven2006">32</a>]. In contrast to [<a href="../../References/#Jouven2006">32</a>] <code>SEAₘᵢₙ</code>, <code>SEAₘₐₓ</code>, <code>ST₁</code> and <code>ST₂</code> are not species specific parameters, but are fixed for all species. The values of the parameters are based on [<a href="../../References/#Jouven2006">32</a>] and were chosen to resemble the mean of all functional groups that were described there.</p><p>A seasonal factor greater than one means that growth is increased by the use of already stored resources. A seasonal factor below one means that growth is reduced as the plant stores resources [<a href="../../References/#Jouven2006">32</a>].</p><ul><li><code>ST</code> is the yearly cumulative sum of the daily mean temperatures</li><li><code>SEAₘᵢₙ</code> is the minimum value of the seasonal effect, here set to 0.67 [-]</li><li><code>SEAₘₐₓ</code> is the maximum value of the seasonal effect, here set to 1.33 [-]</li><li><code>ST₁</code> and <code>ST₂</code> are parameters that describe the thresholds of the step function,  here set to 625 and 1300 [°C d]</li></ul><p><img src="../../img/seasonal_reducer.svg" alt="Image of the seasonal effect function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/growth_reducers.jl#L237-L273">source</a></section></article><p>–</p><h2 id="plant_height"><a class="docs-heading-anchor" href="#plant_height">Influence of plant height</a><a id="plant_height-1"></a><a class="docs-heading-anchor-permalink" href="#plant_height" title="Permalink"></a></h2><p>Taller plants get more light and can therefore growth more than smaller plants.  This is modelled by the influence of the potential height in relation to the community  weighted mean potential height.</p><p>The potential height refers to the height that the plant would reach  if it would not be limited by other factors.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.height_influence!" href="#GrasslandTraitSim.height_influence!"><code>GrasslandTraitSim.height_influence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">height_influence!(; container, biomass)</code></pre><p class="math-container">\[\text{heightinfluence} =
    1 +
    \frac{\text{height}\cdot\text{height}_{\text{strength}}}{\text{height}_{\text{cwm}}}
    -\text{height}_{\text{strength}}\]</p><ul><li><code>height_strength</code> lies between 0 (no influence) and 1 (strong influence of the plant height) [-]</li><li><code>cwm_height</code> is community weighted mean height [m]</li></ul><p><img src="../../img/height_influence.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/height_influence.jl#L1-L16">source</a></section></article><p>–</p><h2 id="below_competition"><a class="docs-heading-anchor" href="#below_competition">Below-ground competition</a><a id="below_competition-1"></a><a class="docs-heading-anchor-permalink" href="#below_competition" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.below_ground_competition!" href="#GrasslandTraitSim.below_ground_competition!"><code>GrasslandTraitSim.below_ground_competition!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">below_ground_competition!(; container, biomass)</code></pre><p>Models the below-ground competiton between plants.</p><p>Plant available nutrients and water are reduced if a large biomass of plant species with similar root surface area per above ground biomass (<code>rsa_above</code>) and arbuscular mycorrhizal colonisation (<code>amc</code>) is already present.</p><p>We define for <span>$N$</span> species the trait similarity matrix <span>$TS \in [0,1]^{N \times N}$</span> with trait similarities between the species <span>$i$</span> and <span>$j$</span> (<span>$ts_{i,j}$</span>), where <span>$ts_{i,j} = ts_{j,i}$</span> and <span>$ts_{i,i} = 1$</span>:</p><p class="math-container">\[TS =
\begin{bmatrix}
    ts_{1,1} &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; ts_{2,2} &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; ts_{N,N} \\
\end{bmatrix}
= \begin{bmatrix}
    1 &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; 1 &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; 1 \\
\end{bmatrix}\]</p><p>and the biomass vector <span>$B \in [0\,\text{kg ha⁻¹}, ∞\,\text{kg ha⁻¹}]^N$</span> with the biomass of each plant species <span>$b$</span>:</p><p class="math-container">\[B =
\begin{bmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_N \\
\end{bmatrix}\]</p><p>Then, we multiply the trait similarity matrix <span>$TS$</span> with the biomass vector <span>$B$</span>:</p><p class="math-container">\[TS \cdot B =
\begin{bmatrix}
    1 &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; 1 &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; 1 \\
\end{bmatrix} \cdot
\begin{bmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_N \\
\end{bmatrix} =
\begin{bmatrix}
    1 \cdot b_1 + ts_{1,2} \cdot b_2 + \dots + ts_{1,N} \cdot b_N \\
    ts_{2,1} \cdot b_1 + 1 \cdot b_2 + \dots + ts_{2,N} \cdot b_N \\
    \vdots \\
    ts_{N,1} \cdot b_1 + ts_{N,2} \cdot b_2 + \dots + 1 \cdot b_N \\
\end{bmatrix}\]</p><p>The factors are then calculated as follows:</p><p class="math-container">\[\begin{align}
\text{water_density_factor} &amp;=
    \left(\frac{TS \cdot B}{\text{water_dens}}\right) ^
    {- \text{belowground_density_effect}} \\
\text{nut_density_factor} &amp;=
    \left(\frac{TS \cdot B}{\text{nut_dens}}\right) ^
    {- \text{belowground_density_effect}} \\
\end{align}\]</p><p>The reduction factors control the density and increases the &quot;functional dispersion&quot; of the root surface area per aboveground biomass and the arbuscular mycorrhizal colonisation.</p><p>The <code>TS</code> matrix is computed before the start of the simulation (<a href="../initialization/#Initialization-of-traits">calculation of traits similarity</a>) and includes the traits arbuscular mycorrhizal colonisation rate (<code>amc</code>) and the root surface area devided by the above ground biomass (<code>rsa_above</code>).</p><ul><li><code>water_density_factor</code> is the factor that adjusts the plant available water [-]</li><li><code>nut_density_factor</code> is the factor that adjusts the plant available nutrients [-]</li><li><code>TS</code> is the trait similarity matrix, <span>$TS \in [0,1]^{N \times N}$</span> [-]</li><li><code>B</code> is the biomass vector, <span>$B \in [0, ∞]^{N}$</span> [kg ha⁻¹]</li><li><code>belowground_density_effect</code> is the exponent of the below ground   competition factor [-]</li></ul><p><img src="../../img/below_influence.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/belowground_competition.jl#L1-L93">source</a></section></article><hr/><h2 id="Leaf-senescence"><a class="docs-heading-anchor" href="#Leaf-senescence">Leaf senescence</a><a id="Leaf-senescence-1"></a><a class="docs-heading-anchor-permalink" href="#Leaf-senescence" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.senescence!" href="#GrasslandTraitSim.senescence!"><code>GrasslandTraitSim.senescence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">senescence!(; sen, ST, biomass, μ)</code></pre><p class="math-container">\[\begin{align}
    LL &amp;= 10 ^ { \left(log10(SLA)  - 2.41\right) / -0.38} \cdot\frac{365.25}{12} \\
    μ &amp;= \frac{\text{sen_intercept}}{1000} + \frac{\text{sen_rate}}{1000} \cdot \frac{1}{LL} \\
    \text{senescence} &amp;= μ \cdot \text{SEN} \cdot \text{biomass}
\end{align}\]</p><ul><li>LL leaf life span [<span>$d$</span>]</li><li>SLA specific leaf area [<span>$\frac{cm^2}{g}$</span>] <span>$\rightarrow$</span> this includes a unit conversion of the SLA values (in the model the unit of SLA is <span>$\frac{m^2}{g}$</span>)</li><li>μ leaf senescence rate [<span>$\frac{1}{d}$</span>]</li><li>SEN seasonal component of the senescence (between 1 and 3)</li><li>sen_intercept α value of a linear equation that models the influence of the leaf senescence rate μ on the total senescence rate</li><li>sen_rate β value of a linear equation that models the influence of the leaf senescence rate μ on the total senescence rate</li></ul><p>The parameters <span>$\text{sen_intercept}$</span> and <span>$\text{sen_rate}$</span> were divided by 1000 to avoid very low numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/senescence.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.seasonal_component_senescence" href="#GrasslandTraitSim.seasonal_component_senescence"><code>GrasslandTraitSim.seasonal_component_senescence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">seasonal_component_senescence(;
    ST,
    Ψ₁ = 775,
    Ψ₂ = 3000,
    SENₘᵢₙ = 1,
    SENₘₐₓ = 3)</code></pre><p>Seasonal factor for the senescence rate.</p><p class="math-container">\[\begin{align*}
SEN &amp;=
\begin{cases}
SEN_{min}  &amp; \text{if} \;\; ST &lt; Ψ_1 \\
SEN_{min}+(SEN_{max} - SEN_{min}) \frac{ST - Ψ_1}{Ψ_2 - Ψ_1} &amp; \text{if}\;\; Ψ_1 &lt; ST &lt; Ψ_2 \\
SEN_{max}  &amp; \text{if}\;\; ST &gt; Ψ_2
\end{cases} \\ \\
\end{align*}\]</p><ul><li>ST yearly accumulated degree days [<span>$°C$</span>]</li><li><span>$Ψ₁=775$</span>  [<span>$°C\cdot d$</span>]</li><li><span>$Ψ₂=3000$</span> [<span>$°C\cdot d$</span>]</li><li><span>$SEN_{min}=1$</span></li><li><span>$SEN_{max}=3$</span></li></ul><p><img src="../../img/seasonal_factor_senescence.svg" alt="Seasonal component death rate"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/senescence.jl#L35-L63">source</a></section></article><hr/><h2 id="Agricultural-defoliation"><a class="docs-heading-anchor" href="#Agricultural-defoliation">Agricultural defoliation</a><a id="Agricultural-defoliation-1"></a><a class="docs-heading-anchor-permalink" href="#Agricultural-defoliation" title="Permalink"></a></h2><p>Biomass is removed by...</p><ul><li>🐄 <a href="#GrasslandTraitSim.grazing!"><code>grazing!</code></a> and <a href="#GrasslandTraitSim.trampling!"><code>trampling!</code></a></li><li>🚜 <a href="#GrasslandTraitSim.mowing!"><code>mowing!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.grazing!" href="#GrasslandTraitSim.grazing!"><code>GrasslandTraitSim.grazing!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grazing!(; container, LD, biomass, relbiomass)</code></pre><p class="math-container">\[\begin{align}
μₘₐₓ &amp;= κ \cdot \text{LD} \\
h &amp;= \frac{1}{μₘₐₓ} \\
a &amp;= \frac{1}{\text{grazing_half_factor}^2 \cdot h} \\
\text{totgraz} &amp;= \frac{a \cdot (\sum \text{relbiomass}⋅\text{biomass})^2}
                    {1 + a\cdot h\cdot (\sum \text{relbiomass}⋅\text{biomass})^2} \\
\text{share} &amp;= \frac{
    \rho \cdot \text{biomass}}
    {\sum \left[ \rho \cdot \text{biomass} \right]} \\
\text{graz} &amp;= \text{share} \cdot \text{totgraz}
\end{align}\]</p><p>It is thought that animals consume more in areas with greater biomass, resulting in greater trampling damage (see parameter <code>relbiomass</code>).</p><ul><li><code>LD</code> daily livestock density [livestock units ha⁻¹]</li><li><code>κ</code> daily consumption of one livestock unit [kg d⁻¹], follows [<a href="../../References/#Gillet2008">35</a>]</li><li><code>ρ</code> appetence of the plant species for livestock, dependent on nitrogen per leaf mass (LNCM) [-], initiliazed by the function <a href="../initialization/#GrasslandTraitSim.grazing_parameter!"><code>grazing_parameter!</code></a></li><li><code>relbiomass</code>: relative biomass of the patch in relation to the mean biomass of the whole grassland, is calculated by <a href="#GrasslandTraitSim.calculate_relbiomass!"><code>calculate_relbiomass!</code></a> [-]</li><li><code>grazing_half_factor</code> is the half-saturation constant [kg ha⁻¹]</li><li>equation partly based on [<a href="../../References/#Moulin2021">34</a>]</li></ul><p>Influence of grazing (livestock density = 2), all plant species have an equal amount of biomass (total biomass / 3) and a leaf nitrogen content of 15, 30 and 40 mg/g:</p><ul><li><code>leafnitrogen_graz_exp</code> = 1.5</li></ul><p><img src="../../img/grazing_1_5.svg" alt/></p><ul><li><code>leafnitrogen_graz_exp</code> = 5</li></ul><p><img src="../../img/grazing_5.svg" alt/></p><p>Influence of <code>grazing_half_factor</code>: <img src="../../img/grazing_half_factor.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/defoliation.jl#L74-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.mowing!" href="#GrasslandTraitSim.mowing!"><code>GrasslandTraitSim.mowing!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mowing!(;
    calc,
    mowing_height,
    days_since_last_mowing,
    height,
    biomass,
    mowing_mid_days)</code></pre><p class="math-container">\[\begin{align}
    \lambda &amp;= \frac{\text{mown_height}}{\text{height}}\\
    \text{mow_factor} &amp;= \frac{1}{1+exp(-0.1*(\text{days_since_last_mowing}
        - \text{mowing_mid_days})}\\
    \text{mow} &amp;= \lambda \cdot \text{biomass}
\end{align}\]</p><p>The mow_factor has been included to account for the fact that less biomass is mown when the last mowing event was not long ago. Influence of mowing for plant species with different heights (<span>$height$</span>): <img src="../../img/mowing.svg" alt="Image of mowing effect"/></p><p>Visualisation of the <code>mow_factor</code>: <img src="../../img/mow_factor.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/defoliation.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.trampling!" href="#GrasslandTraitSim.trampling!"><code>GrasslandTraitSim.trampling!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">trampling!(; calc, LD, biomass, relbiomass, height, trampling_factor)</code></pre><p class="math-container">\[\begin{align}
\text{trampled_proportion} &amp;=
    \text{height} \cdot \text{LD} \cdot \text{trampling_factor}  \\
\text{trampled_biomass} &amp;=
    \min(\text{relbiomass} ⋅ \text{biomass} ⋅ \text{trampled_proportion},
        \text{biomass}) \\
\end{align}\]</p><p>It is assumed that tall plants (trait: <code>height</code>) are stronger affected by trampling. A linear function is used to model the influence of trampling.</p><p>It is thought that animals consume more in areas with greater biomass, resulting in greater trampling damage (see parameter <code>relbiomass</code>).</p><p>Maximal the whole biomass of a plant species is removed by trampling.</p><ul><li><code>biomass</code> [<span>$\frac{kg}{ha}$</span>]</li><li><code>relbiomass</code>: relative biomass of the patch in relation to the mean biomass of the whole grassland, is calculated by <a href="#GrasslandTraitSim.calculate_relbiomass!"><code>calculate_relbiomass!</code></a> [-]</li><li><code>LD</code> daily livestock density [<span>$\frac{\text{livestock units}}{ha}$</span>]</li><li><code>trampling_factor</code> [ha m⁻¹]</li><li>height canopy height [<span>$m$</span>]</li></ul><p><img src="../../img/trampling.svg" alt="Image of trampling effect"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/defoliation.jl#L146-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.calculate_relbiomass!" href="#GrasslandTraitSim.calculate_relbiomass!"><code>GrasslandTraitSim.calculate_relbiomass!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_relbiomass!(; calc, p)</code></pre><p>Relative biomass of the patches in relation to the mean biomass of the overall grassland.</p><p class="math-container">\[\text{relbiomass} = \frac{\text{patch_biomass}}{\text{mpatch_biomass}}\]</p><ul><li><code>relbiomass</code> relative biomass of each patch [-]</li><li><code>patch_biomass</code> sum of the biomass of all species in one patch [kg ha⁻¹]</li><li><code>mpatch_biomass</code> mean of the sum of the biomass of all species in all patches [kg ha⁻¹]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/defoliation.jl#L190-L202">source</a></section></article><hr/><h2 id="Clonal-growth"><a class="docs-heading-anchor" href="#Clonal-growth">Clonal growth</a><a id="Clonal-growth-1"></a><a class="docs-heading-anchor-permalink" href="#Clonal-growth" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.clonalgrowth!" href="#GrasslandTraitSim.clonalgrowth!"><code>GrasslandTraitSim.clonalgrowth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">clonalgrowth!(; container)</code></pre><p>Yearly clonal growth.</p><p class="math-container">\[\begin{align}
\text{growth_factor} &amp;= \frac{0.05}{\text{nneighbours}} \\
\text{crowded_factor} &amp;=
    \min(\frac{\text{msurrounded_biomass}}{\text{biomass_target}}, 2.0) \\
\text{clonalgrowth} &amp;=
    \text{growth_factor} \cdot \text{crowded_factor} \cdot \text{biomass} \\
\end{align}\]</p><p>The biomass is transferred from the home patch to the neighbour (target) patches. This is done for all patches once per year.</p><ul><li><code>clonalgrowth</code>: biomass that is transferred from the home to the target patch [kg ha⁻¹]</li><li><code>nneighbours</code>: number of neighbour patches of the home patch. For a grid this  value lies between 2 (edge) and 4 (middle).</li><li><code>msurrounded_biomass</code>: mean biomass of the home and the  (upto 4) neighbour patches [kg ha⁻¹]</li><li><code>biomass_target</code>: biomass of the target patch [kg ha⁻¹]</li><li><code>growth_factor</code>: proportion of biomass that is transferred from the home  patch to one neighbour patch. This factor is modified by the <code>crowded_factor</code> [-]</li><li><code>crowded_factor</code>: factor to adapth clonal growth based on the biomass distribution   of the patches in the direct surroundings. The value lies between 0   (no clonal growth due to high surrounded biomass) and   2 (high clonal growth due to high own biomass).</li></ul><p><img src="../../img/clonalgrowth.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4dd0062d0c760ac492cf1e5df89bc93970c7f94a/src/growth/clonalgrowth.jl#L1-L33">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../initialization/">« Initialization</a><a class="docs-footer-nextpage" href="../water/">Water dynamics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Wednesday 1 November 2023 15:26">Wednesday 1 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
