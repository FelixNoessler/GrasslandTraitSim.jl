<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Growth · GrasslandTraitSim.jl</title><meta name="title" content="Growth · GrasslandTraitSim.jl"/><meta property="og:title" content="Growth · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Growth · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/how_to_prepare_input/">Prepare input and run simulation</a></li><li><a class="tocitem" href="../../tutorials/how_to_analyse_output/">Analyse model output</a></li><li><a class="tocitem" href="../../tutorials/how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../main_equations/">Difference equation</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox" checked/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../biomass_dynamic/">Overview</a></li><li class="is-active"><a class="tocitem" href>Growth</a><ul class="internal"><li><a class="tocitem" href="#Potential-growth"><span>Potential growth</span></a></li><li><a class="tocitem" href="#Adjustment-by-environmental-factors"><span>Adjustment by environmental factors</span></a></li><li><a class="tocitem" href="#Species-specific-adjustment"><span>Species-specific adjustment</span></a></li></ul></li><li><a class="tocitem" href="../senescence/">Senescence</a></li><li><a class="tocitem" href="../defoliation/">Mowing, grazing, and trampling</a></li><li><a class="tocitem" href="../clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../water/">Water dynamics</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model description</a></li><li><a class="is-disabled">Biomass dynamic</a></li><li class="is-active"><a href>Growth</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Growth</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/Modelling_API/growth.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Growth"><a class="docs-heading-anchor" href="#Growth">Growth</a><a id="Growth-1"></a><a class="docs-heading-anchor-permalink" href="#Growth" title="Permalink"></a></h1><div class="mermaid">
flowchart LR
    A[[potential growth]] ==> D(actual growth)
    B[[adjustment by environmental factors]] ==> D
    C[[species-specific adjustment]] ==> D
    subgraph " "
    L[↓ radiation] -.-> B
    M[↓ temperature] -.-> B
    N[⇅ seasonal factor] -.-> B
    end
    subgraph " "
    F[⇅ height influence] -.-> C
    G[below ground competition] -.-> H
    G -.-> I
    H[↓ water stress] -.-> C
    I[↓ nutrient stress] -.-> C
    end;
</div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.growth!" href="#GrasslandTraitSim.growth!"><code>GrasslandTraitSim.growth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">growth!(; t, container, biomass, water, nutrients, WHC, PWP)</code></pre><p>Calculates the actual growth of the plant species.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/growth.jl#L9-L13">source</a></section></article><hr/><h2 id="Potential-growth"><a class="docs-heading-anchor" href="#Potential-growth">Potential growth</a><a id="Potential-growth-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-growth" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.potential_growth!" href="#GrasslandTraitSim.potential_growth!"><code>GrasslandTraitSim.potential_growth!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">potential_growth!(; container, biomass, PAR)</code></pre><p>Calculates the potential growth of all plant species in a specific patch.</p><p>This function is called each time step (day) for each patch. The <code>PAR</code> value is the photosynthetically active radiation of the day.</p><p>First, the leaf area indices of all species are calculated (see <a href="#GrasslandTraitSim.calculate_LAI"><code>calculate_LAI</code></a>). Then, the total leaf area is computed. An inverse exponential function is used to calculate the total primary production:</p><p>This primary production is then multiplied with the share of the leaf area index of the individual species</p><p class="math-container">\[\begin{align*}
\text{potgrowth_total} &amp;=
    PAR \cdot RUE_{max} \cdot (1 -  \text{exp}(-k \cdot \text{LAItot})) \\
\text{potgrowth} &amp;= \text{potgrowth_total} \cdot \frac{\text{LAI}}{\text{LAItot}}
\end{align*}\]</p><ul><li><code>PAR</code> photosynthetically active radiation [MJ ha⁻¹ d⁻¹]</li><li><code>RUE_max</code> maximum radiation use efficiency [kg MJ⁻¹]</li><li><code>k</code> extinction coefficient [-]</li><li><code>LAItot</code> total leaf area index [m² m⁻²]</li><li><code>LAIs</code> leaf area index of each species [m² m⁻²]</li><li><code>potgrowth_total</code> total potential growth [kg ha⁻¹ d⁻¹]</li><li><code>potgrowth</code> potential growth of each species [kg ha⁻¹ d⁻¹]</li></ul><p><img src="../../img/sla_potential_growth.svg" alt="Influence of the specific leaf area on the potential growth"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/potential_growth.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.calculate_LAI" href="#GrasslandTraitSim.calculate_LAI"><code>GrasslandTraitSim.calculate_LAI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_LAI(; container, biomass, LAIs)</code></pre><p>Calculate the leaf area index of all species of one habitat patch.</p><p class="math-container">\[\begin{align}
\text{LAI} &amp;= \text{SLA} \cdot \text{biomass} \cdot \text{LAM} \\
\text{LAI}_{\text{tot}} &amp;= \sum \text{LAI}
\end{align}\]</p><ul><li><code>SLA</code> specific leaf area [m² g⁻¹]</li><li><code>LAM</code> Proportion of laminae in green biomass [unitless], the value 0.62 is derived by [<a href="../../References/#Jouven2006">8</a>]</li><li><code>biomass</code> [kg ha⁻¹]</li></ul><p>There is a unit conversion from the <code>SLA</code> and the <code>biomass</code> to the unitless <code>LAI</code> involved.</p><p>The array <code>LAIs</code> is mutated inplace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/potential_growth.jl#L59-L79">source</a></section></article><hr/><h2 id="Adjustment-by-environmental-factors"><a class="docs-heading-anchor" href="#Adjustment-by-environmental-factors">Adjustment by environmental factors</a><a id="Adjustment-by-environmental-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Adjustment-by-environmental-factors" title="Permalink"></a></h2><p>The listed functions limit the growth potential of all  plant species without any species-specific reduction:</p><ul><li>☀ the photosynthetically active radiation <a href="#GrasslandTraitSim.radiation_reduction"><code>radiation_reduction</code></a></li><li>🌡 the air temperature <a href="#GrasslandTraitSim.temperature_reduction"><code>temperature_reduction</code></a></li><li>📈 a seasonal effect, that is modelled by the accumulated degree days <a href="#GrasslandTraitSim.seasonal_reduction"><code>seasonal_reduction</code></a></li><li>an effect that a smaller plant community can build up less biomass <a href="#GrasslandTraitSim.community_height_reduction"><code>community_height_reduction</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.radiation_reduction" href="#GrasslandTraitSim.radiation_reduction"><code>GrasslandTraitSim.radiation_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">radiation_reduction(; PAR, radiation_red)</code></pre><p>Reduction of radiation use efficiency at light intensities higher than 5 <span>$MJ\cdot m^{-2}\cdot d^{-1}$</span></p><p class="math-container">\[\text{Rred} = \text{min}(1, 1-\gamma_1(\text{PAR}(t) - \gamma_2))\]</p><p>The equations and the parameter values are taken from [<a href="../../References/#Schapendonk1998">9</a>].</p><ul><li><code>γ₁</code> is the empirical parameter for a decrease in RUE for high PAR values, here set to 0.0445 [m² d MJ⁻¹]</li><li><code>γ₂</code> is the threshold value of PAR from which starts a linear decrease in RUE, here set to 5 [MJ m⁻² d⁻¹]</li></ul><p>comment to the equation/figure: PAR values are usually between 0 and 15 <span>$MJ\cdot m^{-2}\cdot d^{-1}$</span> and therefore negative values of Rred are very unlikely <img src="../../img/radiation_reducer.svg" alt="Image of the radiation reducer function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/growth_reducers.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.temperature_reduction" href="#GrasslandTraitSim.temperature_reduction"><code>GrasslandTraitSim.temperature_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">temperature_reduction(; T, temperature_growth_reduction)</code></pre><p>Reduction of the potential growth if the temperature is low or too high with a step function.</p><p class="math-container">\[\text{temperature_reduction}(T) =
    \begin{cases}
    0 &amp; \text{if } T &lt; T_0 \\
    \frac{T - T_0}{T_1 - T_0} &amp; \text{if } T_0 &lt; T &lt; T_1 \\
    1 &amp; \text{if } T_1 &lt; T &lt; T_2 \\
    \frac{T_3 - T}{T_3 - T_2} &amp; \text{if } T_2 &lt; T &lt; T_3 \\
    0 &amp; \text{if } T &gt; T_3 \\
    \end{cases}\]</p><p>Equations are taken from [<a href="../../References/#Moulin2021">10</a>] and theses are based on [<a href="../../References/#Schapendonk1998">9</a>]. <code>T₁</code> is in [<a href="../../References/#Moulin2021">10</a>] a species specific parameter, but here it is set to 12°C for all species.</p><ul><li><code>T₀</code> is the lower temperature threshold for growth, here set to 3°C</li><li><code>T₁</code> is the lower bound for the optimal temperature for growth, here set to 12°C</li><li><code>T₂</code> is the upper bound for the optiomal temperature for growth, here set to 20°C</li><li><code>T₃</code> is the maximum temperature for growth, here set to 35°C</li></ul><p><img src="../../img/temperature_reducer.svg" alt="Image of the temperature reducer function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/growth_reducers.jl#L36-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.seasonal_reduction" href="#GrasslandTraitSim.seasonal_reduction"><code>GrasslandTraitSim.seasonal_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">seasonal_reduction(; ST, season_red)</code></pre><p>Reduction of growth due to seasonal effects. The function is based on the yearly cumulative sum of the daily mean temperatures (<code>ST</code>).</p><p class="math-container">\[\text{seasonal}(ST) =
    \begin{cases}
    SEA_{min} &amp; \text{if } ST &lt; 200 \\
    SEAₘᵢₙ + (SEAₘₐₓ - SEAₘᵢₙ) * \frac{ST - 200}{ST₁ - 400} &amp;
        \text{if } 200 &lt; ST &lt; ST₁ - 200 \\
    SEA_{max} &amp; \text{if } ST₁ - 200 &lt; ST &lt; ST₁ - 100 \\
    SEAₘᵢₙ + (SEAₘᵢₙ - SEAₘₐₓ) * \frac{ST - ST₂}{ST₂ - ST₁ - 100} &amp;
        \text{if } ST₁ - 100 &lt; ST &lt; ST₂ \\
    SEA_{min} &amp; \text{if } ST &gt; ST₂ \\
    \end{cases}\]</p><p>This empirical function was developed by [<a href="../../References/#Jouven2006">8</a>]. In contrast to [<a href="../../References/#Jouven2006">8</a>] <code>SEAₘᵢₙ</code>, <code>SEAₘₐₓ</code>, <code>ST₁</code> and <code>ST₂</code> are not species specific parameters, but are fixed for all species. The values of the parameters are based on [<a href="../../References/#Jouven2006">8</a>] and were chosen to resemble the mean of all functional groups that were described there.</p><p>A seasonal factor greater than one means that growth is increased by the use of already stored resources. A seasonal factor below one means that growth is reduced as the plant stores resources [<a href="../../References/#Jouven2006">8</a>].</p><ul><li><code>ST</code> is the yearly cumulative sum of the daily mean temperatures</li><li><code>SEAₘᵢₙ</code> is the minimum value of the seasonal effect, here set to 0.67 [-]</li><li><code>SEAₘₐₓ</code> is the maximum value of the seasonal effect, here set to 1.33 [-]</li><li><code>ST₁</code> and <code>ST₂</code> are parameters that describe the thresholds of the step function,  here set to 625 and 1300 [°C d]</li></ul><p><img src="../../img/seasonal_reducer.svg" alt="Image of the seasonal effect function"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/growth_reducers.jl#L88-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.community_height_reduction" href="#GrasslandTraitSim.community_height_reduction"><code>GrasslandTraitSim.community_height_reduction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">community_height_reduction(; container, biomass)</code></pre><p>Only one species is used for the simulation: <img src="../../img/community_height.svg" alt="Image of the community height reducer fucntion"/> <img src="../../img/community_height_influence.svg" alt="Image of the effect of the community height reduction"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/growth_reducers.jl#L150-L156">source</a></section></article><p>–</p><h2 id="Species-specific-adjustment"><a class="docs-heading-anchor" href="#Species-specific-adjustment">Species-specific adjustment</a><a id="Species-specific-adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Species-specific-adjustment" title="Permalink"></a></h2><div class="mermaid">
flowchart LR
    F[⇅ height influence] --> C[[species-specific adjustment]]
    G[below ground competition] --> H
    G --> I
    H[↓ water stress] -->  C
    I[↓ nutrient stress] --> C;
</div><h3 id="plant_height"><a class="docs-heading-anchor" href="#plant_height">Influence of plant height</a><a id="plant_height-1"></a><a class="docs-heading-anchor-permalink" href="#plant_height" title="Permalink"></a></h3><div class="mermaid">
flowchart LR
    K(trait: height) -->|taller plants get\nmore light| F
    F[⇅ height influence] --> C[[species-specific adjustment]]
</div><p>Taller plants get more light and can therefore growth more than smaller plants.  This is modelled by the influence of the potential height in relation to the community  weighted mean potential height.</p><p>The potential height refers to the height that the plant would reach  if it would not be limited by other factors.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.height_influence!" href="#GrasslandTraitSim.height_influence!"><code>GrasslandTraitSim.height_influence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">height_influence!(; container, biomass)</code></pre><p class="math-container">\[\text{heightinfluence} =
    1 +
    \frac{\text{height}\cdot\text{height}_{\text{strength}}}{\text{height}_{\text{cwm}}}
    -\text{height}_{\text{strength}}\]</p><ul><li><code>height_strength_exp</code> lies between 0 (no influence) and 1 (strong influence of the plant height) [-]</li><li><code>cwm_height</code> is community weighted mean height [m]</li></ul><p><img src="../../img/height_influence.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/height_influence.jl#L1-L16">source</a></section></article><p>–</p><h3 id="below_competition"><a class="docs-heading-anchor" href="#below_competition">Below-ground competition</a><a id="below_competition-1"></a><a class="docs-heading-anchor-permalink" href="#below_competition" title="Permalink"></a></h3><div class="mermaid">
flowchart LR
    B[biomass] 
    T[trait similarity of\n root surface area / aboveground biomass\nand arbuscular mycorrhizal colonisation]
    X["biomass · trait similarity"]
    E[below ground competition]

    T -->|species with similar\ntraits compete more\nstrongly for the same resources| X
    B --> X
    X --> E;
</div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.below_ground_competition!" href="#GrasslandTraitSim.below_ground_competition!"><code>GrasslandTraitSim.below_ground_competition!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">below_ground_competition!(; container, biomass)</code></pre><p>Models the below-ground competiton between plants.</p><p>Plant available nutrients and water are reduced if a large biomass of plant species with similar root surface area per above ground biomass (<code>rsa_above</code>) and arbuscular mycorrhizal colonisation (<code>amc</code>) is already present.</p><p>We define for <span>$N$</span> species the trait similarity matrix <span>$TS \in [0,1]^{N \times N}$</span> with trait similarities between the species <span>$i$</span> and <span>$j$</span> (<span>$ts_{i,j}$</span>), where <span>$ts_{i,j} = ts_{j,i}$</span> and <span>$ts_{i,i} = 1$</span>:</p><p class="math-container">\[TS =
\begin{bmatrix}
    ts_{1,1} &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; ts_{2,2} &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; ts_{N,N} \\
\end{bmatrix}
= \begin{bmatrix}
    1 &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; 1 &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; 1 \\
\end{bmatrix}\]</p><p>and the biomass vector <span>$B \in [0\,\text{kg ha⁻¹}, ∞\,\text{kg ha⁻¹}]^N$</span> with the biomass of each plant species <span>$b$</span>:</p><p class="math-container">\[B =
\begin{bmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_N \\
\end{bmatrix}\]</p><p>Then, we multiply the trait similarity matrix <span>$TS$</span> with the biomass vector <span>$B$</span>:</p><p class="math-container">\[TS \cdot B =
\begin{bmatrix}
    1 &amp; ts_{1,2} &amp; \dots &amp;  &amp; ts_{1,N} \\
    ts_{2,1} &amp; 1 &amp;  &amp; \\
    \vdots &amp;  &amp; \ddots &amp;  &amp; \\
    ts_{N,1} &amp; &amp; &amp; &amp; 1 \\
\end{bmatrix} \cdot
\begin{bmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_N \\
\end{bmatrix} =
\begin{bmatrix}
    1 \cdot b_1 + ts_{1,2} \cdot b_2 + \dots + ts_{1,N} \cdot b_N \\
    ts_{2,1} \cdot b_1 + 1 \cdot b_2 + \dots + ts_{2,N} \cdot b_N \\
    \vdots \\
    ts_{N,1} \cdot b_1 + ts_{N,2} \cdot b_2 + \dots + 1 \cdot b_N \\
\end{bmatrix}\]</p><p>The factors are then calculated as follows:</p><p class="math-container">\[\text{biomass_density_factor} =
    \left(\frac{TS \cdot B}{\text{biomass_dens}}\right) ^
    {- \text{belowground_density_effect}} \\\]</p><p>The reduction factors control the density and increases the &quot;functional dispersion&quot; of the root surface area per aboveground biomass and the arbuscular mycorrhizal colonisation.</p><p>The <code>TS</code> matrix is computed before the start of the simulation (<a href="../initialization/#GrasslandTraitSim.similarity_matrix!">calculation of trait similarity</a>) and includes the traits arbuscular mycorrhizal colonisation rate (<code>amc</code>) and the root surface area devided by the above ground biomass (<code>rsa_above</code>).</p><ul><li><code>biomass_density_factor</code> is the factor that adjusts the plant available nutrients and soil water [-]</li><li><code>TS</code> is the trait similarity matrix, <span>$TS \in [0,1]^{N \times N}$</span> [-]</li><li><code>B</code> is the biomass vector, <span>$B \in [0, ∞]^{N}$</span> [kg ha⁻¹]</li><li><code>belowground_density_effect</code> is the exponent of the below ground competition factor [-]</li></ul><p><img src="../../img/below_influence.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/belowground_competition.jl#L1-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.init_transfer_functions!" href="#GrasslandTraitSim.init_transfer_functions!"><code>GrasslandTraitSim.init_transfer_functions!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">init_transfer_functions!(; calc, p)</code></pre><p>Initialisation of the transfer functions that link the traits to the response to water and nutrient stress.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/initialisation/transferfunctions_init.jl#L1-L6">source</a></section></article><hr/><h3 id="Water-stress"><a class="docs-heading-anchor" href="#Water-stress">Water stress</a><a id="Water-stress-1"></a><a class="docs-heading-anchor-permalink" href="#Water-stress" title="Permalink"></a></h3><div class="mermaid">
flowchart LR
    W[↓ water stress] 
    E["below ground competition factor D [-]"]
    A["soil water content W [mm]"]
    K["water holding capacity WHC [mm]"]
    L["permanent wilting point PWP [mm]"]
    P["scaled soil water content Wsc [-]"]
    M["plant available water Wp [-]"]
    H["potential evapotranspiration PET [mm]"]
    R[trait: root surface area /\n aboveground biomass]
    S[trait: specific leaf area]

    A --> P
    K --> P
    L --> P
    P --> M
    E --> M
    H --> M
    M --> W
    R ---> W
    S ---> W;
</div><p>The species differ in the response to water stress by the different <a href="#Specific-leaf-area-linked-to-water-stress">specific leaf areas</a> and <a href="#Root-surface-area-/-aboveground-biomass-linked-to-water-stress">root surface areas per above ground biomass</a>. The values of both response curves are multiplied to get factor that reduces the plant available water.</p><p>It is implemented in <a href="#GrasslandTraitSim.water_reduction!"><code>water_reduction!</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.water_reduction!" href="#GrasslandTraitSim.water_reduction!"><code>GrasslandTraitSim.water_reduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">water_reduction!(; container, water, water_growth_reduction, PET, PWP, WHC)</code></pre><p>Reduction of growth based on the plant available water and the traits specific leaf area and root surface area per aboveground biomass.</p><p>Derives the plant available water.</p><p>The plant availabe water is dependent on the soil water content, the water holding capacity (<code>WHC</code>), the permanent wilting point (<code>PWP</code>), the potential evaporation (<code>PET</code>) and a belowground competition factor:</p><p class="math-container">\[\begin{align*}
    W_{sc, txy} &amp;= \frac{W_{txy} - PWP_{xy}}{WHC_{xy}-PWP_{xy}} \\
    W_{p, txys} &amp;= D_{txys} \cdot 1 \bigg/ \left(1 + \frac{\text{exp}\left(\beta_{pet} \cdot \left(PET_{txy} - \alpha_{pet} \right) \right)}{ 1 / (1-W_{sc, txy}) - 1}\right)
\end{align*}\]</p><ul><li><span>$W_{sc, txy}$</span> is the scaled soil water content <span>$\in [0, 1]$</span> [-]</li><li><span>$W_{txy}$</span> is the soil water content [mm]</li><li><span>$PWP_{xy}$</span> is the permanent wilting point [mm]</li><li><span>$WHC_{xy}$</span> is the water holding capacity [mm]</li><li><span>$W_{p, txys}$</span> is the plant available water [-]</li><li><span>$D_{txys}$</span> is the belowground competition factor [-], in the programming code is is called <code>biomass_density_factor</code></li><li><span>$PET_{txy}$</span> is the potential evapotranspiration [mm]</li><li><span>$β_{pet}$</span> is a parameter that defines the steepness of the reduction function</li><li><span>$α_{pet}$</span> is a parameter that defines the midpoint of the reduction function</li></ul><p><img src="../../img/pet.svg" alt/></p><p>Derive the water stress based on the specific leaf area and the plant availabe water.</p><p>It is assumed, that plants with a higher specific leaf area have a higher transpiration per biomass and are therefore more sensitive to water stress. A transfer function is used to link the specific leaf area to the water stress reduction.</p><p><strong>Initialization:</strong></p><p>The specicies-specifc parameter <code>H_sla</code> is initialized and later used in the reduction function.</p><p class="math-container">\[\text{H_sla} = \text{min_sla_mid} +
    \frac{\text{max_sla_mid} - \text{min_sla_mid}}
    {1 + exp(-\text{β_sla_mid} \cdot (sla - \text{mid_sla}))}\]</p><ul><li><code>sla</code> is the specific leaf area of the species [m² g⁻¹]</li><li><code>min_sla_mid</code> is the minimum of <code>H_sla</code> that can be reached with a very low specific leaf area [-]</li><li><code>max_sla_mid</code> is the maximum of <code>H_sla</code> that can be reached with a very high specific leaf area [-]</li><li><code>mid_sla</code> is a mean specific leaf area [m² g⁻¹]</li><li><code>β_sla_mid</code> is a parameter that defines the steepness of function that relate the <code>sla</code> to <code>H_sla</code></li></ul><p><strong>Reduction factor based on the plant availabe water:</strong></p><p class="math-container">\[\text{W_sla} = 1 - \text{δ_sla} +
    \frac{\text{δ_sla}}
    {1 + exp(-\text{k_sla} \cdot
        (\text{Wp} - \text{H_sla}))}\]</p><ul><li><code>W_sla</code> is the reduction factor for the growth based on the specific leaf area [-]</li><li><code>H_sla</code> is the value of the plant available water at which the reduction factor is in the middle between 1 - <code>δ_sla</code> and 1 [-]</li><li><code>δ_sla</code> is the maximal reduction of the growth based on the specific leaf area</li><li><code>Wp</code> is the plant available water [-]</li><li><code>k_sla</code> is a parameter that defines the steepness of the reduction function</li></ul><p><strong>Overview over the parameters:</strong></p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Value</th></tr><tr><td style="text-align: right"><code>min_sla_mid</code></td><td style="text-align: right">fixed</td><td style="text-align: right">-0.8 [-]</td></tr><tr><td style="text-align: right"><code>max_sla_mid</code></td><td style="text-align: right">fixed</td><td style="text-align: right">0.8  [-]</td></tr><tr><td style="text-align: right"><code>mid_sla</code></td><td style="text-align: right">fixed</td><td style="text-align: right">0.025 [m² g⁻¹]</td></tr><tr><td style="text-align: right"><code>β_sla_mid</code></td><td style="text-align: right">fixed</td><td style="text-align: right">75 [g m⁻²]</td></tr><tr><td style="text-align: right"><code>k_sla</code></td><td style="text-align: right">fixed</td><td style="text-align: right">5 [-]</td></tr><tr><td style="text-align: right"><code>δ_sla</code></td><td style="text-align: right">calibrated</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><code>H_sla</code></td><td style="text-align: right">species-specific, derived</td><td style="text-align: right">-</td></tr></table><p><strong>Influence of the <code>δ_sla</code>:</strong></p><p><code>δ_sla</code> equals 1: <img src="../../img/W_sla_response.svg" alt/></p><p><code>δ_sla</code> equals 0.5: <img src="../../img/W_sla_response_0_5.svg" alt/></p><p>Reduction of growth due to stronger water stress for lower specific root surface area per above ground biomass (<code>rsa_above</code>).</p><ul><li>the strength of the reduction is modified by the parameter <code>δ_wrsa</code></li></ul><p><code>δ_wrsa</code> equals 1: <img src="../../img/W_rsa_response.svg" alt="Graphical overview of the functional response"/></p><p><code>δ_wrsa</code> equals 0.5:</p><p><strong><img src="../../img/W_rsa_response_0_5.svg" alt="Graphical overview of the functional response"/></strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/belowground_competition.jl#L120-L233">source</a></section></article><hr/><h4 id="Specific-leaf-area-linked-to-water-stress"><a class="docs-heading-anchor" href="#Specific-leaf-area-linked-to-water-stress">Specific leaf area linked to water stress</a><a id="Specific-leaf-area-linked-to-water-stress-1"></a><a class="docs-heading-anchor-permalink" href="#Specific-leaf-area-linked-to-water-stress" title="Permalink"></a></h4><hr/><h4 id="Root-surface-area-/-aboveground-biomass-linked-to-water-stress"><a class="docs-heading-anchor" href="#Root-surface-area-/-aboveground-biomass-linked-to-water-stress">Root surface area / aboveground biomass linked to water stress</a><a id="Root-surface-area-/-aboveground-biomass-linked-to-water-stress-1"></a><a class="docs-heading-anchor-permalink" href="#Root-surface-area-/-aboveground-biomass-linked-to-water-stress" title="Permalink"></a></h4><h3 id="Nutrient-stress"><a class="docs-heading-anchor" href="#Nutrient-stress">Nutrient stress</a><a id="Nutrient-stress-1"></a><a class="docs-heading-anchor-permalink" href="#Nutrient-stress" title="Permalink"></a></h3><div class="mermaid">
flowchart LR
    S[↓ nutrient stress] 
    N[nutrient index]
    R[trait: root surface area /\n aboveground biomass]
    A[trait: arbuscular mycorrhizal colonisation]
    B[belowground competition]
    L[plant available nutrients]

    N --> L
    B --> L
    L --> S
    R --> S
    A --> S;
</div><p>The species differ in the response to nutrient availability by different proportion of mycorrhizal colonisations and root surface per above ground biomass. The maximum of both response curves is used for the nutrient reduction function. It is assumed that the plants needs either many fine roots per above ground biomass or have a strong symbiosis with mycorrhizal fungi. </p><p>It is implemented in <a href="#GrasslandTraitSim.nutrient_reduction!"><code>nutrient_reduction!</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.nutrient_reduction!" href="#GrasslandTraitSim.nutrient_reduction!"><code>GrasslandTraitSim.nutrient_reduction!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nutrient_reduction!(; container, nutrient_growth_reduction, nutrients)</code></pre><p>Reduction of growth based on plant available nutrients and the traits arbuscular mycorrhizal colonisation and root surface area / aboveground biomass.</p><p>Reduction of growth due to stronger nutrient stress for lower arbuscular mycorrhizal colonisation (<code>AMC</code>).</p><ul><li>the strength of the reduction is modified by the parameter <code>δ_amc</code></li></ul><p><code>δ_amc</code> equals 1: <img src="../../img/amc_nut_response.svg" alt="Graphical overview of the AMC functional response"/></p><p><code>δ_amc</code> equals 0.5: <img src="../../img/amc_nut_response_0_5.svg" alt="Graphical overview of the AMC functional response"/></p><p>Reduction of growth due to stronger nutrient stress for lower specific root surface area per above ground biomass (<code>rsa_above</code>).</p><ul><li>the strength of the reduction is modified by the parameter <code>δ_nrsa</code></li></ul><p><code>δ_nrsa</code> equals 1: <img src="../../img/rsa_above_nut_response.svg" alt="Graphical overview of the functional response"/></p><p><code>δ_nrsa</code> equals 0.5: <img src="../../img/rsa_above_nut_response_0_5.svg" alt="Graphical overview of the functional response"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/282a693ffb11b1914767d08c7a5605e8dbcc4a60/src/growth/belowground_competition.jl#L265-L293">source</a></section></article><script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
</script> </article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../biomass_dynamic/">« Overview</a><a class="docs-footer-nextpage" href="../senescence/">Senescence »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 5 March 2024 10:20">Tuesday 5 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
