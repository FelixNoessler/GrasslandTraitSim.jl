<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initialization · GrasslandTraitSim.jl</title><meta name="title" content="Initialization · GrasslandTraitSim.jl"/><meta property="og:title" content="Initialization · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Initialization · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/how_to_prepare_input/">Prepare input and run simulation</a></li><li><a class="tocitem" href="../../tutorials/how_to_analyse_output/">Analyse model output</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../main_equations/">Difference equation</a></li><li class="is-active"><a class="tocitem" href>Initialization</a><ul class="internal"><li><a class="tocitem" href="#Initialization-of-traits"><span>Initialization of traits</span></a></li><li><a class="tocitem" href="#Initialization-of-parameters"><span>Initialization of parameters</span></a></li><li><a class="tocitem" href="#Set-the-initial-conditions-of-the-state-variables"><span>Set the initial conditions of the state variables</span></a></li></ul></li><li><a class="tocitem" href="../growth/">Growth</a></li><li><a class="tocitem" href="../water/">Water dynamics</a></li><li><a class="tocitem" href="../functional_response/">Functional response</a></li></ul></li><li><span class="tocitem">Calibration to grasslands of the Biodiversity Exploratories</span><ul><li><a class="tocitem" href="../../biodiversity_exploratories/calibration_data/">Calibration data</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/likelihood/">Likelihood</a></li><li><a class="tocitem" href="../../biodiversity_exploratories/priors/">Priors</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model description</a></li><li class="is-active"><a href>Initialization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initialization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/Modelling_API/initialization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h1><p>The function <a href="#GrasslandTraitSim.initialization"><code>initialization</code></a> is called once at the beginning of the simulation.  The <a href="#Initialization-of-traits">traits</a> of the species are generated, the  <a href="#Initialization-of-parameters">parameters</a> are initialized  and the <a href="#Set-the-initial-conditions-of-the-state-variables">initial conditions of the state variables</a>  are set.</p><p>Furthermore, the neighbours and the surrounding (own patch and neighbours) are set for each patch with  <a href="#GrasslandTraitSim.set_neighbours_surroundings!"><code>set_neighbours_surroundings!</code></a>. This is needed for <a href="../growth/#GrasslandTraitSim.clonalgrowth!">clonal growth</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.initialization" href="#GrasslandTraitSim.initialization"><code>GrasslandTraitSim.initialization</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialization(; input_obj, inf_p, calc)</code></pre><p>Initialize the simulation object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.set_neighbours_surroundings!" href="#GrasslandTraitSim.set_neighbours_surroundings!"><code>GrasslandTraitSim.set_neighbours_surroundings!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_neighbours_surroundings!(; calc, input_obj)</code></pre><p>Define each patch&#39;s neighbouring and surrounding patches.</p><p><img src="../../img/neighbours.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/neighbours.jl#L1-L7">source</a></section></article><h2 id="Initialization-of-traits"><a class="docs-heading-anchor" href="#Initialization-of-traits">Initialization of traits</a><a id="Initialization-of-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-of-traits" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.random_traits!" href="#GrasslandTraitSim.random_traits!"><code>GrasslandTraitSim.random_traits!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">random_traits!(; calc, input_obj)</code></pre><p>Generate random traits for the simulation.</p><p>The traits are generated using a bivariate Gaussian mixture model with full covariance matrices. For each species either the first or the second Gaussian distribution is used to generate the log/logit-transformed traits. The traits are then backtransformed to the original scale and the units are added. Furthermore, the two traits specific leaf area (<code>sla</code>) and the root surface area per aboveground biomass (<code>rsa_above</code>) are calculated.</p><p>The Gaussian mixture model was fitted to the data with the function <code>BayesianGaussianMixture</code> of [<a href="../../References/#scikit-learn">1</a>].</p><p>Overview of the traits:</p><table><tr><th style="text-align: right">trait</th><th style="text-align: right">unit</th><th style="text-align: right">description</th><th style="text-align: right">transformation</th></tr><tr><td style="text-align: right"><code>la</code></td><td style="text-align: right">mm²</td><td style="text-align: right">leaf area</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>lfm</code></td><td style="text-align: right">mg</td><td style="text-align: right">leaf fresh mass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>ldm</code></td><td style="text-align: right">mg</td><td style="text-align: right">leaf dry mass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>ba</code></td><td style="text-align: right">-</td><td style="text-align: right">biomass allocation</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>srsa</code></td><td style="text-align: right">m² g⁻¹</td><td style="text-align: right">specific root surface area</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>amc</code></td><td style="text-align: right">-</td><td style="text-align: right">arbuscular mycorrhizal colonisation rate</td><td style="text-align: right">logit</td></tr><tr><td style="text-align: right"><code>height</code></td><td style="text-align: right">m</td><td style="text-align: right">plant height</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>ldmpm</code></td><td style="text-align: right">g g⁻¹</td><td style="text-align: right">leaf dry mass per plant dry mass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>lncm</code></td><td style="text-align: right">mg g⁻¹</td><td style="text-align: right">leaf nitrogen content per leaf dry mass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>sla</code></td><td style="text-align: right">m² g⁻¹</td><td style="text-align: right">specific leaf area</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><code>rsa_above</code></td><td style="text-align: right">m² g⁻¹</td><td style="text-align: right">root surface area per aboveground biomass</td><td style="text-align: right">-</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/traits/traits.jl#L16-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.similarity_matrix!" href="#GrasslandTraitSim.similarity_matrix!"><code>GrasslandTraitSim.similarity_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similarity_matrix!(; input_obj, calc)</code></pre><p>Calculates the similarity between plants concerning their investment in fine roots and collaboration with mycorrhiza.</p><p>The trait similarity is build with the traits root surface area per aboveground biomass (<code>rsa_above</code>) and the arbuscular mycorrhizal colonisation rate (<code>amc</code>).</p><p>Standardized residuals are calculated for both traits:</p><p class="math-container">\[\text{amc_resid} =\]</p><p>The trait similarity between plant species <span>$i$</span> and plant species <span>$u$</span> for <span>$T$</span> traits is calculated as follows:</p><p class="math-container">\[\text{trait_similarity}_{i,u} =
    1-\frac{\sum_{t=1}^{t=T}
        |\text{scaled_trait}_{t,i} - \text{scaled_trait}_{t,u}|}{T}\]</p><p>To give each functional trait an equal influence, the trait values have been scaled by the 5 % (<span>$Q_{0.05, t}$</span>) and 95 % quantile (<span>$Q_{0.95, t}$</span>) of trait values of 100 plant species:</p><p class="math-container">\[\text{scaled_trait}_{t,i} =
    \frac{\text{trait}_{t,i} - Q_{0.05, t}}
    {Q_{0.95, t} - Q_{0.05, t}}\]</p><p>If the rescaled trait values were below zero or above one, the values were set to zero or one respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/traits/traits.jl#L96-L130">source</a></section></article><h2 id="Initialization-of-parameters"><a class="docs-heading-anchor" href="#Initialization-of-parameters">Initialization of parameters</a><a id="Initialization-of-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-of-parameters" title="Permalink"></a></h2><p>Many parameters are given at the start the simulation. However, some parameters are dependent on input parameters and of the generated traits  and are initialized at the start of the simulation.</p><p>The species-specific parameters are:</p><ul><li><code>μ</code>: <a href="#GrasslandTraitSim.senescence_rate!">senescence rate</a> [d⁻¹]</li><li><code>ρ</code>: <a href="#GrasslandTraitSim.grazing_parameter!">palatability</a> [-]</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.senescence_rate!" href="#GrasslandTraitSim.senescence_rate!"><code>GrasslandTraitSim.senescence_rate!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">senescence_rate!(; calc, inf_p)</code></pre><p>TBW</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/growth/senescence.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.grazing_parameter!" href="#GrasslandTraitSim.grazing_parameter!"><code>GrasslandTraitSim.grazing_parameter!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grazing_parameter!(; calc, LNCM, leafnitrogen_graz_exp)</code></pre><p>Initialize the grazing parameter ρ.</p><p class="math-container">\[\rho =  \left(\frac{LNCM}{\overline{LNCM}}\right) ^ {\text{leafnitrogen_graz_exp}}\]</p><ul><li><code>LNCM</code> leaf nitrogen per leaf mass</li><li><code>leafnitrogen_graz_exp</code> exponent of the leaf nitrogen per leaf mass in the grazing parameter</li><li><code>ρ</code> appetence of the plant species for livestock, dependent on nitrogen per leaf mass (LNCM) [-]</li></ul><p>The function is excetued once at the start of the simulation. The grazing parameter ρ is used in the function <a href="../growth/#GrasslandTraitSim.grazing!"><code>grazing!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/growth/defoliation.jl#L48-L65">source</a></section></article><p><strong>Initializing parameters for the functional response</strong></p><p>The species-specific parameters are:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.sla_water_response!" href="#GrasslandTraitSim.sla_water_response!"><code>GrasslandTraitSim.sla_water_response!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sla_water_response!(;
calc, inf_p,
mid_SLA = 0.025u&quot;m^2 / g&quot;,
slope_func_parameter = 75u&quot;g / m^2&quot;,
min_SLA_half_response = -0.8,
max_SLA_half_response = 0.8)</code></pre><p>TBW</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/functionalresponse/functional_response.jl#L131-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.rsa_above_water_response!" href="#GrasslandTraitSim.rsa_above_water_response!"><code>GrasslandTraitSim.rsa_above_water_response!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rsa_above_water_response!(;
calc, inf_p,
mid_rsa_above = 0.12u&quot;m^2 / g&quot;,
slope_func_parameters = 40u&quot;g / m^2 &quot;,
min_right_upper_bound = 0.7,
max_right_upper_bound = 1,
min_rsa_above_half_response = 0.05,
max_rsa_above_half_response = 0.6)</code></pre><p>TBW</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/functionalresponse/functional_response.jl#L91-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.rsa_above_nut_response!" href="#GrasslandTraitSim.rsa_above_nut_response!"><code>GrasslandTraitSim.rsa_above_nut_response!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rsa_above_nut_response!(; calc, inf_p,
                               mid_rsa_above = 0.12u&quot;m^2 / g&quot;,
                               slope_func_parameters = 40u&quot;g / m^2 &quot;,
                               min_right_upper_bound = 0.7,
                               max_right_upper_bound = 1,
                               min_rsa_above_half_response = 0.05,
                               max_rsa_above_half_response = 0.6)</code></pre><p>TBW</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/functionalresponse/functional_response.jl#L54-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.amc_nut_response" href="#GrasslandTraitSim.amc_nut_response"><code>GrasslandTraitSim.amc_nut_response</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">amc_nut_response(;
    mycorrhizal_colon,
    max_right_upper_bound = 1,
    min_right_upper_bound = 0.7,
    max_AMC_half_response = 0.6,
    min_AMC_half_response = 0.05,
    mid_AMC = 0.35,
    slope = 10,
    maximal_reduction)</code></pre><p>Transforms the mycorrhizal colonisation into parameters of the response curve of growth in relation to nutrient availability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/functionalresponse/functional_response.jl#L1-L15">source</a></section></article><p><strong>Initialization of patch-specific parameters</strong></p><p>The patch specific parameters are: </p><ul><li>water holding capacity <code>WHC</code> [mm]</li><li>permanent wilting point <code>PWP</code> [mm]</li><li>nutrients [-]</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.derive_WHC_PWP_nutrients!" href="#GrasslandTraitSim.derive_WHC_PWP_nutrients!"><code>GrasslandTraitSim.derive_WHC_PWP_nutrients!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">derive_WHC_PWP_nutrients!(; calc, input_obj)</code></pre><p>Derive water holding capacity (WHC), permanent wilting point (PWP) and nutrients for all patches.</p><p>This function calls the functions <a href="#GrasslandTraitSim.input_WHC_PWP"><code>input_WHC_PWP</code></a> and <a href="#GrasslandTraitSim.input_nutrients!"><code>input_nutrients!</code></a>.</p><p>A gradient of nutrients within the site can be added by setting <code>nutheterog</code> to a value larger than zero. The gradient is created with <a href="#GrasslandTraitSim.planar_gradient!"><code>planar_gradient!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L26-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.input_WHC_PWP" href="#GrasslandTraitSim.input_WHC_PWP"><code>GrasslandTraitSim.input_WHC_PWP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">input_WHC_PWP(; sand, silt, clay, organic, bulk, rootdepth)</code></pre><p>Derive walter holding capacity (WHC) and permanent wilting point (PWP) from soil properties.</p><p class="math-container">\[\begin{align}
    θ₁ &amp;= a₁ ⋅ \text{sand} + b₁ ⋅ \text{silt} + c₁ ⋅ \text{clay} +
            d₁ ⋅ \text{organic} + e₁ ⋅ \text{bulk} \\
    \text{WHC} &amp;= θ₁ ⋅ \text{rootdepth} \\
    θ₂ &amp;= a₂ ⋅ \text{sand} + b₂ ⋅ \text{silt} + c₂ ⋅ \text{clay} +
            d₂ ⋅ \text{organic} + e₂ ⋅ \text{bulk} \\
    \text{PWP} &amp;= θ₂ ⋅ \text{rootdepth}
\end{align}\]</p><p>Equation and coefficients are taken from [<a href="../../References/#Gupta1979">2</a>]. The coefficients a, b, c, d and e differ for the water holding capacity (matrix potential Ψ = -0.07 bar) and the permanent wilting point (matrix potential Ψ = -15 bar). The empirical coefficients that were estimated by [<a href="../../References/#Gupta1979">2</a>] can be seen in the folling table:</p><table><tr><th style="text-align: right">Ψ [bar]</th><th style="text-align: right">a</th><th style="text-align: right">b</th><th style="text-align: right">c</th><th style="text-align: right">d</th><th style="text-align: right">e</th></tr><tr><td style="text-align: right">-0.07</td><td style="text-align: right">0.005678</td><td style="text-align: right">0.009228</td><td style="text-align: right">0.009135</td><td style="text-align: right">0.006103</td><td style="text-align: right">-0.2696</td></tr><tr><td style="text-align: right">-15</td><td style="text-align: right">-5.9e-5</td><td style="text-align: right">0.001142</td><td style="text-align: right">0.005766</td><td style="text-align: right">0.002228</td><td style="text-align: right">0.02671</td></tr></table><ul><li><code>sand</code>: sand content [%]</li><li><code>silt</code>: silt content [%]</li><li><code>clay</code>: clay content [%]</li><li><code>bulk</code>: bulk density [g cm⁻³]</li><li><code>organic</code>: organic matter content [%]</li><li><code>rootdepth</code>: rooting depth [mm]</li><li><code>θ</code>: water content [cm³ cm⁻³]</li><li><code>WHC</code>: water holding capacity [mm]</li><li><code>PWP</code>: permanent wilting point [mm]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L103-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.input_nutrients!" href="#GrasslandTraitSim.input_nutrients!"><code>GrasslandTraitSim.input_nutrients!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">input_nutrients(; gradientm, total_N, CN_ratio)</code></pre><p>Derive a nutrient index by combining total nitrogen and carbon to nitrogen ratio.</p><p class="math-container">\[    N = \frac{1}{1 + exp(-β₁ ⋅ \text{total_N} -β₂ ⋅ \text{CN_ratio}⁻¹)}\]</p><ul><li><code>CNratio</code>: carbon to nitrogen ratio [-]</li><li><code>totalN</code>: total nitrogen [g kg⁻¹]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L57-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.planar_gradient!" href="#GrasslandTraitSim.planar_gradient!"><code>GrasslandTraitSim.planar_gradient!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">planar_gradient!(; mat, direction)</code></pre><p>Fills a matrix with a gradient with values from 0 to 1.</p><p>The <code>direction</code> controls the direction of the gradient.</p><p><img src="../../img/gradient.svg" alt/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L1-L9">source</a></section></article><h2 id="Set-the-initial-conditions-of-the-state-variables"><a class="docs-heading-anchor" href="#Set-the-initial-conditions-of-the-state-variables">Set the initial conditions of the state variables</a><a id="Set-the-initial-conditions-of-the-state-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-initial-conditions-of-the-state-variables" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.set_initialconditions!" href="#GrasslandTraitSim.set_initialconditions!"><code>GrasslandTraitSim.set_initialconditions!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_initialconditions!(; container)</code></pre><p>Set the initial conditions for the state variables.</p><p>Each plant species (<code>u_biomass</code>) gets an equal share of the initial biomass (<code>initbiomass</code>). The soil water content (<code>u_water</code>) is set to 180 mm.</p><ul><li><code>u_biomass</code>: state variable biomass [kg ha⁻¹]</li><li><code>u_water</code>: state variable soil water content [mm]</li><li><code>initbiomass</code>: initial biomass [kg ha⁻¹]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/4ff86f6b58d93281eef58c242dbb288729f6f202/src/initialization.jl#L201-L213">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../main_equations/">« Difference equation</a><a class="docs-footer-nextpage" href="../growth/">Growth »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 7 November 2023 17:00">Tuesday 7 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
