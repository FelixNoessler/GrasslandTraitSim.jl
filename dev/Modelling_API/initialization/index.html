<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initialization · GrasslandTraitSim.jl</title><meta name="title" content="Initialization · GrasslandTraitSim.jl"/><meta property="og:title" content="Initialization · GrasslandTraitSim.jl"/><meta property="twitter:title" content="Initialization · GrasslandTraitSim.jl"/><meta name="description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="twitter:description" content="Documentation for GrasslandTraitSim.jl."/><meta property="og:url" content="https://FelixNoessler.github.io/GrasslandTraitSim.jl/Modelling_API/initialization/"/><meta property="twitter:url" content="https://FelixNoessler.github.io/GrasslandTraitSim.jl/Modelling_API/initialization/"/><link rel="canonical" href="https://FelixNoessler.github.io/GrasslandTraitSim.jl/Modelling_API/initialization/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GrasslandTraitSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../model_io/">Model input and output</a></li><li><a class="tocitem" href="../../parameter/">Parameter</a></li><li><a class="tocitem" href="../../dashboard/">Dashboard</a></li><li><a class="tocitem" href="../../variables/">Visualize model components</a></li><li><a class="tocitem" href="../../time_step/">Time step</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/how_to_prepare_input/">Prepare input and run simulation</a></li><li><a class="tocitem" href="../../tutorials/how_to_analyse_output/">Analyse model output</a></li><li><a class="tocitem" href="../../tutorials/how_to_heterogeneous_site_management/">Heterogenous site or management conditions</a></li><li><a class="tocitem" href="../../tutorials/how_to_turnoff_subprocesses/">Turn-off subprocesses</a></li></ul></li><li><span class="tocitem">Model description</span><ul><li><a class="tocitem" href="../main_equations/">Difference equation</a></li><li class="is-active"><a class="tocitem" href>Initialization</a><ul class="internal"><li><a class="tocitem" href="#Initialization-of-traits"><span>Initialization of traits</span></a></li><li><a class="tocitem" href="#Initialization-of-parameters"><span>Initialization of parameters</span></a></li><li><a class="tocitem" href="#Set-the-initial-conditions-of-the-state-variables"><span>Set the initial conditions of the state variables</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Biomass dynamic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../biomass_dynamic/">Overview</a></li><li><a class="tocitem" href="../growth/">Growth: overview</a></li><li><a class="tocitem" href="../growth_potential_growth/">Growth: potential growth</a></li><li><a class="tocitem" href="../growth_env_factors/">Growth: community adjustment</a></li><li><a class="tocitem" href="../growth_species_specific/">Growth: species-specific adjustment</a></li><li><a class="tocitem" href="../senescence/">Senescence</a></li><li><a class="tocitem" href="../defoliation/">Mowing and grazing</a></li><li><a class="tocitem" href="../clonalgrowth/">Clonal growth</a></li></ul></li><li><a class="tocitem" href="../water/">Water dynamics</a></li></ul></li><li><a class="tocitem" href="../../all_functions/">TOC all functions</a></li><li><a class="tocitem" href="../../create_all_doc_figures/">Create all figures in documentation</a></li><li><a class="tocitem" href="../../References/">References &amp; Acknowledgements</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model description</a></li><li class="is-active"><a href>Initialization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initialization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/master/docs/src/Modelling_API/initialization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.initialization" href="#GrasslandTraitSim.initialization"><code>GrasslandTraitSim.initialization</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialization(
;
    input_obj,
    p,
    prealloc,
    prealloc_specific,
    trait_input,
    callback
)
</code></pre><p>Initialize the simulation object.</p><p>The function is called once at the beginning of the simulation within <a href="../main_equations/#GrasslandTraitSim.solve_prob"><code>solve_prob</code></a>.</p><p>The <a href="#Initialization-of-traits">traits</a> of the species are generated or set if provided, the <a href="#Initialization-of-parameters">parameters</a> are initialized and the <a href="#Set-the-initial-conditions-of-the-state-variables">initial conditions of the state variables</a> are set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/2_initialisation/3_initialisation.jl#L1">source</a></section></article><h2 id="Initialization-of-traits"><a class="docs-heading-anchor" href="#Initialization-of-traits">Initialization of traits</a><a id="Initialization-of-traits-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-of-traits" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.random_traits!" href="#GrasslandTraitSim.random_traits!"><code>GrasslandTraitSim.random_traits!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">random_traits!(; container)
</code></pre><p>Generate random traits for the simulation.</p><p>The traits are generated using a bivariate Gaussian mixture model with full covariance matrices. For each species either the first or the second Gaussian distribution is used to generate the log/logit-transformed traits. The traits are then backtransformed to the original scale and the units are added. If the proportion of the leaf mass of the total plant mass (<code>lbp</code>) is larger than 0.95 % of the proportion of the aboveground mass of the total mass (<code>abp</code>), <code>lbp</code> is set to 0.95 % of <code>abp</code>.</p><p>The Gaussian mixture model was fitted to the data with the function <code>BayesianGaussianMixture</code> of [<a href="../../References/#scikit-learn">1</a>].</p><p>Overview of the traits:</p><table><tr><th style="text-align: right">trait</th><th style="text-align: right">unit</th><th style="text-align: right">description</th><th style="text-align: right">transformation</th></tr><tr><td style="text-align: right"><code>sla</code></td><td style="text-align: right">m² g⁻¹</td><td style="text-align: right">specific   leaf area</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>height</code></td><td style="text-align: right">m</td><td style="text-align: right">plant height</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>lnc</code></td><td style="text-align: right">mg g⁻¹</td><td style="text-align: right">leaf nitrogen content per leaf dry mass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>srsa</code></td><td style="text-align: right">m² g⁻¹</td><td style="text-align: right">root surface area per aboveground biomass</td><td style="text-align: right">log</td></tr><tr><td style="text-align: right"><code>amc</code></td><td style="text-align: right">-</td><td style="text-align: right">arbuscular mycorrhizal colonisation rate</td><td style="text-align: right">logit</td></tr><tr><td style="text-align: right"><code>abp</code></td><td style="text-align: right">-</td><td style="text-align: right">aboveground dry mass per plant dry mass</td><td style="text-align: right">logit</td></tr><tr><td style="text-align: right"><code>lbp</code></td><td style="text-align: right">-</td><td style="text-align: right">leaf dry mass per plant dry mass</td><td style="text-align: right">logit</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/2_initialisation/5_traits.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.similarity_matrix!" href="#GrasslandTraitSim.similarity_matrix!"><code>GrasslandTraitSim.similarity_matrix!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similarity_matrix!(; container)
</code></pre><p>Calculates the similarity between plants concerning their investment in fine roots and collaboration with mycorrhiza.</p><p>The trait similarity is build with the traits root surface area per belowground biomass (<code>srsa</code>) and the arbuscular mycorrhizal colonisation rate (<code>amc</code>).</p><p>Standardized residuals are calculated for both traits:</p><p class="math-container">\[\text{amc_resid} =\]</p><p>The trait similarity between plant species <span>$i$</span> and plant species <span>$u$</span> for <span>$T$</span> traits is calculated as follows:</p><p class="math-container">\[\text{trait_similarity}_{i,u} =
    1-\frac{\sum_{t=1}^{t=T}
        |\text{scaled_trait}_{t,i} - \text{scaled_trait}_{t,u}|}{T}\]</p><p>To give each functional trait an equal influence, the trait values have been scaled by the 5 % (<span>$Q_{0.05, t}$</span>) and 95 % quantile (<span>$Q_{0.95, t}$</span>) of trait values of 100 plant species:</p><p class="math-container">\[\text{scaled_trait}_{t,i} =
    \frac{\text{trait}_{t,i} - Q_{0.05, t}}
    {Q_{0.95, t} - Q_{0.05, t}}\]</p><p>If the rescaled trait values were below zero or above one, the values were set to zero or one respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/3_biomass/1_growth/5_nutrient_competition.jl#L29">source</a></section></article><h2 id="Initialization-of-parameters"><a class="docs-heading-anchor" href="#Initialization-of-parameters">Initialization of parameters</a><a id="Initialization-of-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-of-parameters" title="Permalink"></a></h2><p>Many parameters are given at the start the simulation. However, some parameters are dependent on input parameters and of the generated traits  and are initialized at the start of the simulation.</p><p>The species-specific parameters are:</p><ul><li><code>μ</code>: <a href="#GrasslandTraitSim.senescence_rate!">senescence rate</a> [d⁻¹]</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.senescence_rate!" href="#GrasslandTraitSim.senescence_rate!"><code>GrasslandTraitSim.senescence_rate!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">senescence_rate!(; container)
</code></pre><p>Intialize the basic senescence rate based on the specific leaf area</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/3_biomass/2_senescence/1_senescence.jl#L25">source</a></section></article><p><strong>Initializing parameters for the functional response</strong></p><p>The species-specific parameters are:</p><p><strong>Initialization of patch-specific parameters</strong></p><p>The patch specific parameters are: </p><ul><li>water holding capacity <code>WHC</code> [mm]</li><li>permanent wilting point <code>PWP</code> [mm]</li><li>nutrients [-]</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.input_WHC_PWP!" href="#GrasslandTraitSim.input_WHC_PWP!"><code>GrasslandTraitSim.input_WHC_PWP!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">input_WHC_PWP!(; container)
</code></pre><p>Derive walter holding capacity (WHC) and permanent wilting point (PWP) from soil properties.</p><p class="math-container">\[\begin{align}
    θ₁ &amp;= a₁ ⋅ \text{sand} + b₁ ⋅ \text{silt} + c₁ ⋅ \text{clay} +
            d₁ ⋅ \text{organic} + e₁ ⋅ \text{bulk} \\
    \text{WHC} &amp;= θ₁ ⋅ \text{rootdepth} \\
    θ₂ &amp;= a₂ ⋅ \text{sand} + b₂ ⋅ \text{silt} + c₂ ⋅ \text{clay} +
            d₂ ⋅ \text{organic} + e₂ ⋅ \text{bulk} \\
    \text{PWP} &amp;= θ₂ ⋅ \text{rootdepth}
\end{align}\]</p><p>Equation and coefficients are taken from [<a href="../../References/#Gupta1979">2</a>]. The coefficients a, b, c, d and e differ for the water holding capacity (matrix potential Ψ = -0.07 bar) and the permanent wilting point (matrix potential Ψ = -15 bar). The empirical coefficients that were estimated by [<a href="../../References/#Gupta1979">2</a>] can be seen in the folling table:</p><table><tr><th style="text-align: right">Ψ [bar]</th><th style="text-align: right">a</th><th style="text-align: right">b</th><th style="text-align: right">c</th><th style="text-align: right">d</th><th style="text-align: right">e</th></tr><tr><td style="text-align: right">-0.07</td><td style="text-align: right">0.005678</td><td style="text-align: right">0.009228</td><td style="text-align: right">0.009135</td><td style="text-align: right">0.006103</td><td style="text-align: right">-0.2696</td></tr><tr><td style="text-align: right">-15</td><td style="text-align: right">-5.9e-5</td><td style="text-align: right">0.001142</td><td style="text-align: right">0.005766</td><td style="text-align: right">0.002228</td><td style="text-align: right">0.02671</td></tr></table><ul><li><code>sand</code>: sand content [%]</li><li><code>silt</code>: silt content [%]</li><li><code>clay</code>: clay content [%]</li><li><code>bulk</code>: bulk density [g cm⁻³]</li><li><code>organic</code>: organic matter content [%]</li><li><code>rootdepth</code>: rooting depth [mm]</li><li><code>θ</code>: water content [cm³ cm⁻³]</li><li><code>WHC</code>: water holding capacity [mm]</li><li><code>PWP</code>: permanent wilting point [mm]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/4_water/water.jl#L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.input_nutrients!" href="#GrasslandTraitSim.input_nutrients!"><code>GrasslandTraitSim.input_nutrients!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">input_nutrients!(; container)
</code></pre><p>Derive a nutrient index from total soil nitrogen.</p><p class="math-container">\[\text{nutrients} = \frac{\text{totalN}}{N_\max}\]</p><ul><li><code>totalN</code>: total nitrogen [g kg⁻¹]</li><li><code>N_max</code>: maximum total nitrogen [g kg⁻¹]</li><li><code>nutrients</code>: nutrient index [-]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/3_biomass/1_growth/5_nutrient_competition.jl#L1">source</a></section></article><h2 id="Set-the-initial-conditions-of-the-state-variables"><a class="docs-heading-anchor" href="#Set-the-initial-conditions-of-the-state-variables">Set the initial conditions of the state variables</a><a id="Set-the-initial-conditions-of-the-state-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-initial-conditions-of-the-state-variables" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrasslandTraitSim.set_initialconditions!" href="#GrasslandTraitSim.set_initialconditions!"><code>GrasslandTraitSim.set_initialconditions!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_initialconditions!(; container)
</code></pre><p>Set the initial conditions for the state variables.</p><p>Each plant species (<code>u_biomass</code>) gets an equal share of the initial biomass (<code>initbiomass</code>). The soil water content (<code>u_water</code>) is set to 180 mm. The height is set to half of the maximum height of the species. The above- and belowground biomass (<code>u_above_biomass</code>, <code>u_below_biomass</code>) are calculated based on the aboveground biomass proportion (<code>abp</code>).</p><ul><li><code>u_biomass</code>: state variable biomass [kg ha⁻¹]</li><li><code>u_water</code>: state variable soil water content [mm]</li><li><code>u_height</code>: state variable height [m]</li><li><code>u_above_biomass</code>: state variable aboveground biomass [kg ha⁻¹]</li><li><code>u_below_biomass</code>: state variable belowground biomass [kg ha⁻¹]</li><li><code>initbiomass</code>: initial biomass [kg ha⁻¹]</li><li><code>initsoilwater</code>: initial soil water content [mm]</li><li><code>height</code>: potential height of the species [m]</li><li><code>abp</code>: aboveground biomass proportion [-]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FelixNoessler/GrasslandTraitSim.jl/blob/a6975e18ec9afe7e4cd059a96825f622b1a5c122/src/2_initialisation/3_initialisation.jl#L37">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../main_equations/">« Difference equation</a><a class="docs-footer-nextpage" href="../biomass_dynamic/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 6 August 2024 10:00">Tuesday 6 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
